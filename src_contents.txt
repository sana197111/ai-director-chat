--- src/types/index.ts ---
// Director types
export type DirectorType = 'bong' | 'nolan' | 'miyazaki' | 'curtis' | 'kani' | 'doctor'

export interface Director {
  id: DirectorType
  name: string
  nameKo: string
  title: string
  description: string
  films: string[]
  quote: string
  avatar: string
  themeColor: string
  bgGradient: string
}

// Session types
export interface Session {
  id: string
  startTime: Date
  currentStep: 'start' | 'director' | 'scenario' | 'chat'
  lastActivity: Date
}

// Scenario types
export interface Scenario {
  cuts: [string, string, string, string]
  completed: boolean
  savedAt?: Date
}

// Chat types
export interface Message {
  id: string
  role: 'user' | 'assistant' | 'system'
  content: string
  timestamp: Date
  choices?: Choice[]
}

export interface Choice {
  id: string
  text: string
  icon?: string
}

export interface ChatState {
  messages: Message[]
  currentTurn: number
  startTime: Date
  timeRemaining: number
  isExtended: boolean
  extensionCount: number
}

// App State
export interface AppState {
  session: Session
  director: {
    selected: DirectorType | null
    data: Director | null
  }
  scenario: Scenario
  chat: ChatState
}

// UI Component Props
export interface TouchButtonProps {
  onClick: () => void
  disabled?: boolean
  variant?: 'primary' | 'secondary' | 'ghost'
  size?: 'sm' | 'md' | 'lg'
  fullWidth?: boolean
  haptic?: boolean
  loading?: boolean
  className?: string
  children: React.ReactNode
}

export interface ToastProps {
  message: string
  type?: 'success' | 'error' | 'warning' | 'info'
  duration?: number
  onClose?: () => void
}

export interface ModalProps {
  isOpen: boolean
  onClose: () => void
  title?: string
  children: React.ReactNode
  size?: 'sm' | 'md' | 'lg'
  closeOnOverlayClick?: boolean
}

--- src/contexts/AppContext.tsx ---
'use client'

import React, { createContext, useContext, useReducer, useEffect } from 'react'
import { AppState, DirectorType, Message, Choice } from '@/types'
import { storage } from '@/lib/storage'
import { directors } from '@/constants/directors'

// Initial state
const initialState: AppState = {
  session: {
    id: '',
    startTime: new Date(),
    currentStep: 'start',
    lastActivity: new Date()
  },
  director: {
    selected: null,
    data: null
  },
  scenario: {
    cuts: ['', '', '', ''],
    completed: false
  },
  chat: {
    messages: [],
    currentTurn: 0,
    startTime: new Date(),
    timeRemaining: 600, // 10 minutes in seconds
    isExtended: false,
    extensionCount: 0
  }
}

// Action types
type AppAction =
  | { type: 'INIT_SESSION'; payload: { id: string } }
  | { type: 'SET_STEP'; payload: AppState['session']['currentStep'] }
  | { type: 'SELECT_DIRECTOR'; payload: DirectorType }
  | { type: 'UPDATE_SCENARIO'; payload: { index: number; text: string } }
  | { type: 'COMPLETE_SCENARIO' }
  | { type: 'ADD_MESSAGE'; payload: Message }
  | { type: 'UPDATE_TIME'; payload: number }
  | { type: 'EXTEND_TIME' }
  | { type: 'RESET_CHAT' }
  | { type: 'RESET_ALL' }
  | { type: 'LOAD_STATE'; payload: Partial<AppState> }
  | { type: 'UPDATE_ACTIVITY' }

// Reducer
function appReducer(state: AppState, action: AppAction): AppState {
  switch (action.type) {
    case 'INIT_SESSION':
      return {
        ...state,
        session: {
          ...state.session,
          id: action.payload.id,
          startTime: new Date(),
          lastActivity: new Date()
        }
      }

    case 'SET_STEP':
      return {
        ...state,
        session: {
          ...state.session,
          currentStep: action.payload,
          lastActivity: new Date()
        }
      }

    case 'SELECT_DIRECTOR':
      const directorData = directors[action.payload]
      return {
        ...state,
        director: {
          selected: action.payload,
          data: directorData
        },
        session: {
          ...state.session,
          lastActivity: new Date()
        }
      }

    case 'UPDATE_SCENARIO':
      const newCuts = [...state.scenario.cuts] as [string, string, string, string]
      newCuts[action.payload.index] = action.payload.text
      const isCompleted = newCuts.every(cut => cut.trim().length > 0)
      
      return {
        ...state,
        scenario: {
          cuts: newCuts,
          completed: isCompleted,
          savedAt: new Date()
        },
        session: {
          ...state.session,
          lastActivity: new Date()
        }
      }

    case 'COMPLETE_SCENARIO':
      return {
        ...state,
        scenario: {
          ...state.scenario,
          completed: true
        }
      }

    case 'ADD_MESSAGE':
      return {
        ...state,
        chat: {
          ...state.chat,
          messages: [...state.chat.messages, action.payload],
          currentTurn: state.chat.currentTurn + 1
        },
        session: {
          ...state.session,
          lastActivity: new Date()
        }
      }

    case 'UPDATE_TIME':
      return {
        ...state,
        chat: {
          ...state.chat,
          timeRemaining: action.payload
        }
      }

    case 'EXTEND_TIME':
      return {
        ...state,
        chat: {
          ...state.chat,
          timeRemaining: state.chat.timeRemaining + 180, // Add 3 minutes
          isExtended: true,
          extensionCount: state.chat.extensionCount + 1
        }
      }

    case 'RESET_CHAT':
      return {
        ...state,
        chat: {
          ...initialState.chat,
          startTime: new Date()
        },
        session: {
          ...state.session,
          currentStep: 'director'
        }
      }

    case 'RESET_ALL':
      return {
        ...initialState,
        session: {
          ...initialState.session,
          id: state.session.id
        }
      }

    case 'LOAD_STATE':
      return {
        ...state,
        ...action.payload
      }

    case 'UPDATE_ACTIVITY':
      return {
        ...state,
        session: {
          ...state.session,
          lastActivity: new Date()
        }
      }

    default:
      return state
  }
}

// Context
interface AppContextValue {
  state: AppState
  dispatch: React.Dispatch<AppAction>
  actions: {
    initSession: (id: string) => void
    setStep: (step: AppState['session']['currentStep']) => void
    selectDirector: (director: DirectorType) => void
    updateScenario: (index: number, text: string) => void
    completeScenario: () => void
    addMessage: (message: Message) => void
    updateTime: (time: number) => void
    extendTime: () => void
    resetChat: () => void
    resetAll: () => void
  }
}

const AppContext = createContext<AppContextValue | null>(null)

// Provider component
export function AppProvider({ children }: { children: React.ReactNode }) {
  const [state, dispatch] = useReducer(appReducer, initialState)

  // Load saved state on mount
  useEffect(() => {
    const savedSession = storage.get<AppState['session']>('SESSION')
    const savedDirector = storage.get<AppState['director']>('DIRECTOR')
    const savedScenario = storage.get<AppState['scenario']>('SCENARIO')
    const savedChat = storage.get<AppState['chat']>('CHAT')

    if (savedSession && !storage.isSessionExpired(savedSession.lastActivity)) {
      dispatch({
        type: 'LOAD_STATE',
        payload: {
          session: savedSession,
          director: savedDirector || initialState.director,
          scenario: savedScenario || initialState.scenario,
          chat: savedChat || initialState.chat
        }
      })
    } else {
      // Generate new session
      const newSessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
      dispatch({ type: 'INIT_SESSION', payload: { id: newSessionId } })
    }
  }, [])

  // Save state changes to localStorage
  useEffect(() => {
    if (state.session.id) {
      storage.set('SESSION', state.session)
      storage.set('DIRECTOR', state.director)
      storage.set('SCENARIO', state.scenario)
      storage.set('CHAT', state.chat)
    }
  }, [state])

  // Session expiration check
  useEffect(() => {
    const checkInterval = setInterval(() => {
      if (storage.isSessionExpired(state.session.lastActivity)) {
        // Show session expired modal here
        console.log('Session expired')
      }
    }, 60000) // Check every minute

    return () => clearInterval(checkInterval)
  }, [state.session.lastActivity])

  // Actions
  const actions: AppContextValue['actions'] = {
    initSession: (id: string) => dispatch({ type: 'INIT_SESSION', payload: { id } }),
    setStep: (step) => dispatch({ type: 'SET_STEP', payload: step }),
    selectDirector: (director) => dispatch({ type: 'SELECT_DIRECTOR', payload: director }),
    updateScenario: (index, text) => dispatch({ type: 'UPDATE_SCENARIO', payload: { index, text } }),
    completeScenario: () => dispatch({ type: 'COMPLETE_SCENARIO' }),
    addMessage: (message) => dispatch({ type: 'ADD_MESSAGE', payload: message }),
    updateTime: (time) => dispatch({ type: 'UPDATE_TIME', payload: time }),
    extendTime: () => dispatch({ type: 'EXTEND_TIME' }),
    resetChat: () => dispatch({ type: 'RESET_CHAT' }),
    resetAll: () => {
      storage.clearAll()
      dispatch({ type: 'RESET_ALL' })
    }
  }

  return (
    <AppContext.Provider value={{ state, dispatch, actions }}>
      {children}
    </AppContext.Provider>
  )
}

// Hook to use the context
export function useApp() {
  const context = useContext(AppContext)
  if (!context) {
    throw new Error('useApp must be used within AppProvider')
  }
  return context
}
--- src/app/favicon.ico ---
         (  F          (  n  00     (-  –           ¾F  (                                                           $   ]   º   º   ]   $                                           ò   ÿ   ÿ   ÿ   ÿ   ò                               8   à   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   à   8                  â   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   â              ¡   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ¡       #   ô   ÿ   ÿOOOÿ®®®ÿ«««ÿ«««ÿ«««ÿ«««ÿ­­­ÿgggÿ   ÿ   ÿ   ô   #   Y   ÿ   ÿ   ÿÿíííÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿıııÿ555ÿ   ÿ   ÿ   ÿ   Y   »   ÿ   ÿ   ÿ   ÿkkkÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ   ÿ   ÿ   ÿ   ÿ   »   »   ÿ   ÿ   ÿ   ÿ			ÿÍÍÍÿÿÿÿÿÿÿÿÿäääÿÿ   ÿ   ÿ   ÿ   ÿ   »   Y   ÿ   ÿ   ÿ   ÿ   ÿJJJÿıııÿÿÿÿÿkkkÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Y   #   ô   ÿ   ÿ   ÿ   ÿÿ¶¶¶ÿÕÕÕÿ			ÿ   ÿ   ÿ   ÿ   ÿ   ô   #       ¡   ÿ   ÿ   ÿ   ÿ   ÿ111ÿDDDÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ¡              â   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   â                  8   à   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   à   8                               ò   ÿ   ÿ   ÿ   ÿ   ò                                           $   ]   º   º   ]   $                                                                                                                                                                                                                                                                                    (       @                                                                               ,   U      è   è      U   ,                                                                                      *   …   Ò   ù   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ù   Ò   …   *                                                                      –   ó   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ó   –                                                          Q   á   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   á   Q                                               r   û   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   û   r                                       r   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   r                               O   û   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   û   O                          ä   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ã                      —   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   —               (   õ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ô   '           †   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ888ÿ‹‹‹ÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿˆˆˆÿ‰‰‰ÿ___ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   †          Ô   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿîîîÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿSSSÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Ô      +   ú   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿhhhÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ®®®ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ú   +   T   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿËËËÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿôôôÿ,,,ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   T   ‚   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿGGGÿıııÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ      é   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ­­­ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿäääÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   é   é   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ+++ÿóóóÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿjjjÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   é      ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ‹‹‹ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÌÌÌÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ‚   T   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿãããÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿıııÿIIIÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   T   +   ú   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿhhhÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ¯¯¯ÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ú   +      Ô   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿËËËÿÿÿÿÿÿÿÿÿôôôÿ,,,ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Ô          †   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿGGGÿıııÿÿÿÿÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   †           '   ô   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ±±±ÿìììÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   õ   (               —   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ333ÿ___ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   —                      ã   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ä                          O   û   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   û   O                               r   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   r                                       r   û   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   û   r                                               Q   á   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   á   Q                                                          –   ó   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ó   –                                                                      *   …   Ò   ù   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ù   Ò   …   *                                                                                      ,   U      è   è      U   ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (   0   `           -                                                                                             	   (   L   j   ³   ø   ÷   ³   j   K   (   	                                                                                                                                          V       Ø   ø   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ø   Ø       U                                                                                                                      %   ‹   á   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   á   ‹   &                                                                                                      ‹   ï   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ï   ‹                                                                                          Q   Ü   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Ü   R                                                                              Š   ş   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ş   Š                                                                     ­   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ­                                                             ¸   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ¸                                                     ®   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ®                                              Š   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Š                                       P   ı   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ı   O                                  ß   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ß                              ‹   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ‹                       #   ñ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ñ   #                   Œ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ‹                  ä   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ$$$ÿhhhÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿeeeÿPPPÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ä              U   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿëëëÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿsssÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   U           ¡   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿeeeÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÌÌÌÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ¡       	   Ú   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿÉÉÉÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿıııÿHHHÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Ú   	   (   ù   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿEEEÿüüüÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ®®®ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ø   (   K   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿªªªÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿôôôÿ,,,ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   L   j   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ)))ÿòòòÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿŒŒŒÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   j   ´   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿˆˆˆÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿãããÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ³   ø   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿáááÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿiiiÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ø   ø   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿeeeÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿËËËÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ø   ³   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿÉÉÉÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿıııÿHHHÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ´   j   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿEEEÿüüüÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ®®®ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   j   L   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿªªªÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿôôôÿ,,,ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   K   (   ø   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ)))ÿòòòÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿŒŒŒÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ù   (   	   Ú   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿˆˆˆÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿãããÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Ú   	       ¡   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿáááÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿiiiÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ¡           U   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿeeeÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÌÌÌÿÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   U              ä   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿÿÉÉÉÿÿÿÿÿÿÿÿÿıııÿHHHÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ä                  ‹   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿEEEÿüüüÿÿÿÿÿ®®®ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Œ                   #   ñ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ¬¬¬ÿûûûÿ,,,ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ñ   #                       ‹   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ222ÿ}}}ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ‹                              ß   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ß                                  O   ı   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ı   P                                       Š   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Š                                              ®   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ®                                                     ¸   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ¸                                                             ­   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ­                                                                     Š   ş   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ş   Š                                                                              R   Ü   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   Ü   Q                                                                                          ‹   ï   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ï   ‹                                                                                                      &   ‹   á   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   á   ‹   %                                                                                                                      U       Ø   ø   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ÿ   ø   Ø       V                                                                                                                                          	   (   K   j   ³   ÷   ø   ³   j   L   (   	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ‰PNG

   IHDR         \r¨f   sRGB ®Îé   8eXIfMM *    ‡i                                D"8s  IDATxí]	°Õ™n”]<QVA–èÄh$	ÊNŒ13*ˆq°ÂdªÄ©I¡ˆ˜D“L2“ª(Î(Ô˜2ÖÄ™ÑG	‹Áq_@å±ˆà†ŠxÈ›ï»Ğ¾{o÷½½ÓııUß{}»OŸå;çÿûôùÏ9İÂ‘d®(Dg Ğ8	èôN º]€î@ hx¥?v ÀNà3à=`;ğ6ğ.ğ&°àuâà  ±”6‰P©Ğ½€Á@ÿÃ RÓ PùiZqÊ^DNãà€wp¼Ø¼ĞXĞhĞ˜Hg@ÀÌ
:Ùâ|ğ5` p"@À'¼É²™s{ëpü*ğ2ÀŞ…Ä d Ò¯Œ–È|(0ø
0 à“>Kò
³xX¬6 IJÈ ¤C|?$KENØ}Ï“|ŠÂòµáàöh $	2 Ù|/§Â . Nz ’#¼ÃW€eÀ
à5€ã’ˆÜ¶ˆúà;Ày •¾ ñgàs©h^  IÄÈ DL(¢;¸8 ÒHjg€cH|x 1 ËR"Œa€ïôÓ• GÁÙ@…è9`/`%0èHÄ@jğ½~,° ÛK
Ÿ,t).ÎèI‘ˆDèT¦Oû)~º°Vìu$b èª›ĞU%¥7“ƒ¨›ù _É$b 8Aç×À€ßøJö3` 510wQñ?¤øvrğÑá:ü2şKÄ@ ¤øv*{%#í‚AZ€å’^(õÏ=ñ³g \ãÀWƒÛ€É!:àß,`à6ıÏ643:@’c.FÙŸ¤ğùä€u?Ğ<'áİ€ƒ€”_Üvp: É8Q¾›
IñÅ·p{3ÎóĞkHÈ¢ŒG¡¼•®cñÑ¼<62&‹
×2uCÁÿàÚòæ•­ßâ¤Tø3Ú
½ê€›…;î¼”ªd/~m€½.ø’XÆ@{äw.°ğ«d]G•Ú {lKÜàEbœÿı(P©RuMüTÛC›ÒÚÃÀdäï])¿Œ_Lmà=Äû=@bœÍ÷K€ÛGUkÙ^œUÓØÆØÖøš)1€È»gÕT¢ÂŠ¯°m`9Ú\Ú®³ÀQşÍ@ØÊÔıâ°–6ğ:ÚÕ^›w¬òï¸E—D¤Á ç	ü5°àºëÄFĞ,ßÜ
ğX"Òd€mğ<€nB~òì@´¸÷µt×tx‹»ü;ÚfŞ>ñ“ªíI8µˆ»¿8Ó¸C1Ûª$B¸•§e†©İ+ş’jl«ÜEZÃÇ& ©ÊS:â:Š6°möë´ÿ\G1¥ç`¢¨Å!“nl»lÃÆŠÉ^€Q`í·@OcÙSÆÄ@e¸Í·º¹ç¤qbªp•ÿãS†Ä@upšº±FÀD@å¿Ğ“¿º†¦Ğæ2@#À¹ÆõL3 £A’”$H2Ç _h¶FH#rq(íÿOàDƒò¤¬ˆ¨àrunGOWaêbŠ &–SgDñ3ÀEDçto§*Ç¤šú¡Ä9kŠİ~)¿•¡,$Â x¿RŸ1˜vàK áÀ9€DäU(ğw®&LEÒäê©»€S)¹é3ĞY8x8 $.i€(íŒÄK¬Å€YœìğaÈ]­—´À4”ôÇ€	c‰“®Å@3¸fà€ó•4Æ Æ¢„ÿĞ/*bàüş Çş˜$!I€~‡Ø7ÉB*-1`	o Ÿ º	‘$»àÇ¡D‹¾‰”L‰ˆûàòß êJ"’äÀOQ¢Ë)•ö2@#Ğx4‰"$e ¨ø·Iö8’àOiˆ8ø"İ ¼GäŞ8[xÄt<ñ.´´7&‚m&ØR^‹³tq÷ Ø•á.¾§ÅYÅ-2È ½d§ ûã*_Üà&d|j\™W¼b ãôGùö«â*gœ¯ £‘é‡ÄF4ã"IñŠØƒ´/ b1q€NÈğãÀY€Dˆp¼ŒÛ9îãpÑ}w\¯ ó‘Ô¤£“Ó1 j`€èOûŸî­xK=€ÑHñ÷ ÷A“ˆ1Ÿ#¾
D:U8jÀõıtù©ë$b bA||ØU¼Q¿ü26%ªÌ)1 Šè…_Àê¢³!~DÙàºæ• ¿à+b >A´Ü:]ÑE$ˆ£50òGDhRÑtèĞÁéİ»wRÉ)ğPÇ ‘èn$‘ 3ÜÖë@bS§Nu–,Yâ´jÕÊ²œç:»¡ôÜ;ÀáÀßó@£`Ç|ã–-[)“'OVıÙÕ†©sFxÚ®“âÛ¥øn}Í›7¯ üü³~ıúÆºº:»ŒÀQ—©J_¤ÎUKj8–q0xğàÆ;v4 Ì=[õhW=¾	İë	¤&·!e5Ë8hÑ¢Eãİwß]¤üüñá‡6öïß_õiW}şSZÚ?	¿/`Ÿ;vlã¾}û2 <±hÑ" »À§ĞAî¹‘¸ÜÕX,ã mÛ¶+V¬(©ü<¹wïŞÆ#F¨^íª×;“ÖşaHğc ûà”)SÊ*¿{aùòåpÊØc89(Ñ^€şö4&E¦ÛoÃ†®Wü/· uÆ=±^€ş*?{k^·_EíÇÅúúz¹íªgö† UI-‹è{WU*
œ:pû9.tÚ·o(/İºus>ûì3ç‰'^Rg€ßäÚGâÌI_D®‘»åÜ~~½ ¹­{øúÙ?N0‘7½SêØ.Æ×¸ÿ~?}/y]nA;êØ£‹³ã2 ]ñFOB2C?·_I­÷œ”[Ğ:°:Ú=#ÀOzKé-ã ˆÛÏ£ï%å´®İ?jĞşIÀ®†PÛ¯¤æ{NÊ-hUİÿt•:™œƒ˜øõ ,â ·ŸG×KÊ-hUÛç¢cƒhP7 ÿÎ¡Â˜Á@µn?¿\Ó-¸k×.¹ıˆ2ã:õú ğ`ÙáF„Û=ı-á V·_ÉG¿ç¤Ü‚Vé İõ}¢0 WIù­ªøFºıÊ­öóèsM‡rZÕ8pJ¸QÜ*@OK8ëöó³
rZ¥Ôİ–a, ßûwË ØSéW^y¥Ÿ‡¾.· 5íat7ÔØİ¤üÖTv#İ~7n­àA"¸üòËÕ+´£WøèpMÂÅ/ªhK8ˆÒíçgä´F/^„·«ÅŒÀM{e ì¨èR›|ú)qØë7İt“æ?8'àµ€KùíP~ºıî¹ç°ú\õırÚÑ> Ç·Uk ØeP÷ß|ë^xÇéöó³
‹/V/Àüvòô™¯ôå„ä¢*×pâvûù ¹­Ğ¾ÊŸ]JûË}óˆk8(•ˆÎÅÇÀÄ‰Ñ£GÇ—€OÌmÚ´q,X oúğ”òe.â˜^ ¡QxĞÓßp’tûùõä4^_ƒN—{à†¾øÅyÄ2 †s¤ÛÏÏ Ğ-Ø¹sgµsÛÌĞiêv‘”Z8
!~PJ?Œc€«ıîºë®À›|Æ] ®Ü½{·³zõê¸“Rüµ1pnãÔàzïí¥º¼tlpû9³fÍrºvíjTæ®¿şzß4*OÊLã‹~•øÑçÔ•3˜ƒ4İ~~¯r­;ÔmêxYŒ+üÀ€€¡¤íöó3 r­;Ômêx“4à÷Å:7]ÕqLš4)U·Ÿ!rú1”êuê6¿ìÕ$ÍÀ7›®èÀ8ºwïîÌ™3Ç¸|5Ï>?î\zé¥ÍOë·œëÍ†× ğø,ïE›ÅÀŒ3œš•©2¹¹å–[œººº2Wu:E¾‚´›¼^p.H1cJºtû]}õÕB˜uéÔSOu®ºŠ»ÉIc€O¥òÄ%ƒ  ÆAZ«ıüüü®kµ ‘ºD?Ç5 Ş@Q×À ÿé3Àwê+®¸"ıŒT™ÎSÀUŞ¥à13Àî?ûâ5 M'İ‹úŸ>pûşZµj•~fjÈ×ˆ×¡Ô‚n©¦±>× ğÿi5D¤[bf íÕ~a‹'·`Xc¹Ÿã -¼1ók¢›½ÿÄI«ıüŞ÷ı®kµ QºÅ¯|ókßMËé(92È@’t°ÉíçÇİ‚X-èL×“a€úN4€“qÜ'$f0@·@V„nA›Ü˜Yá½L9:â|/^sÇ ú—	¨Ó)0`êj¿°T\wİuZ-–ÄèîÂ¨\ 	@Ñ:¦±cítûùœ{È-èÇRb×û1%× ôI,Y%T‘Ûİ~‡‹rú1”ØõÂCŸ€,¼$–´*Ë€é«ıÊf<à¹0zş¥èhÕFü„û¦ ·Ÿ«ı|â€¯8Z-èCRü—¹Tg× ĞHRf€‹glYí–ª¹sçÊ-–Äp÷Ó'+Ãèî¶mµ_Ø’gÍÍ–îçC¿{ ô	òÃ’”ÈªÛÏÎ™3gÊ-èGR|×¹7`G€Şñ¥¡˜ƒ0U·Ÿ_ÙµZĞ¡Ø¯ŸD )À±ó\>¬»ıÊ—üĞ¹ıŠõz N–¤Ä@Öİ~~´Ê-èÇP¬×{rs€¿´@¬<—œ›|.]ºÔ¸|”Îm|gûõëç¬_¿Şyå•WâKD1—bàM½”¢%¡s\“·Ÿ¥rú1Ëõnì\–Æ’„"-É İ`.4æÛ~%3™àI}[0A²$µ“= -Ò>BH"G®Û^r„­<ÂEBGİi Ú%”˜’9Ì@^İ~~@«ıŠüú1Üì€†@’ tû-[¶ÌèÏ{%@CÙ$ğmAgüøñÎš5kÊ†Ñ…ÈøœŠ/åŒOÿˆlßäÓ¿„áBĞ@.X°À±uäp¥Oüî6œ—x²9MPn¿`ß·o_§¾¾^nÁ`t…
¥§(úª»™ƒ\rûùsÆAÒyóæéÛ‚şT…¡@h
ƒE0lØ0çÎ;ïtÚµÓ˜kÆ¸N ¡¡ÁYµjUà
S#ì|^ã½º- |¢İpÃN—.…­ØŞ¥`×^{­zLñ6ƒƒ4 ŸÄ›†bç¨öe—]&"ªd€sÎœ9UŞ¥àU0ğ!ÀÁ*nPĞ*`—ÿæ›oÖ¨v•¼¹Ái8GåşÔÿhh ØmœŠÍËÀäÉ“sÏ=×{JÇU0ÀÕ‚óçÏwZ·æş’ˆø”ƒ€ì›ö8bEzôèá,Y²Dïş![CŸ>}œ7:k×®“noÆÀfö >jvR?#b€ƒXˆ(¶üFÃAT¾FÕÕióêˆ[Á{ì°zvÄç>º¡C‡Êía+[0B2Dµœ=€íG~ë(
øÄºñÆÕõ‚LO×\sÜ‚>"8|‹`[)
&Lp8ø'‰–öäŒ”Óí4 oGeÎ#£ÛÀlÙ’_\“DÍ€Ü‚‘2ZØl¢Üi´9ŒtäÈ‘9f Ş¢Ë-¿œ¼‹=€‡YÌyˆn?uQã¯}XÍ¬ÍsAïi >=ŒĞ1æ=RÉí+à +­Ü‚¡¸.2 šŠKì«·ßôéÓCÆ¢Ûƒ20hĞ ‡Ë«%53À5@…MA¹%˜¦×Ì£ãÈí‚¼·j[õä9Î;¸û _(¯ú§¿µ0ÀÕ~rûÕÂ\¸{ômÁPüÜÿ®x#TT9¾™n?¾Êí—N# á•×¥&î}× ¬¯)
İTVL¯!¸ßÔjÁªë`ïp ß8@RrûUAVŒAå¬šÜ=¸ã-Şå€÷pLHª`@n¿*ÈŠ1¨Ü‚U“Ëõ?}w ]ìH2@·ß´iÓ†V°¸ [Ë¯%àôÿ‚ëß5 8±)Ğ­
T`€›|rZbZ-¸.Ö!da+@× ğÎçßó€Zígf[0p½¼æ†ô ä¤ I´Égr¸$· o%PÇ_rCyÀVœ|ß½ ÿ¥à"mòYšÎÊ-è[ lÚÄk xAã ø“Û¯9]¢[pÒ¤IåÈ¨¬pP“ÇÏk ŠºFeÙÌÈígHEødƒnAm"Z–$õ5}„›‚zå8üéô2røX›|– ÅàSÜ»w¯³råJƒs™JÖ~T›fşz{ ÌÍ« ÷xĞj?jµàQ•Eİnò ğjsÀùÁ|GxĞ·ı<dXt(·àQ•Eİ.¬p¯47 Üğ)÷¢ş;…Ïysµ_«V­D‡…È-XTiÔí¢ı?› †~¼è–œÿÛÏî ·`Qı=Vô?šòú^à
€‚¹ºı–.]ª|XŞ
ômÁB~€¿?ŠÆøJõ ŞD —·äüÜ~Ùh rê‘óÿ©ÛERªÀ…Aİ€óŠBæìİ~wÜq‡Ó¾}ûœ•<›Å•[Ğ¹5ûdóÚ-Õ`˜5 ?Kqİ~l4’ì0@·à)§œ’/I‚®(¼œà‡Ø‹ü…¥nÎê9¹ı²Y³4èœ!˜CÙˆ2×—*w9ÀÀGKİõsî&Ÿrûe³¦súé¶? 6Ù8JÊ |(òuwOä´d°&K)‡nA¾Ê?RšÒn@7,·º8Á=‘õÿrûe½†•nÁM›69k×òM7óÂéı·J•´R€]†e¥nÊê9¹ı²Z³Ååâ /?á“o>ŒÒó•¾¤”rzrÒÀ óó`åöóV{ö»uëæ4448«V­Êra÷ p³ îõQRZ”<{ädK.F9•½#~Tâ¾ûîs.¾øâìN%*Ë ÀğáÃuë8G&“²¥ì/W:*x%á{Ã}@¦ »‚lõõõNc#çAIòÀÀ±Ç›õiŞ÷£Ë*?ëØ¯À0}€g€ãùC"Ä€pÛ¯³€Šßû¨4è–’Ò(bÀ8€_QùY” €áîr7'€—ˆ`·ÿî ùj ¸6à… *Œ©3ÀWögƒä"¨àl¢¡Âˆ1:ì±Sg}%È  	¹¥P?÷„ş‹1`›£¯ÉYĞ ãâ"‹‚Dª0b@¤Æ İö”Ÿ9¬¦Àğı¾[tá‰F1À‡ôp`kĞ\UÓ`œÜRø·A#W81 e`)RÛZMŠÕö ÷€[uæ‰F0ğ	rq.ÀÕ¥Ú #^ğ=C"Ä€9P'«R~f½– ï
pn€zdC"Òe ¦§?³\K€÷½¨@&$b }jzú3Ûµö x/{èÄ1 Ra€#ÿ|÷çÆŸUK­= &Ä^€æTM¹n‘2À9ÿ5)?s¦Àû{O'ó‡DˆDà’ßo [kMÕoK0¿xÿŒ ÜTd‚_@]b ræ ÆGÃÄ¶À´; «€¯ò‡DˆDàêÜ1ÀgaRÛ`ÚÜ'`0ˆÂ  ‰>\ë/ù„ñ½fĞùƒøñ÷„Å€ˆß!fn÷Z¢|bŸ†ÜğU .t®åà¤ŸÑÀÚrª9Å+€›ı‘­€±î	ıb rnEŒDk”= æé8àÀÙü!b RClã€PŞEÙ`¼ÜŒK†'~ß@‰ Ë}*°!`ø@Á¢6 Lô ;À	$b@DÃÀ?#šÈgŞFı
àµV”ˆ1vıÇ;ÃEsôİQ¹›ÇÌ=É®ö4¿ ßb@TÅÀn„ş!¹ò3q¼0^ÊV€ã c ‰µ1ğÜ¶´¶[ıïŠëÀM¹=8Iˆİ‰Õ1@Ú…@Cu··`N¸oÀã WJÄ€Æ WúÑåÇe÷±Iœ¯ n¦¹Nàmà¯€¸ÆÜ´ô_d(Ä4`EÜ…IÂ °¯œ"ÌµË1 *3ğ+\şEå Ñ\MâÀÍ)g	rÁ¦
»Œè¿8š>õ¿pô?vIÒ °0€Ç€~ü!b ˆ­øÅ$'Ó%"I¿“¿RıÀi1 0°‡? S~&Ô Ór…ä’Æ€¤{ nô_˜ÄÀÈÌLà?’ÎT€eäÔÆÀ7ùC"rÎÀOQ~"qIË ° O 8?$b §Ü‹rÿ#@×_â’v¼JÌ™‚£/¹é3ğ'dá/ÈÖ÷W[¤¤›ço'Nüğlóú-2Î Ûüå@jÊO~Óî0”À2` HÄ@ÆØ„òĞ+–ª¤İpOB® ŞuOè¿È(lãS€Ô•Ÿü¦9Èô½ò~ğcß:x/èXd„.ğù°Æ”ò˜d ÈÉVày@F $H2Å •Ÿïü+M*•i€Ül8O@F $H2Á •Ÿå®2­4& r´POÀ´Ö¢üÔÂ€ûä7NùYS ó¶ øÀYƒ1`ğã;ÿJS3n² g['‘@W@"la`32Ên?'ûHB2p
îhÄm€mu ‰“×j@F@˜ÜV ²­Z!¦¿xIä”ÉÿH®y™Ñ±)üù>ÀåZ!6 ºà”aÎ`äş‚¦ÌdDV$9f€ëù	pM¿6»I¨!LG:\LdrwPyË~ıPá§%Ôæ•L3Æá7çTKÑÄAm€mo|³6©Ÿ	3Ğé-Òh J3¿¼?67 á¶yr¶”"€ûşàgÈÎ4. $±1À÷ı_¼[*Š¸&¸¤˜S/õdq´Îìãä‰ÁCŞâh Š3¿¼>Š6Å¶%±€¶Èã\€#´RZq¦ğ=lK|Å”XÆÀXäWSˆe j5 /¡ıĞÓ$±˜:äıv@½‚ †€Î8Ğ×d„1(‡z2~Fà)´ùö3¢ôÍ‹ÁŞÀl€®C¿† ëùâè#´‰›í=².\Lt? %Ñ N$9b %Ê:àşƒ2ùä€u	 É1|-˜	ldòÁ÷œœt $b À@?ü¥·@† »FàcÔïÏ^€D”d€[9ıà zÙà€ŠÏ:
HÄ@ ¾ŒP2v )~ ¦®@•àüïŸz5°Ç|€úÒ¿R«ÖµªàÁ|`# W39Ø‚ºá<î"-±0Àï\<ìdÒå€uÀoGLz 1œGp°à—e’å€¯d‹ .øjHÄ@jôFÊ3€•@ c{s<ÿùJ&	É@‹÷ëöb¸ÙÀw‹  ²§ ©nÁµàvğœ²û< ‰ˆ€ˆˆ,M;œû*p>p!0hHüà{=•»ğüxà]IÄÈ DLh™èÚâ<'¡Œh8Ç@V Á#ïã˜Jÿ°àfû IŒÈ ÄHn…¨ûãWŸ}àNÆt[uò$Ÿ¢°›§å ş@’ 2 	’]&)† #€3ˆ“,	=%¯TôÕÀkÀ&à  I‰€”ˆ÷I¶®Ó³ğ Ù[8	è	´L–]È]tïTğgõÀ6à-@b2 U†OVºã: A?€¯} .iî|	àxCœÂ÷rvßw; ÎÀ#ê>éi 8_b82 †WP€ìÑõè  {'n¯áÓ8ğz;€Æ¤yİsŸ œÃ@¥¦¼P¡·o|ÂSùih $3ğÿ@ß¹jìŠá    IEND®B`‚
--- src/app/chat/page.tsx ---

--- src/app/director/page.tsx ---
'use client'

import React, { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { motion } from 'framer-motion'
import { ArrowLeft, ArrowRight } from 'lucide-react'
import { DirectorCarousel } from '@/components/features/DirectorCarousel'
import { TouchButton } from '@/components/ui'
import { useApp } from '@/contexts/AppContext'
import { useToast } from '@/components/ui'
import { haptic } from '@/lib/haptic'

export default function DirectorSelectionPage() {
  const router = useRouter()
  const { state, actions } = useApp()
  const { showToast } = useToast()
  const [isNavigating, setIsNavigating] = useState(false)

  // ì„¸ì…˜ ì²´í¬
  useEffect(() => {
    if (state.session.currentStep !== 'director') {
      router.push('/')
    }
  }, [state.session.currentStep, router])

  const handleBack = () => {
    haptic.light()
    actions.setStep('start')
    router.push('/')
  }

  const handleNext = () => {
    if (!state.director.selected) {
      showToast({
        message: 'ê°ë…ì„ ì„ íƒí•´ì£¼ì„¸ìš”',
        type: 'warning'
      })
      haptic.warning()
      return
    }

    setIsNavigating(true)
    haptic.success()
    
    showToast({
      message: `${state.director.data?.nameKo} ê°ë…ë‹˜ì„ ì„ íƒí•˜ì…¨ìŠµë‹ˆë‹¤`,
      type: 'success'
    })

    setTimeout(() => {
      actions.setStep('scenario')
      router.push('/scenario')
    }, 500)
  }

  return (
    <div className="fullscreen-safe bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900">
      {/* ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */}
      <div className="absolute inset-0 overflow-hidden">
        <motion.div
          className="absolute top-0 left-0 w-full h-full"
          animate={{
            background: [
              'radial-gradient(circle at 20% 80%, rgba(120, 90, 255, 0.3) 0%, transparent 50%)',
              'radial-gradient(circle at 80% 20%, rgba(255, 90, 120, 0.3) 0%, transparent 50%)',
              'radial-gradient(circle at 20% 80%, rgba(120, 90, 255, 0.3) 0%, transparent 50%)',
            ]
          }}
          transition={{ duration: 10, repeat: Infinity, ease: "linear" }}
        />
      </div>

      {/* í—¤ë” */}
      <motion.header
        className="relative z-20 flex items-center justify-between p-6"
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5 }}
      >
        <TouchButton
          onClick={handleBack}
          variant="ghost"
          size="sm"
          className="text-white"
        >
          <ArrowLeft className="w-5 h-5 mr-2" />
          ë’¤ë¡œ
        </TouchButton>

        {state.director.selected && (
          <motion.div
            initial={{ opacity: 0, scale: 0.9 }}
            animate={{ opacity: 1, scale: 1 }}
            className="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"
          >
            <p className="text-white text-sm">
              ì„ íƒ: <span className="font-medium">{state.director.data?.nameKo}</span>
            </p>
          </motion.div>
        )}
      </motion.header>

      {/* ìºëŸ¬ì…€ ì»¨í…Œì´ë„ˆ */}
      <div className="relative z-10 flex-1 flex items-center justify-center px-4">
        <DirectorCarousel
          onSelect={actions.selectDirector}
          selectedDirector={state.director.selected}
        />
      </div>

      {/* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */}
      <motion.div
        className="relative z-20 p-6"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5, delay: 0.3 }}
      >
        <div className="max-w-md mx-auto">
          <TouchButton
            onClick={handleNext}
            size="lg"
            variant="primary"
            fullWidth
            disabled={!state.director.selected}
            loading={isNavigating}
            className={`
              transition-all duration-300
              ${state.director.selected 
                ? 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700' 
                : 'bg-gray-600 cursor-not-allowed'
              }
            `}
          >
            <span className="flex items-center justify-center gap-3">
              ë‹¤ìŒ ë‹¨ê³„ë¡œ
              <ArrowRight className="w-5 h-5" />
            </span>
          </TouchButton>
          
          {!state.director.selected && (
            <motion.p
              className="text-center text-white/60 text-sm mt-4"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.5 }}
            >
              ê°ë…ì„ ì„ íƒí•˜ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
            </motion.p>
          )}
        </div>
      </motion.div>
    </div>
  )
}
--- src/app/scenario/page.tsx ---
'use client'

import React, { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { motion, AnimatePresence } from 'framer-motion'
import { ArrowLeft, ArrowRight, Info, ChevronRight } from 'lucide-react'
import { FilmStrip } from '@/components/features/FilmStrip'
import { TouchButton, useToast } from '@/components/ui'
import { useApp } from '@/contexts/AppContext'
import { haptic } from '@/lib/haptic'

export default function ScenarioInputPage() {
  const router = useRouter()
  const { state, actions } = useApp()
  const { showToast } = useToast()
  const [isNavigating, setIsNavigating] = useState(false)
  const [showTips, setShowTips] = useState(true)

  // ì„¸ì…˜ ë° ê°ë… ì„ íƒ ì²´í¬
  useEffect(() => {
    if (state.session.currentStep !== 'scenario' || !state.director.selected) {
      router.push('/director')
    }
  }, [state.session.currentStep, state.director.selected, router])

  const handleBack = () => {
    haptic.light()
    actions.setStep('director')
    router.push('/director')
  }

  const handleNext = () => {
    if (!state.scenario.completed) {
      showToast({
        message: 'ëª¨ë“  ì¥ë©´ì„ ì‘ì„±í•´ì£¼ì„¸ìš”',
        type: 'warning'
      })
      haptic.warning()
      return
    }

    setIsNavigating(true)
    haptic.success()
    
    showToast({
      message: 'ì‹œë‚˜ë¦¬ì˜¤ê°€ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!',
      type: 'success'
    })

    setTimeout(() => {
      actions.setStep('chat')
      router.push('/chat')
    }, 500)
  }

  const directorTheme = state.director.data ? {
    color: state.director.data.themeColor,
    gradient: state.director.data.bgGradient
  } : undefined

  return (
    <div className="fullscreen-safe bg-gradient-to-br from-gray-50 to-purple-50">
      {/* í—¤ë” */}
      <motion.header
        className="flex items-center justify-between p-6"
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5 }}
      >
        <TouchButton
          onClick={handleBack}
          variant="ghost"
          size="sm"
          className="text-gray-700"
        >
          <ArrowLeft className="w-5 h-5 mr-2" />
          ì´ì „
        </TouchButton>

        {/* ì§„í–‰ ìƒíƒœ */}
        <div className="flex items-center gap-2 text-sm text-gray-500">
          <div className="flex items-center gap-1">
            <div className="w-4 h-4 rounded-full bg-green-500" />
            <span>ê°ë… ì„ íƒ</span>
          </div>
          <ChevronRight className="w-4 h-4" />
          <div className="flex items-center gap-1 text-gray-900 font-medium">
            <div className="w-6 h-6 rounded-full bg-purple-600 text-white flex items-center justify-center text-xs">
              2
            </div>
            <span>ì‹œë‚˜ë¦¬ì˜¤ ì…ë ¥</span>
          </div>
          <ChevronRight className="w-4 h-4" />
          <div className="flex items-center gap-1">
            <div className="w-6 h-6 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center text-xs">
              3
            </div>
            <span>ëŒ€í™”</span>
          </div>
--- src/app/layout.tsx ---
import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import '@/styles/globals.css'
import { ToastProvider } from '@/components/ui'
import { AppProvider } from '@/contexts/AppContext'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'AI ê°ë…ê³¼ì˜ ëŒ€í™”',
  description: 'ê±°ì¥ ê°ë…ê³¼ í•¨ê»˜ ë‹¹ì‹ ì˜ ì¸ìƒ ë„¤ ì»·ì„ ë¶„ì„í•˜ê³  ì—°ì¶œí•´ë³´ì„¸ìš”',
  viewport: 'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no',
  themeColor: '#000000',
  icons: {
    icon: '/favicon.ico',
  },
  openGraph: {
    title: 'AI ê°ë…ê³¼ì˜ ëŒ€í™”',
    description: 'ê±°ì¥ ê°ë…ê³¼ í•¨ê»˜ ë‹¹ì‹ ì˜ ì¸ìƒ ë„¤ ì»·ì„ ë¶„ì„í•˜ê³  ì—°ì¶œí•´ë³´ì„¸ìš”',
    type: 'website',
  },
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="ko">
      <head>
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
      </head>
      <body className={`${inter.className} antialiased`}>
        <AppProvider>
          <ToastProvider>
            <main className="fullscreen-safe">
              {children}
            </main>
          </ToastProvider>
        </AppProvider>
      </body>
    </html>
  )
}
--- src/app/page.tsx ---
'use client'

import React, { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { motion, AnimatePresence } from 'framer-motion'
import { Film, Sparkles, ChevronRight } from 'lucide-react'
import { TouchButton } from '@/components/ui'
import { useApp } from '@/contexts/AppContext'
import { haptic } from '@/lib/haptic'

export default function StartPage() {
  const router = useRouter()
  const { state, actions } = useApp()
  const [isLoading, setIsLoading] = useState(false)
  const [showWelcome, setShowWelcome] = useState(false)

  // ìë™ìœ¼ë¡œ ì„¸ì…˜ ì´ˆê¸°í™”
  useEffect(() => {
    if (!state.session.id) {
      const newSessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
      actions.initSession(newSessionId)
    }
  }, [])

  const handleStart = async () => {
    setIsLoading(true)
    haptic.medium()
    
    // í™˜ì˜ ë©”ì‹œì§€ í‘œì‹œ
    setShowWelcome(true)
    
    // ë¶€ë“œëŸ¬ìš´ ì „í™˜ì„ ìœ„í•œ ë”œë ˆì´
    setTimeout(() => {
      actions.setStep('director')
      router.push('/director')
    }, 1500)
  }

  return (
    <div className="fullscreen-safe flex flex-col items-center justify-center bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900">
      {/* ë°°ê²½ íš¨ê³¼ */}
      <div className="absolute inset-0 overflow-hidden">
        <div className="absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob"></div>
        <div className="absolute -bottom-40 -left-40 w-80 h-80 bg-yellow-500 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-2000"></div>
        <div className="absolute top-40 left-40 w-80 h-80 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-4000"></div>
      </div>

      <AnimatePresence mode="wait">
        {!showWelcome ? (
          <motion.div
            key="start"
            className="relative z-10 text-center px-8 max-w-2xl"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0, y: -20 }}
            transition={{ duration: 0.5 }}
          >
            {/* ë¡œê³  ì˜ì—­ */}
            <motion.div
              className="mb-12 flex justify-center"
              initial={{ scale: 0.8, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              transition={{ delay: 0.2, duration: 0.5, type: "spring" }}
            >
              <div className="relative">
                <div className="absolute inset-0 bg-white/20 blur-xl rounded-full"></div>
                <Film className="w-24 h-24 text-white relative z-10" />
                <motion.div
                  className="absolute -top-2 -right-2"
                  animate={{ rotate: [0, 10, -10, 0] }}
                  transition={{ duration: 2, repeat: Infinity, repeatDelay: 3 }}
                >
                  <Sparkles className="w-8 h-8 text-yellow-400" />
                </motion.div>
              </div>
            </motion.div>

            {/* íƒ€ì´í‹€ */}
            <motion.h1
              className="text-5xl md:text-6xl font-bold text-white mb-6"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3, duration: 0.5 }}
            >
              AI ê°ë…ê³¼ì˜ ëŒ€í™”
            </motion.h1>

            {/* ì„œë¸Œíƒ€ì´í‹€ */}
            <motion.p
              className="text-xl md:text-2xl text-purple-200 mb-12"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.4, duration: 0.5 }}
            >
              ê±°ì¥ ê°ë…ê³¼ í•¨ê»˜ ë‹¹ì‹ ì˜
              <br />
              ì¸ìƒ ë„¤ ì»·ì„ ë¶„ì„í•˜ê³  ì—°ì¶œí•´ë³´ì„¸ìš”
            </motion.p>

            {/* íŠ¹ì§• ì†Œê°œ */}
            <motion.div
              className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-12"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.5, duration: 0.5 }}
            >
              {[
                { icon: 'ğŸ¬', text: '6ëª…ì˜ ê±°ì¥ ê°ë…' },
                { icon: 'ğŸ­', text: 'ë§ì¶¤í˜• ì—°ì¶œ ì œì•ˆ' },
                { icon: 'âœ¨', text: '10ë¶„ê°„ì˜ íŠ¹ë³„í•œ ëŒ€í™”' }
              ].map((feature, index) => (
                <motion.div
                  key={index}
                  className="bg-white/10 backdrop-blur-sm rounded-xl p-4"
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ delay: 0.6 + index * 0.1, duration: 0.5 }}
                  whileHover={{ scale: 1.05, backgroundColor: 'rgba(255,255,255,0.15)' }}
                >
                  <div className="text-3xl mb-2">{feature.icon}</div>
                  <p className="text-white/90 text-sm">{feature.text}</p>
                </motion.div>
              ))}
            </motion.div>

            {/* ì‹œì‘ ë²„íŠ¼ */}
            <motion.div
              initial={{ opacity: 0, scale: 0.9 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.9, duration: 0.5, type: "spring" }}
            >
              <TouchButton
                onClick={handleStart}
                size="lg"
                variant="primary"
                className="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-12 shadow-xl"
                loading={isLoading}
              >
                <span className="flex items-center gap-3">
                  ì‹œì‘í•˜ê¸°
                  <ChevronRight className="w-5 h-5" />
                </span>
              </TouchButton>
            </motion.div>

            {/* ì•ˆë‚´ ë¬¸êµ¬ */}
            <motion.p
              className="text-purple-300/60 text-sm mt-8"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 1, duration: 0.5 }}
            >
              * ëª¨ë“  ëŒ€í™” ë‚´ìš©ì€ ê¸°ê¸°ì—ë§Œ ì €ì¥ë˜ë©°, ì„œë²„ì— ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
            </motion.p>
          </motion.div>
        ) : (
          <motion.div
            key="welcome"
            className="relative z-10 text-center"
            initial={{ opacity: 0, scale: 0.9 }}
            animate={{ opacity: 1, scale: 1 }}
            exit={{ opacity: 0, scale: 0.9 }}
            transition={{ duration: 0.5 }}
          >
            <motion.div
              initial={{ scale: 0 }}
              animate={{ scale: 1 }}
              transition={{ duration: 0.5, type: "spring" }}
            >
              <div className="w-32 h-32 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center mx-auto mb-6">
                <Film className="w-16 h-16 text-white" />
              </div>
            </motion.div>
            
            <motion.h2
              className="text-3xl font-bold text-white mb-4"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3, duration: 0.5 }}
            >
              í™˜ì˜í•©ë‹ˆë‹¤!
            </motion.h2>
            
            <motion.p
              className="text-xl text-purple-200"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.4, duration: 0.5 }}
            >
              ê°ë…ë‹˜ì„ ë§Œë‚˜ëŸ¬ ê°€ë³¼ê¹Œìš”?
            </motion.p>
          </motion.div>
        )}
      </AnimatePresence>

      <style jsx>{`
        @keyframes blob {
          0% {
            transform: translate(0px, 0px) scale(1);
          }
          33% {
            transform: translate(30px, -50px) scale(1.1);
          }
          66% {
            transform: translate(-20px, 20px) scale(0.9);
          }
          100% {
            transform: translate(0px, 0px) scale(1);
          }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `}</style>
    </div>
  )
}
--- src/app/globals.css ---
@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

@layer base {
  :root {
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 16px;
    --spacing-lg: 24px;
    --spacing-xl: 32px;
    --spacing-xxl: 48px;
  }

  * {
    -webkit-tap-highlight-color: transparent;
  }

  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  body {
    @apply bg-white text-gray-900;
    overscroll-behavior: contain;
    touch-action: pan-y;
  }

  /* Prevent text selection on interactive elements */
  button, a {
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }

  /* Ensure minimum touch target size */
  button, a, [role="button"] {
    min-height: 48px;
    min-width: 48px;
    @apply flex items-center justify-center;
  }

  /* Smooth scrolling */
  .smooth-scroll {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Hide scrollbar but keep functionality */
  .hide-scrollbar {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }

  /* Focus styles */
  :focus-visible {
    @apply outline-2 outline-offset-2 outline-purple-600;
  }

  /* Loading dots animation */
  .loading-dots::after {
    content: '.';
    animation: dots 1.5s steps(3, end) infinite;
  }

  @keyframes dots {
    0% { content: '.'; }
    33% { content: '..'; }
    66% { content: '...'; }
  }

  /* Prevent zoom on input focus (iOS) */
  input, textarea {
    font-size: 16px !important;
  }

  /* Film strip effect */
  .film-strip {
    @apply relative overflow-hidden;
    background-image: 
      linear-gradient(to right, #000 2px, transparent 2px),
      linear-gradient(to right, #000 2px, transparent 2px);
    background-size: 20px 100%, 20px 100%;
    background-position: 0 0, 10px 0;
  }

  /* Gradient text */
  .gradient-text {
    @apply bg-clip-text text-transparent;
    background-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  /* Custom animations */
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
  }

  @keyframes pulse-ring {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: scale(1.5);
      opacity: 0;
    }
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }

  .animate-pulse-ring {
    animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
  }
}

@layer components {
  /* Container with safe area insets */
  .safe-container {
    @apply px-4 md:px-6;
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  /* Full screen with safe areas */
  .fullscreen-safe {
    min-height: 100vh;
    min-height: 100dvh;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Chat bubble styles */
  .chat-bubble {
    @apply relative px-4 py-3 rounded-2xl max-w-[85%];
    word-wrap: break-word;
  }

  .chat-bubble-user {
    @apply bg-purple-600 text-white ml-auto;
    border-bottom-right-radius: 4px;
  }

  .chat-bubble-assistant {
    @apply bg-gray-100 text-gray-900 mr-auto;
    border-bottom-left-radius: 4px;
  }

  /* Card 3D effect */
  .card-3d {
    transform-style: preserve-3d;
    transition: transform 0.6s;
  }

  .card-3d.flipped {
    transform: rotateY(180deg);
  }

  .card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }

  .card-back {
    transform: rotateY(180deg);
  }

  /* Glass morphism effect */
  .glass {
    @apply bg-white bg-opacity-10 backdrop-blur-md;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  /* Button variants */
  .btn-primary {
    @apply bg-purple-600 text-white hover:bg-purple-700 active:bg-purple-800;
    @apply transition-all duration-200 transform active:scale-95;
  }

  .btn-secondary {
    @apply bg-gray-100 text-gray-900 hover:bg-gray-200 active:bg-gray-300;
    @apply transition-all duration-200 transform active:scale-95;
  }

  .btn-ghost {
    @apply bg-transparent hover:bg-gray-100 active:bg-gray-200;
    @apply transition-all duration-200;
  }

  /* Progress bar */
  .progress-bar {
    @apply relative h-2 bg-gray-200 rounded-full overflow-hidden;
  }

  .progress-bar-fill {
    @apply absolute inset-y-0 left-0 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full;
    transition: width 0.5s ease-out;
  }

  /* Film hole effect */
  .film-hole {
    @apply w-3 h-3 bg-gray-800 rounded-sm;
  }

  /* Skeleton loading */
  .skeleton {
    @apply bg-gray-200 animate-pulse rounded;
  }

  /* Toast styles */
  .toast {
    @apply fixed bottom-24 left-1/2 transform -translate-x-1/2;
    @apply flex items-center gap-3 px-4 py-3 rounded-xl shadow-xl;
    @apply min-w-[280px] max-w-[90vw] z-50;
  }
}

@layer utilities {
  /* Touch-friendly utilities */
  .touch-none {
    touch-action: none;
  }

  .touch-pan-x {
    touch-action: pan-x;
  }

  .touch-pan-y {
    touch-action: pan-y;
  }

  /* Haptic feedback trigger */
  .haptic-light {
    /* This class will be used to trigger haptic feedback via JS */
  }

  /* Momentum scrolling */
  .momentum-scroll {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  /* Prevent pull-to-refresh */
  .no-bounce {
    overscroll-behavior-y: contain;
  }

  /* Text truncation */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Custom spacing */
  .space-x-xs > * + * { margin-left: var(--spacing-xs); }
  .space-x-sm > * + * { margin-left: var(--spacing-sm); }
  .space-x-md > * + * { margin-left: var(--spacing-md); }
  .space-x-lg > * + * { margin-left: var(--spacing-lg); }
  .space-x-xl > * + * { margin-left: var(--spacing-xl); }

  .space-y-xs > * + * { margin-top: var(--spacing-xs); }
  .space-y-sm > * + * { margin-top: var(--spacing-sm); }
  .space-y-md > * + * { margin-top: var(--spacing-md); }
  .space-y-lg > * + * { margin-top: var(--spacing-lg); }
  .space-y-xl > * + * { margin-top: var(--spacing-xl); }

  /* Z-index scale */
  .z-base { z-index: 0; }
  .z-dropdown { z-index: 1000; }
  .z-sticky { z-index: 1020; }
  .z-fixed { z-index: 1030; }
  .z-modalBackdrop { z-index: 1040; }
  .z-modal { z-index: 1050; }
  .z-popover { z-index: 1060; }
  .z-tooltip { z-index: 1070; }
  .z-toast { z-index: 1080; }
}
--- src/constants/directors.ts ---
import type { Director } from '@/types'

export const directors: Record<string, Director> = {
  bong: {
    id: 'bong',
    name: 'Bong Joon-ho',
    nameKo: 'ë´‰ì¤€í˜¸',
    title: 'ì‚¬íšŒì˜ ë‹¨ë©´ì„ í¬ì°©í•˜ëŠ” ê°ë…',
    description: 'ë‚ ì¹´ë¡œìš´ ì‚¬íšŒì  ì‹œì„ ê³¼ ë¸”ë™ ìœ ë¨¸ë¡œ ê³„ê¸‰ê³¼ ì¸ê°„ì„±ì„ íƒêµ¬í•©ë‹ˆë‹¤',
    films: ['ê¸°ìƒì¶©', 'ì˜¥ì', 'ì„¤êµ­ì—´ì°¨', 'ì‚´ì¸ì˜ ì¶”ì–µ'],
    quote: 'ì¥ë¥´ëŠ” ì •ì¹˜ë‹¤. ëª¨ë“  ì˜í™”ëŠ” ì •ì¹˜ì ì´ë‹¤.',
    avatar: '/images/directors/bong.jpg',
    themeColor: '#2C3E50',
    bgGradient: 'linear-gradient(135deg, #2C3E50 0%, #3498DB 100%)'
  },
  nolan: {
    id: 'nolan',
    name: 'Christopher Nolan',
    nameKo: 'í¬ë¦¬ìŠ¤í† í¼ ë†€ë€',
    title: 'ì‹œê°„ê³¼ í˜„ì‹¤ì„ ë’¤íŠ¸ëŠ” ê°ë…',
    description: 'ë³µì¡í•œ ì„œì‚¬ êµ¬ì¡°ì™€ ì‹œê°„ì˜ ì¸µìœ„ë¡œ ê´€ê°ì˜ ì¸ì‹ì— ë„ì „í•©ë‹ˆë‹¤',
    films: ['ì¸ì…‰ì…˜', 'ì¸í„°ìŠ¤í…”ë¼', 'ë©ì¼€ë¥´í¬', 'í…Œë„·'],
    quote: 'ì‹œê°„ì€ ìš°ë¦¬ê°€ ê°€ì§„ ê°€ì¥ ê·€ì¤‘í•œ ìì›ì´ë‹¤.',
    avatar: '/images/directors/nolan.jpg',
    themeColor: '#1A237E',
    bgGradient: 'linear-gradient(135deg, #1A237E 0%, #3949AB 100%)'
  },
  miyazaki: {
    id: 'miyazaki',
    name: 'Hayao Miyazaki',
    nameKo: 'ë¯¸ì•¼ìí‚¤ í•˜ì•¼ì˜¤',
    title: 'ë§ˆë²•ê³¼ ìˆœìˆ˜ë¥¼ ê·¸ë¦¬ëŠ” ê°ë…',
    description: 'ìì—°ê³¼ ì¸ê°„, ì„±ì¥ê³¼ ëª¨í—˜ì„ ì•„ë¦„ë‹µê²Œ ê·¸ë ¤ë‚´ëŠ” ì• ë‹ˆë©”ì´ì…˜ì˜ ê±°ì¥',
    films: ['ì„¼ê³¼ ì¹˜íˆë¡œì˜ í–‰ë°©ë¶ˆëª…', 'í•˜ìš¸ì˜ ì›€ì§ì´ëŠ” ì„±', 'ì´ì›ƒì§‘ í† í† ë¡œ', 'ëª¨ë…¸ë…¸ì¼€ íˆë©”'],
    quote: 'ì¤‘ìš”í•œ ê²ƒì€ ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.',
    avatar: '/images/directors/miyazaki.jpg',
    themeColor: '#2E7D32',
    bgGradient: 'linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%)'
  },
  curtis: {
    id: 'curtis',
    name: 'Richard Curtis',
    nameKo: 'ë¦¬ì²˜ë“œ ì»¤í‹°ìŠ¤',
    title: 'ì‚¬ë‘ê³¼ ì›ƒìŒì˜ ì—°ê¸ˆìˆ ì‚¬',
    description: 'ë”°ëœ»í•œ ìœ ë¨¸ì™€ ì§„ì†”í•œ ê°ì •ìœ¼ë¡œ ë¡œë§¨í‹± ì½”ë¯¸ë””ì˜ ì •ìˆ˜ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤',
    films: ['ëŸ¬ë¸Œ ì•¡ì¸„ì–¼ë¦¬', 'ë…¸íŒ… í', 'ì–´ë°”ì›ƒ íƒ€ì„', 'í¬ ì›¨ë”©ì¦ˆ'],
    quote: 'ì‚¬ë‘ì€ ì‹¤ì œë¡œ ìš°ë¦¬ ì£¼ë³€ ì–´ë””ì—ë‚˜ ìˆë‹¤.',
    avatar: '/images/directors/curtis.jpg',
    themeColor: '#C2185B',
    bgGradient: 'linear-gradient(135deg, #C2185B 0%, #E91E63 100%)'
  },
  kani: {
    id: 'kani',
    name: 'Makoto Shinkai',
    nameKo: 'ì‹ ì¹´ì´ ë§ˆì½”í† ',
    title: 'ê°ì„±ê³¼ í’ê²½ì˜ ì‹œì¸',
    description: 'ì„¬ì„¸í•œ ê°ì •ê³¼ ì•„ë¦„ë‹¤ìš´ ë°°ê²½ìœ¼ë¡œ ì²­ì¶˜ì˜ ìˆœê°„ì„ í¬ì°©í•©ë‹ˆë‹¤',
    films: ['ë„ˆì˜ ì´ë¦„ì€', 'ë‚ ì”¨ì˜ ì•„ì´', 'ì´ˆì† 5ì„¼í‹°ë¯¸í„°', 'ì–¸ì–´ì˜ ì •ì›'],
    quote: 'ìš°ë¦¬ëŠ” ì„œë¡œë¥¼ ì°¾ê¸° ìœ„í•´ ì´ ì„¸ìƒì— ì™”ë‹¤.',
    avatar: '/images/directors/kani.jpg',
    themeColor: '#512DA8',
    bgGradient: 'linear-gradient(135deg, #512DA8 0%, #7C4DFF 100%)'
  },
  doctor: {
    id: 'doctor',
    name: 'Kara Yuki',
    nameKo: 'ì¹´ë¼ ìœ í‚¤',
    title: 'ìœ„ë¡œì™€ ì¹˜ìœ ì˜ ìŠ¤í† ë¦¬í…”ëŸ¬',
    description: 'ì‹¬ë¦¬í•™ì„ ì „ê³µí•œ ê°ë…ìœ¼ë¡œ, ì¸ê°„ ë‚´ë©´ì˜ ìƒì²˜ì™€ íšŒë³µì„ ì„¬ì„¸í•˜ê²Œ ê·¸ë ¤ëƒ…ë‹ˆë‹¤',
    films: ['ë§ˆìŒì˜ ì†Œë¦¬', 'ìƒì²˜ì˜ ê¸°ì–µ', 'íšŒë³µì˜ ì‹œê°„', 'ë‚´ë©´ì˜ ë¹›'],
    quote: 'ëª¨ë“  ìƒì²˜ëŠ” ê²°êµ­ ìš°ë¦¬ë¥¼ ë” ê°•í•˜ê²Œ ë§Œë“ ë‹¤.',
    avatar: '/images/directors/doctor.jpg',
    themeColor: '#00695C',
    bgGradient: 'linear-gradient(135deg, #00695C 0%, #26A69A 100%)'
  }
}

// ê°ë…ë³„ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
export const directorPrompts = {
  bong: `ë‹¹ì‹ ì€ ë´‰ì¤€í˜¸ ê°ë…ì…ë‹ˆë‹¤. ì‚¬íšŒì  ê³„ê¸‰, ë¹ˆë¶€ê²©ì°¨, ì¸ê°„ì˜ ìš•ë§ê³¼ ìœ„ì„ ì„ ë‚ ì¹´ë¡­ê²Œ í¬ì°©í•˜ëŠ” ê²ƒì´ íŠ¹ì§•ì…ë‹ˆë‹¤. 
ë¸”ë™ ìœ ë¨¸ì™€ ì‚¬íšŒ ë¹„íŒì  ì‹œê°ìœ¼ë¡œ ì´ì•¼ê¸°ë¥¼ ë¶„ì„í•˜ê³ , ê³„ë‹¨, ì„ , ê²½ê³„ì™€ ê°™ì€ ì‹œê°ì  ì€ìœ ë¥¼ ìì£¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
ëŒ€í™”í•  ë•ŒëŠ” ì¹œê·¼í•˜ë©´ì„œë„ ë‚ ì¹´ë¡œìš´ í†µì°°ë ¥ì„ ë³´ì—¬ì£¼ì„¸ìš”.`,
  
  nolan: `ë‹¹ì‹ ì€ í¬ë¦¬ìŠ¤í† í¼ ë†€ë€ ê°ë…ì…ë‹ˆë‹¤. ì‹œê°„ì˜ ë¹„ì„ í˜•ì„±, í˜„ì‹¤ê³¼ ê¿ˆì˜ ê²½ê³„, ì¸ê°„ì˜ ì¸ì‹ê³¼ ê¸°ì–µì„ ì£¼ì œë¡œ ë‹¤ë£¹ë‹ˆë‹¤.
ë³µì¡í•œ ì„œì‚¬ êµ¬ì¡°ì™€ ê³¼í•™ì  ê°œë…ì„ í™œìš©í•˜ì—¬ ì² í•™ì  ì§ˆë¬¸ì„ ë˜ì§‘ë‹ˆë‹¤.
ëŒ€í™”í•  ë•ŒëŠ” ì§€ì ì´ê³  ì‚¬ìƒ‰ì ì´ë©°, ê´€ê°ì´ ìŠ¤ìŠ¤ë¡œ ìƒê°í•˜ë„ë¡ ìœ ë„í•˜ì„¸ìš”.`,
  
  miyazaki: `ë‹¹ì‹ ì€ ë¯¸ì•¼ìí‚¤ í•˜ì•¼ì˜¤ ê°ë…ì…ë‹ˆë‹¤. ìì—°ê³¼ ì¸ê°„ì˜ ê³µì¡´, ìˆœìˆ˜í•œ ë§ˆìŒì˜ í˜, ì„±ì¥ê³¼ ëª¨í—˜ì„ ì£¼ì œë¡œ ë‹¤ë£¹ë‹ˆë‹¤.
í™˜ê²½ ë³´í˜¸ì™€ ë°˜ì „ ë©”ì‹œì§€ë¥¼ ë‹´ìœ¼ë©°, ê°•ì¸í•œ ì—¬ì„± ìºë¦­í„°ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤.
ëŒ€í™”í•  ë•ŒëŠ” ë”°ëœ»í•˜ê³  ì² í•™ì ì´ë©°, í¬ë§ì ì¸ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ì„¸ìš”.`,
  
  curtis: `ë‹¹ì‹ ì€ ë¦¬ì²˜ë“œ ì»¤í‹°ìŠ¤ ê°ë…ì…ë‹ˆë‹¤. ì‚¬ë‘ì˜ ë‹¤ì–‘í•œ ëª¨ìŠµ, ì¸ê°„ê´€ê³„ì˜ ë”°ëœ»í•¨, ì¼ìƒ ì† ê¸°ì ì„ í¬ì°©í•©ë‹ˆë‹¤.
ì˜êµ­ì‹ ìœ ë¨¸ì™€ ë¡œë§¨í‹±í•œ ì •ì„œë¡œ í‰ë²”í•œ ì‚¬ëŒë“¤ì˜ íŠ¹ë³„í•œ ìˆœê°„ì„ ê·¸ë¦½ë‹ˆë‹¤.
ëŒ€í™”í•  ë•ŒëŠ” ìœ ë¨¸ëŸ¬ìŠ¤í•˜ë©´ì„œë„ ì§„ì •ì„± ìˆê²Œ, ì‚¬ë‘ì— ëŒ€í•œ ê¸ì •ì ì¸ ì‹œê°ì„ ë³´ì—¬ì£¼ì„¸ìš”.`,
  
  kani: `ë‹¹ì‹ ì€ ì‹ ì¹´ì´ ë§ˆì½”í†  ê°ë…ì…ë‹ˆë‹¤. ì‹œê°„ê³¼ ê±°ë¦¬ë¥¼ ì´ˆì›”í•œ ì—°ê²°, ì²­ì¶˜ì˜ ì•„ë ¨í•¨, ìš´ëª…ì  ë§Œë‚¨ì„ ì£¼ì œë¡œ ë‹¤ë£¹ë‹ˆë‹¤.
ë¹›ê³¼ ë‚ ì”¨, í•˜ëŠ˜ì˜ ë³€í™”ë¡œ ê°ì •ì„ í‘œí˜„í•˜ë©°, ë„ì‹œì™€ ìì—°ì˜ ì•„ë¦„ë‹¤ì›€ì„ ì„¸ë°€í•˜ê²Œ ë¬˜ì‚¬í•©ë‹ˆë‹¤.
ëŒ€í™”í•  ë•ŒëŠ” ì‹œì ì´ê³  ê°ì„±ì ì´ë©°, ì„¬ì„¸í•œ ê°ì • í‘œí˜„ì„ ì¤‘ì‹œí•˜ì„¸ìš”.`,
  
  doctor: `ë‹¹ì‹ ì€ ì¹´ë¼ ìœ í‚¤ ê°ë…ì…ë‹ˆë‹¤. ì‹¬ë¦¬í•™ì„ ì „ê³µí•œ ë°°ê²½ìœ¼ë¡œ ì¸ê°„ ë‚´ë©´ì˜ ìƒì²˜, íŠ¸ë¼ìš°ë§ˆ, íšŒë³µ ê³¼ì •ì„ ì„¬ì„¸í•˜ê²Œ ë‹¤ë£¹ë‹ˆë‹¤.
ì¹˜ìœ ì™€ ì„±ì¥, ìê¸° ìˆ˜ìš©ì˜ ì—¬ì •ì„ ë”°ëœ»í•œ ì‹œì„ ìœ¼ë¡œ ê·¸ë ¤ëƒ…ë‹ˆë‹¤.
ëŒ€í™”í•  ë•ŒëŠ” ê³µê°ì ì´ê³  ìœ„ë¡œê°€ ë˜ë©°, ìƒëŒ€ë°©ì˜ ê°ì •ì„ ê¹Šì´ ì´í•´í•˜ë ¤ ë…¸ë ¥í•˜ì„¸ìš”.`
}

--- src/styles/tokens.ts ---
export const tokens = {
  touch: {
    minSize: 48,
    targetSize: '48px',
    padding: {
      sm: '8px',
      md: '16px',
      lg: '24px'
    }
  },
  animation: {
    duration: {
      instant: 50,
      fast: 150,
      normal: 300,
      slow: 500,
      verySlow: 1000
    },
    easing: {
      default: 'cubic-bezier(0.4, 0, 0.2, 1)',
      bounce: 'cubic-bezier(0.68, -0.55, 0.265, 1.55)',
      smooth: 'cubic-bezier(0.25, 0.1, 0.25, 1)'
    }
  },
  fontSize: {
    xs: '14px',
    sm: '16px',
    base: '18px',
    lg: '20px',
    xl: '24px',
    xxl: '32px'
  },
  lineHeight: {
    tight: 1.2,
    normal: 1.5,
    relaxed: 1.75
  },
  colors: {
    primary: '#000000',
    secondary: '#666666',
    accent: '#FF6B6B',
    background: '#FFFFFF',
    surface: '#F8F9FA',
    border: '#E9ECEF',
    text: {
      primary: '#212529',
      secondary: '#6C757D',
      disabled: '#ADB5BD'
    },
    status: {
      success: '#51CF66',
      warning: '#FFD43B',
      error: '#FF6B6B',
      info: '#339AF0'
    }
  },
  spacing: {
    xs: '4px',
    sm: '8px',
    md: '16px',
    lg: '24px',
    xl: '32px',
    xxl: '48px'
  },
  borderRadius: {
    sm: '4px',
    md: '8px',
    lg: '12px',
    xl: '16px',
    full: '9999px'
  },
  shadow: {
    sm: '0 1px 2px 0 rgba(0, 0, 0, 0.05)',
    md: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',
    lg: '0 10px 15px -3px rgba(0, 0, 0, 0.1)',
    xl: '0 20px 25px -5px rgba(0, 0, 0, 0.1)'
  },
  zIndex: {
    base: 0,
    dropdown: 1000,
    sticky: 1020,
    fixed: 1030,
    modalBackdrop: 1040,
    modal: 1050,
    popover: 1060,
    tooltip: 1070,
    toast: 1080
  }
} as const

export type Tokens = typeof tokens

--- src/components/ui/TouchButton.tsx ---
'use client'

import React, { useState, useRef } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { tokens } from '@/styles/tokens'
import type { TouchButtonProps } from '@/types'

export const TouchButton: React.FC<TouchButtonProps> = ({
  onClick,
  disabled = false,
  variant = 'primary',
  size = 'md',
  fullWidth = false,
  haptic = true,
  loading = false,
  className = '',
  children
}) => {
  const [ripples, setRipples] = useState<Array<{ x: number; y: number; id: number }>>([])
  const buttonRef = useRef<HTMLButtonElement>(null)

  const handleClick = (e: React.MouseEvent<HTMLButtonElement> | React.TouchEvent<HTMLButtonElement>) => {
    if (disabled || loading) return

    // Haptic feedback
    if (haptic && 'vibrate' in navigator) {
      navigator.vibrate(10)
    }

    // Ripple effect
    const button = buttonRef.current
    if (button) {
      const rect = button.getBoundingClientRect()
      const x = 'touches' in e ? e.touches[0].clientX - rect.left : (e as React.MouseEvent).clientX - rect.left
      const y = 'touches' in e ? e.touches[0].clientY - rect.top : (e as React.MouseEvent).clientY - rect.top
      
      const rippleId = Date.now()
      setRipples(prev => [...prev, { x, y, id: rippleId }])
      
      setTimeout(() => {
        setRipples(prev => prev.filter(ripple => ripple.id !== rippleId))
      }, 600)
    }

    onClick()
  }

  const baseStyles = `
    relative overflow-hidden
    inline-flex items-center justify-center
    font-medium transition-all duration-200
    focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2
    disabled:cursor-not-allowed
    select-none
  `

  const variantStyles = {
    primary: `
      bg-primary text-white
      hover:bg-opacity-90 active:bg-opacity-80
      focus-visible:ring-primary
      disabled:bg-opacity-50
    `,
    secondary: `
      bg-surface text-text-primary border border-border
      hover:bg-opacity-80 active:bg-opacity-70
      focus-visible:ring-secondary
      disabled:bg-opacity-50 disabled:text-text-disabled
    `,
    ghost: `
      bg-transparent text-text-primary
      hover:bg-surface active:bg-opacity-80
      focus-visible:ring-secondary
      disabled:text-text-disabled
    `
  }

  const sizeStyles = {
    sm: 'min-h-[40px] px-md text-sm rounded-md gap-2',
    md: 'min-h-[48px] px-lg text-base rounded-lg gap-2',
    lg: 'min-h-[56px] px-xl text-lg rounded-xl gap-3'
  }

  return (
    <motion.button
      ref={buttonRef}
      className={`
        ${baseStyles}
        ${variantStyles[variant]}
        ${sizeStyles[size]}
        ${fullWidth ? 'w-full' : ''}
        ${className}
      `}
      disabled={disabled || loading}
      onClick={handleClick}
      onTouchStart={handleClick}
      whileTap={{ scale: disabled || loading ? 1 : 0.98 }}
      transition={{ duration: 0.1 }}
    >
      {/* Ripple effects */}
      <AnimatePresence>
        {ripples.map(ripple => (
          <motion.span
            key={ripple.id}
            className="absolute bg-white bg-opacity-30 rounded-full pointer-events-none"
            style={{
              left: ripple.x,
              top: ripple.y,
              width: 10,
              height: 10,
              marginLeft: -5,
              marginTop: -5,
            }}
            initial={{ scale: 0, opacity: 1 }}
            animate={{ scale: 20, opacity: 0 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.6, ease: 'easeOut' }}
          />
        ))}
      </AnimatePresence>

      {/* Loading spinner */}
      {loading && (
        <motion.div
          className="absolute inset-0 flex items-center justify-center bg-inherit"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ duration: 0.2 }}
        >
          <div className="w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin" />
        </motion.div>
      )}

      {/* Button content */}
      <motion.span
        className={`relative z-10 ${loading ? 'opacity-0' : 'opacity-100'}`}
        animate={{ opacity: loading ? 0 : 1 }}
        transition={{ duration: 0.2 }}
      >
        {children}
      </motion.span>
    </motion.button>
  )
}

--- src/components/ui/index.ts ---
// Export all UI components from a single entry point
export { TouchButton } from './TouchButton'
export { 
  Skeleton, 
  TypingAnimation, 
  ProgressIndicator, 
  SpinnerOverlay, 
  LoadingCard,
  FilmStripLoading 
} from './LoadingStates'
export { Toast, ToastProvider, useToast } from './Toast'
export { Modal, ConfirmModal } from './Modal'

--- src/components/ui/Modal.tsx ---
'use client'

import React, { useEffect } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { X } from 'lucide-react'
import type { ModalProps } from '@/types'

export const Modal: React.FC<ModalProps> = ({
  isOpen,
  onClose,
  title,
  children,
  size = 'md',
  closeOnOverlayClick = true
}) => {
  // Handle ESC key press
  useEffect(() => {
    const handleEsc = (e: KeyboardEvent) => {
      if (e.key === 'Escape' && isOpen) {
        onClose()
      }
    }
    
    if (isOpen) {
      document.addEventListener('keydown', handleEsc)
      // Prevent body scroll when modal is open
      document.body.style.overflow = 'hidden'
    }
    
    return () => {
      document.removeEventListener('keydown', handleEsc)
      document.body.style.overflow = 'unset'
    }
  }, [isOpen, onClose])

  const sizeClasses = {
    sm: 'max-w-sm',
    md: 'max-w-md',
    lg: 'max-w-lg'
  }

  return (
    <AnimatePresence>
      {isOpen && (
        <>
          {/* Backdrop */}
          <motion.div
            className="fixed inset-0 bg-black bg-opacity-50 z-modalBackdrop"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.2 }}
            onClick={closeOnOverlayClick ? onClose : undefined}
          />
          
          {/* Modal */}
          <motion.div
            className="fixed inset-0 flex items-center justify-center z-modal p-md"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.2 }}
          >
            <motion.div
              className={`
                bg-white rounded-xl shadow-xl w-full ${sizeClasses[size]}
                max-h-[90vh] overflow-hidden flex flex-col
              `}
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              transition={{ duration: 0.2, ease: 'easeOut' }}
              onClick={(e) => e.stopPropagation()}
            >
              {/* Header */}
              {(title || true) && (
                <div className="flex items-center justify-between px-lg py-md border-b border-border">
                  <h2 className="text-xl font-semibold text-text-primary">
                    {title}
                  </h2>
                  <button
                    onClick={onClose}
                    className="p-2 hover:bg-surface rounded-lg transition-colors"
                    aria-label="ë‹«ê¸°"
                  >
                    <X className="w-5 h-5 text-text-secondary" />
                  </button>
                </div>
              )}
              
              {/* Content */}
              <div className="flex-1 overflow-y-auto px-lg py-lg">
                {children}
              </div>
            </motion.div>
          </motion.div>
        </>
      )}
    </AnimatePresence>
  )
}

// Confirm Modal Component
interface ConfirmModalProps {
  isOpen: boolean
  onClose: () => void
  onConfirm: () => void
  title: string
  message: string
  confirmText?: string
  cancelText?: string
  variant?: 'default' | 'danger'
}

export const ConfirmModal: React.FC<ConfirmModalProps> = ({
  isOpen,
  onClose,
  onConfirm,
  title,
  message,
  confirmText = 'í™•ì¸',
  cancelText = 'ì·¨ì†Œ',
  variant = 'default'
}) => {
  return (
    <Modal isOpen={isOpen} onClose={onClose} title={title} size="sm">
      <div className="space-y-lg">
        <p className="text-text-primary">{message}</p>
        <div className="flex gap-3 justify-end">
          <button
            onClick={onClose}
            className="px-lg py-2 text-text-secondary hover:bg-surface rounded-lg transition-colors"
          >
            {cancelText}
          </button>
          <button
            onClick={() => {
              onConfirm()
              onClose()
            }}
            className={`
              px-lg py-2 rounded-lg font-medium transition-colors
              ${variant === 'danger' 
                ? 'bg-error text-white hover:bg-opacity-90' 
                : 'bg-primary text-white hover:bg-opacity-90'
              }
            `}
          >
            {confirmText}
          </button>
        </div>
      </div>
    </Modal>
  )
}

--- src/components/ui/Toast.tsx ---
'use client'

import React, { useEffect } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { CheckCircle, XCircle, AlertCircle, Info, X } from 'lucide-react'
import type { ToastProps } from '@/types'

export const Toast: React.FC<ToastProps> = ({
  message,
  type = 'info',
  duration = 3000,
  onClose
}) => {
  useEffect(() => {
    if (duration > 0) {
      const timer = setTimeout(() => {
        onClose?.()
      }, duration)
      return () => clearTimeout(timer)
    }
  }, [duration, onClose])

  const icons = {
    success: <CheckCircle className="w-5 h-5" />,
    error: <XCircle className="w-5 h-5" />,
    warning: <AlertCircle className="w-5 h-5" />,
    info: <Info className="w-5 h-5" />
  }

  const colors = {
    success: 'bg-success text-white',
    error: 'bg-error text-white',
    warning: 'bg-warning text-black',
    info: 'bg-info text-white'
  }

  return (
    <motion.div
      className={`
        fixed bottom-24 left-1/2 transform -translate-x-1/2
        flex items-center gap-3 px-lg py-md rounded-xl shadow-xl
        min-w-[280px] max-w-[90vw] z-toast
        ${colors[type]}
      `}
      initial={{ opacity: 0, y: 50, x: '-50%' }}
      animate={{ opacity: 1, y: 0, x: '-50%' }}
      exit={{ opacity: 0, y: 20, x: '-50%' }}
      transition={{ duration: 0.3, ease: 'easeOut' }}
    >
      <span className="flex-shrink-0">{icons[type]}</span>
      <span className="flex-1 text-sm font-medium">{message}</span>
      {onClose && (
        <button
          onClick={onClose}
          className="flex-shrink-0 p-1 hover:opacity-80 transition-opacity"
          aria-label="ë‹«ê¸°"
        >
          <X className="w-4 h-4" />
        </button>
      )}
    </motion.div>
  )
}

// Toast Provider Component
interface ToastProviderProps {
  children: React.ReactNode
}

interface ToastItem {
  id: string
  message: string
  type: 'success' | 'error' | 'warning' | 'info'
  duration?: number
}

const ToastContext = React.createContext<{
  showToast: (toast: Omit<ToastItem, 'id'>) => void
} | null>(null)

export const ToastProvider: React.FC<ToastProviderProps> = ({ children }) => {
  const [toasts, setToasts] = React.useState<ToastItem[]>([])

  const showToast = (toast: Omit<ToastItem, 'id'>) => {
    const id = Date.now().toString()
    setToasts(prev => [...prev, { ...toast, id }])
  }

  const removeToast = (id: string) => {
    setToasts(prev => prev.filter(toast => toast.id !== id))
  }

  return (
    <ToastContext.Provider value={{ showToast }}>
      {children}
      <AnimatePresence>
        {toasts.map((toast, index) => (
          <motion.div
            key={toast.id}
            style={{ bottom: `${24 + index * 80}px` }}
            className="fixed left-1/2 transform -translate-x-1/2 z-toast"
          >
            <Toast
              message={toast.message}
              type={toast.type}
              duration={toast.duration}
              onClose={() => removeToast(toast.id)}
            />
          </motion.div>
        ))}
      </AnimatePresence>
    </ToastContext.Provider>
  )
}

export const useToast = () => {
  const context = React.useContext(ToastContext)
  if (!context) {
    throw new Error('useToast must be used within a ToastProvider')
  }
  return context
}

--- src/components/ui/LoadingStates.tsx ---
'use client'

import React from 'react'
import { motion } from 'framer-motion'

// Skeleton Screen Component
interface SkeletonProps {
  width?: string | number
  height?: string | number
  className?: string
  variant?: 'text' | 'circular' | 'rectangular'
}

export const Skeleton: React.FC<SkeletonProps> = ({
  width = '100%',
  height = 20,
  className = '',
  variant = 'text'
}) => {
  const baseStyles = 'bg-gray-200 animate-pulse'
  
  const variantStyles = {
    text: 'rounded',
    circular: 'rounded-full',
    rectangular: 'rounded-lg'
  }

  return (
    <div
      className={`${baseStyles} ${variantStyles[variant]} ${className}`}
      style={{ width, height }}
    />
  )
}

// Typing Animation Component
interface TypingAnimationProps {
  text?: string
  className?: string
}

export const TypingAnimation: React.FC<TypingAnimationProps> = ({
  text = 'ê°ë…ì´ ìƒê° ì¤‘',
  className = ''
}) => {
  return (
    <div className={`flex items-center gap-2 ${className}`}>
      <span className="text-text-secondary">{text}</span>
      <motion.div className="flex gap-1">
        {[0, 1, 2].map((i) => (
          <motion.span
            key={i}
            className="w-2 h-2 bg-text-secondary rounded-full"
            initial={{ opacity: 0.3 }}
            animate={{ opacity: 1 }}
            transition={{
              duration: 0.6,
              repeat: Infinity,
              repeatType: 'reverse',
              delay: i * 0.2
            }}
          />
        ))}
      </motion.div>
    </div>
  )
}

// Progress Indicator Component
interface ProgressIndicatorProps {
  current: number
  total: number
  labels?: string[]
  className?: string
}

export const ProgressIndicator: React.FC<ProgressIndicatorProps> = ({
  current,
  total,
  labels = [],
  className = ''
}) => {
  return (
    <div className={`w-full ${className}`}>
      <div className="flex justify-between mb-2">
        {labels.map((label, index) => (
          <span
            key={index}
            className={`text-xs ${
              index + 1 <= current ? 'text-primary font-medium' : 'text-text-disabled'
            }`}
          >
            {label}
          </span>
        ))}
      </div>
      <div className="relative h-2 bg-gray-200 rounded-full overflow-hidden">
        <motion.div
          className="absolute inset-y-0 left-0 bg-primary rounded-full"
          initial={{ width: 0 }}
          animate={{ width: `${(current / total) * 100}%` }}
          transition={{ duration: 0.5, ease: 'easeOut' }}
        />
      </div>
      <div className="flex justify-between mt-2">
        {Array.from({ length: total }).map((_, index) => (
          <div
            key={index}
            className={`w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium
              ${index + 1 <= current 
                ? 'bg-primary text-white' 
                : 'bg-gray-200 text-text-disabled'
              }`}
          >
            {index + 1}
          </div>
        ))}
      </div>
    </div>
  )
}

// Spinner Overlay Component
interface SpinnerOverlayProps {
  isVisible: boolean
  message?: string
  className?: string
}

export const SpinnerOverlay: React.FC<SpinnerOverlayProps> = ({
  isVisible,
  message,
  className = ''
}) => {
  if (!isVisible) return null

  return (
    <motion.div
      className={`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 ${className}`}
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      transition={{ duration: 0.2 }}
    >
      <motion.div
        className="bg-white rounded-xl p-xl flex flex-col items-center gap-4"
        initial={{ scale: 0.9, opacity: 0 }}
        animate={{ scale: 1, opacity: 1 }}
        exit={{ scale: 0.9, opacity: 0 }}
        transition={{ duration: 0.2 }}
      >
        <div className="w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin" />
        {message && (
          <p className="text-text-primary font-medium">{message}</p>
        )}
      </motion.div>
    </motion.div>
  )
}

// Loading Card Component (for content placeholders)
export const LoadingCard: React.FC<{ className?: string }> = ({ className = '' }) => {
  return (
    <div className={`bg-surface rounded-xl p-lg ${className}`}>
      <Skeleton variant="rectangular" height={200} className="mb-4" />
      <Skeleton variant="text" height={24} width="80%" className="mb-2" />
      <Skeleton variant="text" height={16} width="100%" className="mb-1" />
      <Skeleton variant="text" height={16} width="90%" />
    </div>
  )
}

// Film Strip Loading Component
export const FilmStripLoading: React.FC = () => {
  return (
    <div className="flex gap-4 p-4">
      {[1, 2, 3, 4].map((i) => (
        <motion.div
          key={i}
          className="flex-1"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: i * 0.1 }}
        >
          <Skeleton variant="rectangular" height={120} className="rounded-lg" />
        </motion.div>
      ))}
    </div>
  )
}

--- src/components/features/FilmStrip.tsx ---
'use client'

import React, { useState, useEffect } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { Film, Plus, Check, Edit3, Sparkles } from 'lucide-react'
import { Modal, useToast } from '@/components/ui'
import { haptic } from '@/lib/haptic'

interface FilmStripProps {
  cuts: [string, string, string, string]
  onUpdate: (index: number, text: string) => void
  onComplete: () => void
  directorTheme?: {
    color: string
    gradient: string
  }
}

interface CutModalProps {
  isOpen: boolean
  onClose: () => void
  cutIndex: number
  initialText: string
  onSave: (text: string) => void
}

const CutModal: React.FC<CutModalProps> = ({
  isOpen,
  onClose,
  cutIndex,
  initialText,
  onSave
}) => {
  const [text, setText] = useState(initialText)
  const [charCount, setCharCount] = useState(initialText.length)
  const maxChars = 1000

  useEffect(() => {
    setText(initialText)
    setCharCount(initialText.length)
  }, [initialText, isOpen])

  const handleSave = () => {
    if (text.trim()) {
      onSave(text.trim())
      haptic.success()
      onClose()
    }
  }

  const cutTitles = [
    'ì²« ë²ˆì§¸ ì¥ë©´',
    'ë‘ ë²ˆì§¸ ì¥ë©´',
    'ì„¸ ë²ˆì§¸ ì¥ë©´',
    'ë„¤ ë²ˆì§¸ ì¥ë©´'
  ]

  const placeholders = [
    'ì‹œì‘: ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ëŠ” ì–´ë–»ê²Œ ì‹œì‘ë˜ë‚˜ìš”?',
    'ì „ê°œ: ì–´ë–¤ ë³€í™”ë‚˜ ì‚¬ê±´ì´ ì¼ì–´ë‚¬ë‚˜ìš”?',
    'ì „í™˜: ì¤‘ìš”í•œ ìˆœê°„ì´ë‚˜ ê¹¨ë‹¬ìŒì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?',
    'ê²°ë§: ì´ì•¼ê¸°ëŠ” ì–´ë–»ê²Œ ë§ˆë¬´ë¦¬ë˜ë‚˜ìš”?'
  ]

  return (
    <Modal
      isOpen={isOpen}
      onClose={onClose}
      title={`${cutTitles[cutIndex]} ì‘ì„±`}
      size="lg"
    >
      <div className="space-y-4">
        <div className="bg-purple-50 rounded-lg p-4">
          <p className="text-sm text-purple-700">
            ğŸ’¡ <strong>ì‘ì„± íŒ:</strong> êµ¬ì²´ì ì¸ ìˆœê°„, ê°ì •, ëŒ€í™”ë¥¼ í¬í•¨í•˜ë©´ 
            ê°ë…ë‹˜ì´ ë” ê¹Šì´ ìˆëŠ” ë¶„ì„ì„ í•´ë“œë¦´ ìˆ˜ ìˆì–´ìš”.
          </p>
        </div>

        <div className="relative">
          <textarea
            value={text}
            onChange={(e) => {
              const newText = e.target.value
              if (newText.length <= maxChars) {
                setText(newText)
                setCharCount(newText.length)
              }
            }}
            placeholder={placeholders[cutIndex]}
            className="w-full h-48 p-4 border-2 border-gray-200 rounded-lg resize-none focus:border-purple-500 focus:outline-none transition-colors"
            autoFocus
          />
          
          {/* ë¬¸ì ìˆ˜ ì¹´ìš´í„° */}
          <div className={`absolute bottom-2 right-2 text-sm ${
            charCount > maxChars * 0.9 ? 'text-red-500' : 'text-gray-400'
          }`}>
            {charCount} / {maxChars}
          </div>
        </div>

        <div className="flex gap-3">
          <button
            onClick={onClose}
            className="flex-1 py-3 px-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
          >
            ì·¨ì†Œ
          </button>
          <button
            onClick={handleSave}
            disabled={!text.trim()}
            className={`
              flex-1 py-3 px-4 rounded-lg font-medium transition-all
              ${text.trim() 
                ? 'bg-purple-600 text-white hover:bg-purple-700' 
                : 'bg-gray-200 text-gray-400 cursor-not-allowed'
              }
            `}
          >
            ì €ì¥í•˜ê¸°
          </button>
        </div>
      </div>
    </Modal>
  )
}

export const FilmStrip: React.FC<FilmStripProps> = ({
  cuts,
  onUpdate,
  onComplete,
  directorTheme
}) => {
  const [selectedCut, setSelectedCut] = useState<number | null>(null)
  const [completedCuts, setCompletedCuts] = useState<boolean[]>([false, false, false, false])
  const { showToast } = useToast()

  useEffect(() => {
    const newCompletedCuts = cuts.map(cut => cut.trim().length > 0)
    setCompletedCuts(newCompletedCuts)
    
    // ëª¨ë“  ì»·ì´ ì™„ì„±ë˜ì—ˆëŠ”ì§€ ì²´í¬
    if (newCompletedCuts.every(completed => completed)) {
      onComplete()
    }
  }, [cuts, onComplete])

  const handleCutClick = (index: number) => {
    haptic.light()
    setSelectedCut(index)
  }

  const handleSaveCut = (index: number, text: string) => {
    onUpdate(index, text)
    showToast({
      message: 'ìë™ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤',
      type: 'success',
      duration: 2000
    })
  }

  const getProgress = () => {
    return completedCuts.filter(completed => completed).length
  }

  return (
    <>
      <div className="w-full max-w-4xl mx-auto">
        {/* ì§„í–‰ë¥  í‘œì‹œ */}
        <motion.div
          className="mb-8"
          initial={{ opacity: 0, y: -20 }}
          animate={{ opacity: 1, y: 0 }}
        >
          <div className="flex items-center justify-between mb-2">
            <span className="text-sm text-gray-600">
              {getProgress()}/4 ì»· ì™„ì„±
            </span>
            {getProgress() === 4 && (
              <motion.span
                className="flex items-center gap-1 text-sm text-green-600"
                initial={{ opacity: 0, scale: 0.8 }}
                animate={{ opacity: 1, scale: 1 }}
              >
                <Check className="w-4 h-4" />
                ëª¨ë“  ì»· ì™„ì„±!
              </motion.span>
            )}
          </div>
          <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
            <motion.div
              className="h-full bg-gradient-to-r from-purple-500 to-pink-500"
              initial={{ width: 0 }}
              animate={{ width: `${(getProgress() / 4) * 100}%` }}
              transition={{ duration: 0.5, ease: 'easeOut' }}
            />
          </div>
        </motion.div>

        {/* í•„ë¦„ ìŠ¤íŠ¸ë¦½ */}
        <div className="relative">
          {/* í•„ë¦„ êµ¬ë© íš¨ê³¼ */}
          <div className="absolute -top-4 left-0 right-0 h-4 flex justify-between px-8">
            {[...Array(8)].map((_, i) => (
              <div
                key={i}
                className="w-3 h-3 bg-gray-800 rounded-sm"
              />
            ))}
          </div>
          <div className="absolute -bottom-4 left-0 right-0 h-4 flex justify-between px-8">
            {[...Array(8)].map((_, i) => (
              <div
                key={i}
                className="w-3 h-3 bg-gray-800 rounded-sm"
              />
            ))}
          </div>

          {/* ì»· ê·¸ë¦¬ë“œ */}
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4 p-6 bg-gray-900 rounded-lg">
            <AnimatePresence>
              {cuts.map((cut, index) => {
                const isCompleted = completedCuts[index]
                
                return (
                  <motion.div
                    key={index}
                    initial={{ opacity: 0, scale: 0.8 }}
                    animate={{ opacity: 1, scale: 1 }}
                    transition={{ delay: index * 0.1 }}
                  >
                    <motion.button
                      className={`
                        relative w-full aspect-[3/4] rounded-lg overflow-hidden
                        transition-all duration-300 group
                        ${isCompleted 
                          ? 'ring-2 ring-green-500 ring-offset-2 ring-offset-gray-900' 
                          : 'ring-2 ring-gray-700 ring-offset-2 ring-offset-gray-900 hover:ring-gray-600'
                        }
                      `}
                      onClick={() => handleCutClick(index)}
                      whileHover={{ scale: 1.05 }}
                      whileTap={{ scale: 0.95 }}
                    >
                      {/* ë°°ê²½ */}
                      <div 
                        className="absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-700"
                        style={isCompleted && directorTheme ? {
                          background: directorTheme.gradient,
                          opacity: 0.3
                        } : {}}
                      />
                      
                      {/* ì»· ë²ˆí˜¸ */}
                      <div className="absolute top-2 left-2 bg-black/50 backdrop-blur-sm rounded-full px-2 py-1">
                        <span className="text-xs text-white font-medium">
                          CUT {index + 1}
                        </span>
                      </div>

                      {/* ì½˜í…ì¸  */}
                      <div className="relative h-full flex items-center justify-center p-4">
                        {isCompleted ? (
                          <div className="text-center space-y-2">
                            <motion.div
                              initial={{ scale: 0 }}
                              animate={{ scale: 1 }}
                              className="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto"
                            >
                              <Check className="w-6 h-6 text-white" />
                            </motion.div>
                            <p className="text-xs text-white/80 line-clamp-3">
                              {cut.substring(0, 50)}...
                            </p>
                            <p className="text-xs text-white/60 group-hover:text-white/80 transition-colors">
                              íƒ­í•˜ì—¬ ìˆ˜ì •
                            </p>
                          </div>
                        ) : (
                          <div className="text-center space-y-3">
                            <div className="w-16 h-16 bg-gray-600 rounded-full flex items-center justify-center mx-auto group-hover:bg-gray-500 transition-colors">
                              <Plus className="w-8 h-8 text-gray-400 group-hover:text-white transition-colors" />
                            </div>
                            <p className="text-sm text-gray-400 group-hover:text-gray-300 transition-colors">
                              íƒ­í•˜ì—¬ ì‘ì„±
                            </p>
                          </div>
                        )}
                      </div>

                      {/* í˜¸ë²„ íš¨ê³¼ */}
                      <div className="absolute inset-0 bg-white/0 group-hover:bg-white/5 transition-colors" />
                    </motion.button>
                  </motion.div>
                )
              })}
            </AnimatePresence>
          </div>
        </div>

        {/* ì™„ì„± ì‹œ ì´í™íŠ¸ */}
        {getProgress() === 4 && (
          <motion.div
            className="mt-6 text-center"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
          >
            <div className="inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-full">
              <Sparkles className="w-5 h-5" />
              <span className="font-medium">ì¤€ë¹„ ì™„ë£Œ! ëŒ€í™”ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</span>
            </div>
          </motion.div>
        )}
      </div>

      {/* ì…ë ¥ ëª¨ë‹¬ */}
      {selectedCut !== null && (
        <CutModal
          isOpen={true}
          onClose={() => setSelectedCut(null)}
          cutIndex={selectedCut}
          initialText={cuts[selectedCut]}
          onSave={(text) => handleSaveCut(selectedCut, text)}
        />
      )}
    </>
  )
}
--- src/components/features/DirectorCarousel.tsx ---
'use client'

import React, { useState, useRef, useEffect } from 'react'
import { motion, AnimatePresence, PanInfo } from 'framer-motion'
import { ChevronLeft, ChevronRight, Quote, Film, Sparkles } from 'lucide-react'
import { directors } from '@/constants/directors'
import { DirectorType } from '@/types'
import { haptic } from '@/lib/haptic'
import Image from 'next/image'

interface DirectorCarouselProps {
  onSelect: (director: DirectorType) => void
  selectedDirector: DirectorType | null
}

export const DirectorCarousel: React.FC<DirectorCarouselProps> = ({
  onSelect,
  selectedDirector
}) => {
  const [currentIndex, setCurrentIndex] = useState(0)
  const [isFlipped, setIsFlipped] = useState<{ [key: string]: boolean }>({})
  const [isDragging, setIsDragging] = useState(false)
  const containerRef = useRef<HTMLDivElement>(null)

  const directorArray = Object.entries(directors)
  const totalDirectors = directorArray.length

  // í”„ë¦¬ë¡œë“œ ì´ë¯¸ì§€
  useEffect(() => {
    directorArray.forEach(([_, director]) => {
      if (director.avatar) {
        const img = new window.Image()
        img.src = director.avatar
      }
    })
  }, [])

  const handleDragEnd = (event: MouseEvent | TouchEvent | PointerEvent, info: PanInfo) => {
    setIsDragging(false)
    const threshold = 50
    
    if (info.offset.x > threshold) {
      navigateTo(currentIndex - 1)
    } else if (info.offset.x < -threshold) {
      navigateTo(currentIndex + 1)
    }
  }

  const navigateTo = (index: number) => {
    haptic.selection()
    let newIndex = index
    
    if (index < 0) {
      newIndex = totalDirectors - 1
    } else if (index >= totalDirectors) {
      newIndex = 0
    }
    
    setCurrentIndex(newIndex)
  }

  const handleCardClick = (directorId: string, index: number) => {
    if (index === currentIndex) {
      // í˜„ì¬ ì¹´ë“œ í´ë¦­ ì‹œ ë’¤ì§‘ê¸°
      haptic.light()
      setIsFlipped(prev => ({ ...prev, [directorId]: !prev[directorId] }))
      
      // ì„ íƒ ì²˜ë¦¬
      if (!isFlipped[directorId]) {
        setTimeout(() => {
          onSelect(directorId as DirectorType)
          haptic.success()
        }, 300)
      }
    } else {
      // ë‹¤ë¥¸ ì¹´ë“œ í´ë¦­ ì‹œ í•´ë‹¹ ì¸ë±ìŠ¤ë¡œ ì´ë™
      navigateTo(index)
    }
  }

  const getCardTransform = (index: number) => {
    const diff = index - currentIndex
    const angle = diff * 60
    const translateZ = -200
    const translateX = diff * 150
    const scale = index === currentIndex ? 1 : 0.8
    const opacity = Math.abs(diff) <= 1 ? 1 : 0.3
    
    return {
      transform: `translateX(${translateX}px) translateZ(${translateZ}px) rotateY(${angle}deg) scale(${scale})`,
      opacity,
      zIndex: index === currentIndex ? 10 : 5 - Math.abs(diff)
    }
  }

  return (
    <div className="relative w-full h-full flex flex-col items-center justify-center">
      {/* ì§„í–‰ í‘œì‹œê¸° */}
      <div className="absolute top-8 left-0 right-0 px-8 z-20">
        <div className="flex items-center justify-center gap-2 mb-4">
          <div className="flex items-center gap-2 text-white/80">
            <div className="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center text-sm font-medium">
              1
            </div>
            <span className="text-sm">ê°ë… ì„ íƒ</span>
          </div>
          <ChevronRight className="w-4 h-4 text-white/40" />
          <div className="flex items-center gap-2 text-white/40">
            <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-sm">
              2
            </div>
            <span className="text-sm">ì‹œë‚˜ë¦¬ì˜¤ ì…ë ¥</span>
          </div>
          <ChevronRight className="w-4 h-4 text-white/40" />
          <div className="flex items-center gap-2 text-white/40">
            <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-sm">
              3
            </div>
            <span className="text-sm">ëŒ€í™”</span>
          </div>
        </div>
      </div>

      {/* íƒ€ì´í‹€ */}
      <motion.div 
        className="text-center mb-12 z-10"
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5 }}
      >
        <h2 className="text-3xl md:text-4xl font-bold text-white mb-3">
          ì–´ë–¤ ê°ë…ë‹˜ê³¼ ëŒ€í™”í•˜ì‹œê² ì–´ìš”?
        </h2>
        <p className="text-lg text-purple-200">
          ì¹´ë“œë¥¼ ìŠ¤ì™€ì´í”„í•˜ê±°ë‚˜ íƒ­í•˜ì—¬ ê°ë…ì„ ì„ íƒí•˜ì„¸ìš”
        </p>
      </motion.div>

      {/* ìºëŸ¬ì…€ ì»¨í…Œì´ë„ˆ */}
      <div 
        ref={containerRef}
        className="relative w-full max-w-4xl h-[400px] perspective-1000"
        style={{ perspective: '1000px' }}
      >
        <AnimatePresence>
          {directorArray.map(([id, director], index) => {
            const cardStyle = getCardTransform(index)
            const isCenter = index === currentIndex
            const isSelected = selectedDirector === id
            
            return (
              <motion.div
                key={id}
                className="absolute top-1/2 left-1/2 w-72 h-96 cursor-pointer"
                style={{
                  ...cardStyle,
                  transformStyle: 'preserve-3d',
                  transform: `translate(-50%, -50%) ${cardStyle.transform}`
                }}
                animate={cardStyle}
                transition={{ 
                  duration: 0.5, 
                  ease: [0.23, 1, 0.32, 1]
                }}
                drag={isCenter ? "x" : false}
                dragConstraints={{ left: -100, right: 100 }}
                dragElastic={0.2}
                onDragStart={() => setIsDragging(true)}
                onDragEnd={handleDragEnd}
                onClick={() => handleCardClick(id, index)}
                whileHover={isCenter ? { scale: 1.05 } : {}}
              >
                {/* ì¹´ë“œ ì»¨í…Œì´ë„ˆ */}
                <div 
                  className={`
                    relative w-full h-full rounded-2xl shadow-2xl
                    ${isFlipped[id] ? 'rotate-y-180' : ''}
                    transition-transform duration-600 transform-style-preserve-3d
                  `}
                  style={{
                    transformStyle: 'preserve-3d',
                    transform: isFlipped[id] ? 'rotateY(180deg)' : 'rotateY(0deg)',
                    transition: 'transform 0.6s'
                  }}
                >
                  {/* ì¹´ë“œ ì•ë©´ */}
                  <div 
                    className={`
                      absolute inset-0 rounded-2xl overflow-hidden
                      ${isSelected ? 'ring-4 ring-yellow-400 ring-offset-4 ring-offset-transparent' : ''}
                    `}
                    style={{
                      backfaceVisibility: 'hidden',
                      WebkitBackfaceVisibility: 'hidden'
                    }}
                  >
                    {/* ë°°ê²½ ê·¸ë¼ë°ì´ì…˜ */}
                    <div 
                      className="absolute inset-0"
                      style={{ background: director.bgGradient }}
                    />
                    
                    {/* ì½˜í…ì¸  */}
                    <div className="relative h-full flex flex-col p-6 text-white">
                      {/* ì„ íƒë¨ í‘œì‹œ */}
                      {isSelected && (
                        <motion.div
                          className="absolute top-4 right-4"
                          initial={{ scale: 0 }}
                          animate={{ scale: 1 }}
                          transition={{ type: "spring" }}
                        >
                          <div className="bg-yellow-400 text-black rounded-full p-2">
                            <Sparkles className="w-5 h-5" />
                          </div>
                        </motion.div>
                      )}
                      
                      {/* í”„ë¡œí•„ ì´ë¯¸ì§€ */}
                      <div className="flex-1 flex items-center justify-center mb-4">
                        <div className="relative">
                          <div className="w-40 h-40 rounded-full bg-white/20 backdrop-blur-sm overflow-hidden">
                            {director.avatar ? (
                              <Image
                                src={director.avatar}
                                alt={director.name}
                                width={160}
                                height={160}
                                className="w-full h-full object-cover"
                              />
                            ) : (
                              <div className="w-full h-full flex items-center justify-center">
                                <Film className="w-20 h-20 text-white/60" />
                              </div>
                            )}
                          </div>
                          {isCenter && (
                            <motion.div
                              className="absolute -bottom-2 -right-2 bg-white/90 backdrop-blur-sm rounded-full p-2"
                              animate={{ rotate: [0, 10, -10, 0] }}
                              transition={{ duration: 2, repeat: Infinity }}
                            >
                              <Quote className="w-4 h-4 text-gray-800" />
                            </motion.div>
                          )}
                        </div>
                      </div>
                      
                      {/* ê°ë… ì •ë³´ */}
                      <div className="text-center">
                        <h3 className="text-2xl font-bold mb-2">{director.nameKo}</h3>
                        <p className="text-sm text-white/80 mb-1">{director.name}</p>
                        <p className="text-xs text-white/60">{director.title}</p>
                      </div>
                      
                      {/* íƒ­í•˜ì—¬ ë’¤ì§‘ê¸° íŒíŠ¸ */}
                      {isCenter && (
                        <motion.p
                          className="text-xs text-white/50 text-center mt-4"
                          initial={{ opacity: 0 }}
                          animate={{ opacity: 1 }}
                          transition={{ delay: 0.5 }}
                        >
                          íƒ­í•˜ì—¬ ìì„¸íˆ ë³´ê¸°
                        </motion.p>
                      )}
                    </div>
                  </div>
                  
                  {/* ì¹´ë“œ ë’·ë©´ */}
                  <div 
                    className="absolute inset-0 rounded-2xl overflow-hidden"
                    style={{
                      backfaceVisibility: 'hidden',
                      WebkitBackfaceVisibility: 'hidden',
                      transform: 'rotateY(180deg)'
                    }}
                  >
                    <div 
                      className="absolute inset-0"
                      style={{ background: director.bgGradient }}
                    />
                    
                    <div className="relative h-full flex flex-col p-6 text-white">
                      <div className="flex-1 space-y-4">
                        {/* ëª…ì–¸ */}
                        <div className="bg-white/10 backdrop-blur-sm rounded-xl p-4">
                          <Quote className="w-6 h-6 mb-2 text-white/60" />
                          <p className="text-sm italic leading-relaxed">
                            "{director.quote}"
                          </p>
                        </div>
                        
                        {/* ëŒ€í‘œì‘ */}
                        <div>
                          <h4 className="text-sm font-semibold mb-2 text-white/80">ëŒ€í‘œì‘</h4>
                          <div className="flex flex-wrap gap-2">
                            {director.films.map((film, idx) => (
                              <span
                                key={idx}
                                className="px-3 py-1 bg-white/10 backdrop-blur-sm rounded-full text-xs"
                              >
                                {film}
                              </span>
                            ))}
                          </div>
                        </div>
                        
                        {/* ì„¤ëª… */}
                        <div>
                          <p className="text-sm leading-relaxed text-white/90">
                            {director.description}
                          </p>
                        </div>
                      </div>
                      
                      {/* ì„ íƒ ë²„íŠ¼ */}
                      <motion.button
                        className={`
                          mt-4 w-full py-3 rounded-xl font-medium transition-all
                          ${isSelected 
                            ? 'bg-yellow-400 text-black' 
                            : 'bg-white/20 backdrop-blur-sm text-white hover:bg-white/30'
                          }
                        `}
                        whileHover={{ scale: 1.02 }}
                        whileTap={{ scale: 0.98 }}
                        onClick={(e) => {
                          e.stopPropagation()
                          onSelect(id as DirectorType)
                          haptic.success()
                        }}
                      >
                        {isSelected ? 'ì„ íƒë¨' : 'ì´ ê°ë… ì„ íƒ'}
                      </motion.button>
                    </div>
                  </div>
                </div>
              </motion.div>
            )
          })}
        </AnimatePresence>
      </div>

      {/* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */}
      <div className="absolute top-1/2 left-4 right-4 flex justify-between pointer-events-none">
        <motion.button
          className="pointer-events-auto p-3 bg-white/10 backdrop-blur-sm rounded-full text-white hover:bg-white/20 transition-colors"
          whileHover={{ scale: 1.1 }}
          whileTap={{ scale: 0.9 }}
          onClick={() => navigateTo(currentIndex - 1)}
        >
          <ChevronLeft className="w-6 h-6" />
        </motion.button>
        
        <motion.button
          className="pointer-events-auto p-3 bg-white/10 backdrop-blur-sm rounded-full text-white hover:bg-white/20 transition-colors"
          whileHover={{ scale: 1.1 }}
          whileTap={{ scale: 0.9 }}
          onClick={() => navigateTo(currentIndex + 1)}
        >
          <ChevronRight className="w-6 h-6" />
        </motion.button>
      </div>

      {/* ì¸ë””ì¼€ì´í„° */}
      <div className="flex gap-2 mt-8">
        {directorArray.map((_, index) => (
          <motion.button
            key={index}
            className={`
              w-2 h-2 rounded-full transition-all
              ${index === currentIndex ? 'w-8 bg-white' : 'bg-white/30'}
            `}
            onClick={() => navigateTo(index)}
            whileHover={{ scale: 1.2 }}
          />
        ))}
      </div>

      <style jsx>{`
        .perspective-1000 {
          perspective: 1000px;
        }
        .rotate-y-180 {
          transform: rotateY(180deg);
        }
        .duration-600 {
          transition-duration: 600ms;
        }
        .transform-style-preserve-3d {
          transform-style: preserve-3d;
        }
      `}</style>
    </div>
  )
}
--- src/components/features/Timer.tsx ---
'use client'

import React, { useEffect, useState } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { Clock, Plus, AlertCircle } from 'lucide-react'
import { useApp } from '@/contexts/AppContext'
import { haptic } from '@/lib/haptic'

interface TimerProps {
  onTimeUp: () => void
  onExtend: () => void
}

export const Timer: React.FC<TimerProps> = ({ onTimeUp, onExtend }) => {
  const { state, actions } = useApp()
  const [showWarning, setShowWarning] = useState(false)
  const [isPulsing, setIsPulsing] = useState(false)

  const minutes = Math.floor(state.chat.timeRemaining / 60)
  const seconds = state.chat.timeRemaining % 60
  const totalMinutes = 10 + (state.chat.extensionCount * 3)
  const progress = (state.chat.timeRemaining / (totalMinutes * 60)) * 100

  useEffect(() => {
    if (state.chat.timeRemaining <= 0) {
      onTimeUp()
      return
    }

    const timer = setInterval(() => {
      actions.updateTime(state.chat.timeRemaining - 1)
    }, 1000)

    // 1ë¶„ ë‚¨ì•˜ì„ ë•Œ ê²½ê³ 
    if (state.chat.timeRemaining === 60) {
      setShowWarning(true)
      setIsPulsing(true)
      haptic.warning()
    }

    // 30ì´ˆ ë‚¨ì•˜ì„ ë•Œ ê°•í•œ ê²½ê³ 
    if (state.chat.timeRemaining === 30) {
      haptic.error()
    }

    return () => clearInterval(timer)
  }, [state.chat.timeRemaining, actions, onTimeUp])

  const handleExtend = () => {
    if (state.chat.extensionCount < 3) {
      onExtend()
      actions.extendTime()
      setShowWarning(false)
      setIsPulsing(false)
      haptic.success()
    }
  }

  const getTimerColor = () => {
    if (state.chat.timeRemaining <= 30) return 'text-red-600'
    if (state.chat.timeRemaining <= 60) return 'text-orange-600'
    if (state.chat.timeRemaining <= 180) return 'text-yellow-600'
    return 'text-gray-600'
  }

  const getProgressColor = () => {
    if (state.chat.timeRemaining <= 30) return 'from-red-500 to-red-600'
    if (state.chat.timeRemaining <= 60) return 'from-orange-500 to-orange-600'
    if (state.chat.timeRemaining <= 180) return 'from-yellow-500 to-yellow-600'
    return 'from-purple-500 to-pink-500'
  }

  return (
    <>
      {/* ë©”ì¸ íƒ€ì´ë¨¸ */}
      <motion.div
        className={`
          flex items-center gap-2 px-3 py-2 rounded-full
          bg-white/90 backdrop-blur-sm shadow-lg
          ${isPulsing ? 'animate-pulse' : ''}
        `}
        initial={{ opacity: 0, scale: 0.9 }}
        animate={{ opacity: 1, scale: 1 }}
        transition={{ duration: 0.3 }}
      >
        <Clock className={`w-4 h-4 ${getTimerColor()}`} />
        <span className={`font-mono font-medium ${getTimerColor()}`}>
          {minutes.toString().padStart(2, '0')}:{seconds.toString().padStart(2, '0')}
        </span>
        
        {/* ì—°ì¥ ë²„íŠ¼ */}
        {state.chat.extensionCount < 3 && (
          <motion.button
            className="ml-2 p-1.5 bg-purple-100 text-purple-600 rounded-full hover:bg-purple-200 transition-colors"
            onClick={handleExtend}
            whileHover={{ scale: 1.1 }}
            whileTap={{ scale: 0.9 }}
            title={`ì‹œê°„ ì—°ì¥ (${3 - state.chat.extensionCount}íšŒ ë‚¨ìŒ)`}
          >
            <Plus className="w-3 h-3" />
          </motion.button>
        )}

--- src/components/features/ChatBubble.tsx ---
'use client'

import React, { useEffect, useRef } from 'react'
import { motion } from 'framer-motion'
import { User, Film } from 'lucide-react'
import { Message } from '@/types'
import { TypingAnimation } from '@/components/ui'

interface ChatBubbleProps {
  message: Message
  directorName?: string
  directorAvatar?: string
  isTyping?: boolean
  onAnimationComplete?: () => void
}

export const ChatBubble: React.FC<ChatBubbleProps> = ({
  message,
  directorName,
  directorAvatar,
  isTyping = false,
  onAnimationComplete
}) => {
  const bubbleRef = useRef<HTMLDivElement>(null)
  const isUser = message.role === 'user'

  // ìë™ ìŠ¤í¬ë¡¤
  useEffect(() => {
    if (bubbleRef.current) {
      bubbleRef.current.scrollIntoView({ behavior: 'smooth', block: 'end' })
    }
  }, [])

  // íƒ€ì´í•‘ íš¨ê³¼ë¥¼ ìœ„í•œ í…ìŠ¤íŠ¸ ë¶„í• 
  const words = message.content.split(' ')
  
  return (
    <motion.div
      ref={bubbleRef}
      className={`flex gap-3 mb-6 ${isUser ? 'justify-end' : 'justify-start'}`}
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3, ease: 'easeOut' }}
    >
      {/* ì•„ë°”íƒ€ */}
      {!isUser && (
        <motion.div
          className="flex-shrink-0"
          initial={{ scale: 0 }}
          animate={{ scale: 1 }}
          transition={{ delay: 0.1, type: 'spring' }}
        >
          <div className="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center overflow-hidden">
            {directorAvatar ? (
              <img
                src={directorAvatar}
                alt={directorName}
                className="w-full h-full object-cover"
              />
            ) : (
              <Film className="w-5 h-5 text-purple-600" />
            )}
          </div>
        </motion.div>
      )}

      <div className={`flex flex-col ${isUser ? 'items-end' : 'items-start'} max-w-[70%]`}>
        {/* ì´ë¦„ í‘œì‹œ */}
        {!isUser && directorName && (
          <motion.span
            className="text-xs text-gray-500 mb-1 ml-3"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.2 }}
          >
            {directorName}
          </motion.span>
        )}

        {/* ë©”ì‹œì§€ ë²„ë¸” */}
        <motion.div
          className={`
            relative px-4 py-3 rounded-2xl
            ${isUser 
              ? 'bg-purple-600 text-white' 
              : 'bg-gray-100 text-gray-900'
            }
            ${isUser ? 'rounded-br-md' : 'rounded-bl-md'}
          `}
          initial={{ scale: 0.8 }}
          animate={{ scale: 1 }}
          transition={{ delay: 0.1, type: 'spring' }}
        >
          {isTyping ? (
            <TypingAnimation />
          ) : (
            <div className="whitespace-pre-wrap break-words">
              {/* íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */}
              {!isUser ? (
                <motion.span>
                  {words.map((word, index) => (
                    <motion.span
                      key={index}
                      initial={{ opacity: 0 }}
                      animate={{ opacity: 1 }}
                      transition={{
                        delay: index * 0.03,
                        duration: 0.1
                      }}
                      onAnimationComplete={
                        index === words.length - 1 ? onAnimationComplete : undefined
                      }
                    >
                      {word}{' '}
                    </motion.span>
                  ))}
                </motion.span>
              ) : (
                <span>{message.content}</span>
              )}
            </div>
          )}

          {/* ë©”ì‹œì§€ ê¼¬ë¦¬ */}
          <div
            className={`
              absolute w-0 h-0 
              ${isUser 
                ? 'right-0 bottom-0 border-l-[8px] border-l-purple-600 border-t-[8px] border-t-transparent' 
                : 'left-0 bottom-0 border-r-[8px] border-r-gray-100 border-t-[8px] border-t-transparent'
              }
            `}
          />
        </motion.div>

        {/* íƒ€ì„ìŠ¤íƒ¬í”„ */}
        <motion.span
          className="text-xs text-gray-400 mt-1 px-3"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.4 }}
        >
          {new Date(message.timestamp).toLocaleTimeString('ko-KR', {
            hour: '2-digit',
            minute: '2-digit'
          })}
        </motion.span>
      </div>

      {/* ì‚¬ìš©ì ì•„ë°”íƒ€ */}
      {isUser && (
        <motion.div
          className="flex-shrink-0"
          initial={{ scale: 0 }}
          animate={{ scale: 1 }}
          transition={{ delay: 0.1, type: 'spring' }}
        >
          <div className="w-10 h-10 rounded-full bg-purple-600 flex items-center justify-center">
            <User className="w-5 h-5 text-white" />
          </div>
        </motion.div>
      )}
    </motion.div>
  )
}

// ì„ íƒì§€ ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸
interface ChoiceButtonsProps {
  choices: Array<{ id: string; text: string; icon: string }>
  onSelect: (choice: { id: string; text: string }) => void
  disabled?: boolean
}

export const ChoiceButtons: React.FC<ChoiceButtonsProps> = ({
  choices,
  onSelect,
  disabled = false
}) => {
  return (
    <motion.div
      className="flex flex-wrap gap-2 mb-6 px-4"
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3, delay: 0.2 }}
    >
      {choices.map((choice, index) => (
        <motion.button
          key={choice.id}
          className={`
            flex items-center gap-2 px-4 py-2.5 rounded-xl
            bg-white border-2 border-gray-200
            hover:border-purple-400 hover:bg-purple-50
            active:scale-95 transition-all
            ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}
          `}
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ delay: 0.1 * index, type: 'spring' }}
          onClick={() => !disabled && onSelect(choice)}
          disabled={disabled}
          whileHover={!disabled ? { scale: 1.05 } : {}}
          whileTap={!disabled ? { scale: 0.95 } : {}}
        >
          <span className="text-lg">{choice.icon}</span>
          <span className="text-sm font-medium text-gray-700">{choice.text}</span>
        </motion.button>
      ))}
    </motion.div>
  )
}

// ì‹œìŠ¤í…œ ë©”ì‹œì§€ ì»´í¬ë„ŒíŠ¸
interface SystemMessageProps {
  message: string
  type?: 'info' | 'warning' | 'success'
}

export const SystemMessage: React.FC<SystemMessageProps> = ({
  message,
  type = 'info'
}) => {
  const colors = {
    info: 'bg-blue-50 text-blue-700 border-blue-200',
    warning: 'bg-yellow-50 text-yellow-700 border-yellow-200',
    success: 'bg-green-50 text-green-700 border-green-200'
  }

  return (
    <motion.div
      className={`mx-4 mb-4 px-4 py-3 rounded-lg border ${colors[type]} text-sm text-center`}
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      transition={{ duration: 0.3 }}
    >
      {message}
    </motion.div>
  )
}

--- src/components/features/SessionExpiryModal.tsx ---
'use client'

import React, { useState, useEffect } from 'react'
import { motion } from 'framer-motion'
import { Clock, AlertCircle } from 'lucide-react'
import { Modal } from '@/components/ui'
import { useApp } from '@/contexts/AppContext'
import { haptic } from '@/lib/haptic'

export const SessionExpiryModal: React.FC = () => {
  const { state, actions } = useApp()
  const [isOpen, setIsOpen] = useState(false)
  const [timeLeft, setTimeLeft] = useState(60) // 60ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´

  useEffect(() => {
    let warningTimer: NodeJS.Timeout
    let countdownInterval: NodeJS.Timeout

    const checkSessionExpiry = () => {
      const lastActivity = new Date(state.session.lastActivity).getTime()
      const now = Date.now()
      const nineMinutes = 9 * 60 * 1000
      const tenMinutes = 10 * 60 * 1000
      
      // 9ë¶„ ê²½ê³¼ ì‹œ ê²½ê³  í‘œì‹œ
      if (now - lastActivity > nineMinutes && now - lastActivity < tenMinutes) {
        setIsOpen(true)
        haptic.warning()
        
        // ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
        countdownInterval = setInterval(() => {
          setTimeLeft(prev => {
            if (prev <= 1) {
              handleExpiry()
              return 0
            }
            return prev - 1
          })
        }, 1000)
      }
    }

    // 10ì´ˆë§ˆë‹¤ ì²´í¬
    warningTimer = setInterval(checkSessionExpiry, 10000)
    
    return () => {
      clearInterval(warningTimer)
      clearInterval(countdownInterval)
    }
  }, [state.session.lastActivity])

  const handleContinue = () => {
    haptic.success()
    actions.updateActivity()
    setIsOpen(false)
    setTimeLeft(60)
  }

  const handleExpiry = () => {
    haptic.error()
    setIsOpen(false)
    actions.resetAll()
  }

  return (
    <Modal
      isOpen={isOpen}
      onClose={() => {}} // ë‹«ê¸° ë²„íŠ¼ ë¹„í™œì„±í™”
      closeOnOverlayClick={false}
      size="sm"
    >
      <div className="text-center py-4">
        <motion.div
          className="w-16 h-16 bg-warning/20 rounded-full flex items-center justify-center mx-auto mb-4"
          animate={{ scale: [1, 1.1, 1] }}
          transition={{ duration: 2, repeat: Infinity }}
        >
          <Clock className="w-8 h-8 text-warning" />
        </motion.div>

        <h3 className="text-xl font-semibold text-gray-900 mb-2">
          ì„¸ì…˜ì´ ê³§ ë§Œë£Œë©ë‹ˆë‹¤
        </h3>
        
        <p className="text-gray-600 mb-6">
          ê³„ì†í•˜ì‹œë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
        </p>

        <div className="mb-6">
          <div className="text-3xl font-bold text-primary mb-2">
            {Math.floor(timeLeft / 60)}:{(timeLeft % 60).toString().padStart(2, '0')}
          </div>
          <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
            <motion.div
              className="h-full bg-gradient-to-r from-warning to-error"
              animate={{ width: `${(timeLeft / 60) * 100}%` }}
              transition={{ duration: 1 }}
            />
          </div>
        </div>

        <div className="flex gap-3">
          <button
            onClick={handleExpiry}
            className="flex-1 py-3 px-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
          >
            ì¢…ë£Œí•˜ê¸°
          </button>
          <button
            onClick={handleContinue}
            className="flex-1 py-3 px-4 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-all"
          >
            ê³„ì†í•˜ê¸°
          </button>
        </div>
      </div>
    </Modal>
  )
}

// ì¢…ë£Œ í™•ì¸ ëª¨ë‹¬
interface EndSessionModalProps {
  isOpen: boolean
  onClose: () => void
  onConfirm: () => void
  type: 'chat' | 'all'
}

export const EndSessionModal: React.FC<EndSessionModalProps> = ({
  isOpen,
  onClose,
  onConfirm,
  type
}) => {
  const title = type === 'chat' ? 'ëŒ€í™”ë¥¼ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'ì „ì²´ ì„¸ì…˜ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?'
  const message = type === 'chat' 
    ? 'í˜„ì¬ ê°ë…ê³¼ì˜ ëŒ€í™”ë§Œ ì¢…ë£Œë©ë‹ˆë‹¤. ë‹¤ë¥¸ ê°ë…ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
    : 'ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ë©° ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ê²Œ ë©ë‹ˆë‹¤.'

  return (
    <Modal
      isOpen={isOpen}
      onClose={onClose}
      title={title}
      size="sm"
    >
      <div className="py-4">
        <div className="flex items-start gap-3 mb-6">
          <AlertCircle className="w-5 h-5 text-warning flex-shrink-0 mt-0.5" />
          <p className="text-gray-600">{message}</p>
        </div>

        <div className="flex gap-3">
          <button
            onClick={onClose}
            className="flex-1 py-3 px-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
          >
            ì·¨ì†Œ
          </button>
          <button
            onClick={() => {
              onConfirm()
              onClose()
            }}
            className={`
              flex-1 py-3 px-4 rounded-lg text-white transition-all
              ${type === 'all' ? 'bg-error hover:bg-opacity-90' : 'bg-warning hover:bg-opacity-90'}
            `}
          >
            {type === 'chat' ? 'ëŒ€í™” ì¢…ë£Œ' : 'ì „ì²´ ì¢…ë£Œ'}
          </button>
        </div>
      </div>
    </Modal>
  )
}
--- src/hooks/useLocalStorage.ts ---
'use client'

import { useState, useEffect, useCallback } from 'react'
import { storage } from '@/utils/storage'

export function useLocalStorage<T>(
  key: Parameters<typeof storage.get>[0],
  initialValue: T
): [T, (value: T | ((prev: T) => T)) => void, () => void] {
  // State to store our value
  const [storedValue, setStoredValue] = useState<T>(() => {
    try {
      const item = storage.get<T>(key)
      return item ?? initialValue
    } catch (error) {
      console.error(`Error loading ${key} from localStorage:`, error)
      return initialValue
    }
  })

  // Return a wrapped version of useState's setter function that persists the new value to localStorage
  const setValue = useCallback((value: T | ((prev: T) => T)) => {
    try {
      // Allow value to be a function so we have same API as useState
      const valueToStore = value instanceof Function ? value(storedValue) : value
      
      // Save state
      setStoredValue(valueToStore)
      
      // Save to local storage
      storage.set(key, valueToStore)
    } catch (error) {
      console.error(`Error saving ${key} to localStorage:`, error)
    }
  }, [key, storedValue])

  // Remove value from storage
  const removeValue = useCallback(() => {
    try {
      storage.remove(key)
      setStoredValue(initialValue)
    } catch (error) {
      console.error(`Error removing ${key} from localStorage:`, error)
    }
  }, [key, initialValue])

  // Listen for storage changes in other tabs/windows
  useEffect(() => {
    const handleStorageChange = (e: StorageEvent) => {
      if (e.key === key && e.newValue) {
        try {
          setStoredValue(JSON.parse(e.newValue))
        } catch (error) {
          console.error('Error parsing storage event:', error)
        }
      }
    }

    window.addEventListener('storage', handleStorageChange)
    return () => window.removeEventListener('storage', handleStorageChange)
  }, [key])

  return [storedValue, setValue, removeValue]
}

--- src/hooks/index.ts ---
// Export all custom hooks from a single entry point
export { useLocalStorage } from './useLocalStorage'

--- src/hooks/useNavigation.ts ---
'use client'

import { useRouter } from 'next/navigation'
import { useCallback, useEffect } from 'react'
import { useApp } from '@/contexts/AppContext'
import { AppState } from '@/types'
import { haptic } from '@/lib/haptic'

interface NavigationOptions {
  showConfirm?: boolean
  confirmMessage?: string
  onConfirm?: () => void
  onCancel?: () => void
}

export function useNavigation() {
  const router = useRouter()
  const { state, actions } = useApp()

  // í˜„ì¬ ë‹¨ê³„ì— ë§ëŠ” ê²½ë¡œ í™•ì¸
  const getCurrentPath = useCallback(() => {
    switch (state.session.currentStep) {
      case 'start':
        return '/'
      case 'director':
        return '/director'
      case 'scenario':
        return '/scenario'
      case 'chat':
        return '/chat'
      default:
        return '/'
    }
  }, [state.session.currentStep])

  // ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™
  const navigateNext = useCallback((options?: NavigationOptions) => {
    haptic.light()
    
    switch (state.session.currentStep) {
      case 'start':
        if (state.session.id) {
          actions.setStep('director')
          router.push('/director')
        }
        break
        
      case 'director':
        if (state.director.selected) {
          actions.setStep('scenario')
          router.push('/scenario')
        }
        break
        
      case 'scenario':
        if (state.scenario.completed) {
          actions.setStep('chat')
          router.push('/chat')
        }
        break
        
      default:
        break
    }
  }, [state, actions, router])

  // ì´ì „ ë‹¨ê³„ë¡œ ì´ë™
  const navigateBack = useCallback((options?: NavigationOptions) => {
    haptic.light()
    
    if (options?.showConfirm) {
      // í™•ì¸ ëª¨ë‹¬ í‘œì‹œ ë¡œì§
      const confirmed = window.confirm(options.confirmMessage || 'ì´ì „ ë‹¨ê³„ë¡œ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?')
      if (!confirmed) {
        options.onCancel?.()
        return
      }
    }
    
    switch (state.session.currentStep) {
      case 'director':
        actions.setStep('start')
        router.push('/')
        break
        
      case 'scenario':
        actions.setStep('director')
        router.push('/director')
        break
        
      case 'chat':
        actions.setStep('scenario')
        router.push('/scenario')
        break
        
      default:
        router.push('/')
        break
    }
    
    options?.onConfirm?.()
  }, [state.session.currentStep, actions, router])

  // íŠ¹ì • ë‹¨ê³„ë¡œ ì§ì ‘ ì´ë™
  const navigateTo = useCallback((step: AppState['session']['currentStep']) => {
    haptic.light()
    
    // ìœ íš¨ì„± ê²€ì‚¬
    if (step === 'scenario' && !state.director.selected) {
      console.warn('Cannot navigate to scenario without selecting director')
      return
    }
    
    if (step === 'chat' && (!state.director.selected || !state.scenario.completed)) {
      console.warn('Cannot navigate to chat without completing previous steps')
      return
    }
    
    actions.setStep(step)
    
    switch (step) {
      case 'start':
        router.push('/')
        break
      case 'director':
        router.push('/director')
        break
      case 'scenario':
        router.push('/scenario')
        break
      case 'chat':
        router.push('/chat')
        break
    }
  }, [state, actions, router])

  // ì„¸ì…˜ ì´ˆê¸°í™” ë° ì²˜ìŒìœ¼ë¡œ
  const resetAndGoHome = useCallback(() => {
    haptic.heavy()
    actions.resetAll()
    router.push('/')
  }, [actions, router])

  // ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ì²˜ë¦¬
  useEffect(() => {
    const handlePopState = (e: PopStateEvent) => {
      e.preventDefault()
      
      // í˜„ì¬ ê²½ë¡œì™€ ìƒíƒœê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
      const currentPath = window.location.pathname
      const expectedPath = getCurrentPath()
      
      if (currentPath !== expectedPath) {
        // ìƒíƒœì™€ ê²½ë¡œ ë™ê¸°í™”
        router.push(expectedPath)
      }
    }
    
    window.addEventListener('popstate', handlePopState)
    
    return () => {
      window.removeEventListener('popstate', handlePopState)
    }
  }, [getCurrentPath, router])

  // í˜ì´ì§€ ì´íƒˆ ë°©ì§€
  useEffect(() => {
    const handleBeforeUnload = (e: BeforeUnloadEvent) => {
      if (state.session.currentStep !== 'start' && state.session.id) {
        e.preventDefault()
        e.returnValue = 'ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤. ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?'
      }
    }
    
    window.addEventListener('beforeunload', handleBeforeUnload)
    
    return () => {
      window.removeEventListener('beforeunload', handleBeforeUnload)
    }
  }, [state.session])

  // í˜„ì¬ ë‹¨ê³„ ì§„í–‰ë¥  ê³„ì‚°
  const getProgress = useCallback(() => {
    const steps = ['start', 'director', 'scenario', 'chat']
    const currentIndex = steps.indexOf(state.session.currentStep)
    return {
      current: currentIndex + 1,
      total: steps.length,
      percentage: ((currentIndex + 1) / steps.length) * 100
    }
  }, [state.session.currentStep])

  // ë‹¨ê³„ë³„ ì™„ë£Œ ìƒíƒœ í™•ì¸
  const isStepCompleted = useCallback((step: AppState['session']['currentStep']) => {
    switch (step) {
      case 'start':
        return !!state.session.id
      case 'director':
        return !!state.director.selected
      case 'scenario':
        return state.scenario.completed
      case 'chat':
        return state.chat.messages.length > 0
      default:
        return false
    }
  }, [state])

  // ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ ê°€ëŠ¥í•œì§€ í™•ì¸
  const canProceed = useCallback(() => {
    switch (state.session.currentStep) {
      case 'start':
        return !!state.session.id
      case 'director':
        return !!state.director.selected
      case 'scenario':
        return state.scenario.completed
      case 'chat':
        return false // ì±„íŒ…ì€ ë§ˆì§€ë§‰ ë‹¨ê³„
      default:
        return false
    }
  }, [state])

  return {
    navigateNext,
    navigateBack,
    navigateTo,
    resetAndGoHome,
    getCurrentPath,
    getProgress,
    isStepCompleted,
    canProceed,
    currentStep: state.session.currentStep
  }
}
--- src/lib/storage.ts ---
// Local storage utilities with type safety

const STORAGE_KEYS = {
  SESSION: 'ai-director-session',
  DIRECTOR: 'ai-director-selected',
  SCENARIO: 'ai-director-scenario',
  CHAT: 'ai-director-chat',
  PREFERENCES: 'ai-director-preferences'
} as const

export const storage = {
  // Generic get method with type safety
  get<T>(key: keyof typeof STORAGE_KEYS): T | null {
    if (typeof window === 'undefined') return null
    
    try {
      const item = localStorage.getItem(STORAGE_KEYS[key])
      return item ? JSON.parse(item) : null
    } catch (error) {
      console.error(`Error reading from localStorage:`, error)
      return null
    }
  },

  // Generic set method
  set<T>(key: keyof typeof STORAGE_KEYS, value: T): void {
    if (typeof window === 'undefined') return
    
    try {
      localStorage.setItem(STORAGE_KEYS[key], JSON.stringify(value))
    } catch (error) {
      console.error(`Error writing to localStorage:`, error)
    }
  },

  // Remove specific item
  remove(key: keyof typeof STORAGE_KEYS): void {
    if (typeof window === 'undefined') return
    
    try {
      localStorage.removeItem(STORAGE_KEYS[key])
    } catch (error) {
      console.error(`Error removing from localStorage:`, error)
    }
  },

  // Clear all app data
  clearAll(): void {
    if (typeof window === 'undefined') return
    
    try {
      Object.values(STORAGE_KEYS).forEach(key => {
        localStorage.removeItem(key)
      })
    } catch (error) {
      console.error(`Error clearing localStorage:`, error)
    }
  },

  // Check if session is expired (10 minutes of inactivity)
  isSessionExpired(lastActivity: Date | string): boolean {
    const lastActivityTime = new Date(lastActivity).getTime()
    const now = Date.now()
    const tenMinutes = 10 * 60 * 1000
    
    return now - lastActivityTime > tenMinutes
  }
}

export type StorageKeys = keyof typeof STORAGE_KEYS
--- src/lib/haptic.ts ---
// Haptic feedback utilities for mobile devices

export const haptic = {
  // Light impact for button taps
  light: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate(10)
    }
  },

  // Medium impact for selections
  medium: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate(20)
    }
  },

  // Heavy impact for important actions
  heavy: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate(30)
    }
  },

  // Success pattern
  success: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate([10, 10, 20])
    }
  },

  // Warning pattern
  warning: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate([20, 10, 20])
    }
  },

  // Error pattern
  error: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate([30, 10, 30, 10, 30])
    }
  },

  // Selection change
  selection: () => {
    if ('vibrate' in navigator) {
      navigator.vibrate(5)
    }
  }
}

// Check if haptic feedback is supported
export const isHapticSupported = () => 'vibrate' in navigator

--- src/lib/gemini.ts ---
import { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from '@google/generative-ai'
import { DirectorType } from '@/types'
import { directorPrompts } from '@/constants/directors'

// API í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜¤ê¸°
const API_KEY = process.env.NEXT_PUBLIC_GEMINI_API_KEY || ''

// Gemini ëª¨ë¸ ì´ˆê¸°í™”
const genAI = new GoogleGenerativeAI(API_KEY)

// ì•ˆì „ ì„¤ì •
const safetySettings = [
  {
    category: HarmCategory.HARM_CATEGORY_HARASSMENT,
    threshold: HarmBlockThreshold.BLOCK_NONE,
  },
  {
    category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,
    threshold: HarmBlockThreshold.BLOCK_NONE,
  },
  {
    category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,
    threshold: HarmBlockThreshold.BLOCK_NONE,
  },
  {
    category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,
    threshold: HarmBlockThreshold.BLOCK_NONE,
  },
]

// ëª¨ë¸ ì„¤ì •
const generationConfig = {
  temperature: 0.9,
  topK: 40,
  topP: 0.95,
  maxOutputTokens: 1024,
}

// ê°ë…ë³„ ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤ ìºì‹±
const modelCache: Map<DirectorType, any> = new Map()

// ëª¨ë¸ ê°€ì ¸ì˜¤ê¸°
function getModel(director: DirectorType) {
  if (!modelCache.has(director)) {
    const model = genAI.getGenerativeModel({
      model: 'gemini-pro',
      safetySettings,
      generationConfig,
    })
    modelCache.set(director, model)
  }
  return modelCache.get(director)!
}

// ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±
export function buildContext(
  director: DirectorType,
  scenario: [string, string, string, string],
  previousMessages: Array<{ role: string; content: string }>
): string {
  const systemPrompt = directorPrompts[director]
  
  // ì‹œë‚˜ë¦¬ì˜¤ í¬ë§·íŒ…
  const scenarioText = scenario
    .map((cut, index) => `[ì¥ë©´ ${index + 1}] ${cut}`)
    .join('\n\n')
  
  // ì´ì „ ëŒ€í™” í¬ë§·íŒ…
  const conversationHistory = previousMessages
    .map(msg => `${msg.role === 'user' ? 'ì°¸ì—¬ì' : 'ê°ë…'}: ${msg.content}`)
    .join('\n')
  
  return `${systemPrompt}

ì°¸ì—¬ìê°€ ì‘ì„±í•œ ì¸ìƒ ë„¤ ì»· ì‹œë‚˜ë¦¬ì˜¤:
${scenarioText}

${conversationHistory ? `ì´ì „ ëŒ€í™” ë‚´ìš©:\n${conversationHistory}\n` : ''}

ë‹¤ìŒ ì§€ì¹¨ì„ ë”°ë¼ì£¼ì„¸ìš”:
1. ì°¸ì—¬ìì˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê¹Šì´ ìˆê²Œ ë¶„ì„í•˜ê³ , ê°ë…ì˜ ê´€ì ì—ì„œ ì—°ì¶œ ì œì•ˆì„ í•´ì£¼ì„¸ìš”.
2. êµ¬ì²´ì ì¸ ì‹œê°ì  í‘œí˜„, ì¹´ë©”ë¼ ì•µê¸€, ì¡°ëª…, ìŒì•… ë“±ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.
3. ê°ë…ì˜ ëŒ€í‘œì‘ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” íŠ¹ì§•ì ì¸ ì—°ì¶œ ê¸°ë²•ì„ í™œìš©í•´ì£¼ì„¸ìš”.
4. ì°¸ì—¬ìê°€ ì„ íƒí•  ìˆ˜ ìˆëŠ” 3ê°€ì§€ ì„ íƒì§€ë¥¼ ì œê³µí•´ì£¼ì„¸ìš”.
5. ëŒ€í™”ëŠ” ì¹œê·¼í•˜ê³  ë”°ëœ»í•˜ê²Œ, í•˜ì§€ë§Œ ì „ë¬¸ì ì¸ í†¤ì„ ìœ ì§€í•´ì£¼ì„¸ìš”.
6. ì´ëª¨ì§€ë¥¼ ì ì ˆíˆ ì‚¬ìš©í•˜ì—¬ ê°ì •ì„ í‘œí˜„í•´ì£¼ì„¸ìš”.

ì‘ë‹µ í˜•ì‹:
{
  "message": "ê°ë…ì˜ ë¶„ì„ê³¼ ì œì•ˆ ë‚´ìš©",
  "choices": [
    { "id": "1", "text": "ì²« ë²ˆì§¸ ì„ íƒì§€", "icon": "ğŸ¬" },
    { "id": "2", "text": "ë‘ ë²ˆì§¸ ì„ íƒì§€", "icon": "ğŸ­" },
    { "id": "3", "text": "ì„¸ ë²ˆì§¸ ì„ íƒì§€", "icon": "âœ¨" }
  ]
}`
}

// API í˜¸ì¶œ í•¨ìˆ˜
export async function generateDirectorResponse(
  director: DirectorType,
  scenario: [string, string, string, string],
  userMessage: string,
  previousMessages: Array<{ role: string; content: string }>
): Promise<{
  message: string
  choices?: Array<{ id: string; text: string; icon: string }>
  error?: string
}> {
  try {
    const model = getModel(director)
    const context = buildContext(director, scenario, previousMessages)
    
    // í”„ë¡¬í”„íŠ¸ êµ¬ì„±
    const prompt = `${context}\n\nì°¸ì—¬ì: ${userMessage}\nê°ë…:`
    
    // API í˜¸ì¶œ (ì¬ì‹œë„ ë¡œì§ í¬í•¨)
    let attempt = 0
    const maxAttempts = 3
    
    while (attempt < maxAttempts) {
      try {
        const result = await model.generateContent(prompt)
        const response = await result.response
        const text = response.text()
        
        // JSON íŒŒì‹± ì‹œë„
        try {
          // JSON ë¸”ë¡ ì¶”ì¶œ (```json ... ``` í˜•ì‹ ì²˜ë¦¬)
          const jsonMatch = text.match(/```json\s*([\s\S]*?)\s*```/) || 
                           text.match(/\{[\s\S]*\}/
          
          if (jsonMatch) {
            const jsonStr = jsonMatch[1] || jsonMatch[0]
            const parsed = JSON.parse(jsonStr)
            
            return {
              message: parsed.message || text,
              choices: parsed.choices || generateDefaultChoices(director)
            }
          }
        } catch (parseError) {
          // JSON íŒŒì‹± ì‹¤íŒ¨ ì‹œ í…ìŠ¤íŠ¸ë¡œ ë°˜í™˜
          console.warn('JSON parsing failed, returning as text:', parseError)
        }
        
        // JSON íŒŒì‹± ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ì‘ë‹µ
        return {
          message: text,
          choices: generateDefaultChoices(director)
        }
        
      } catch (error) {
        attempt++
        if (attempt >= maxAttempts) {
          throw error
        }
        // ì¬ì‹œë„ ì „ ëŒ€ê¸°
        await new Promise(resolve => setTimeout(resolve, 1000 * attempt))
      }
    }
    
  } catch (error) {
    console.error('Gemini API error:', error)
    
    // ì˜¤í”„ë¼ì¸ ë˜ëŠ” API ì˜¤ë¥˜ ì‹œ í´ë°± ì‘ë‹µ
    return {
      message: getOfflineResponse(director, userMessage),
      choices: generateDefaultChoices(director),
      error: error instanceof Error ? error.message : 'API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'
    }
  }
  
  // ê¸°ë³¸ ì‘ë‹µ (ë„ë‹¬í•˜ì§€ ì•Šì•„ì•¼ í•¨)
  return {
    message: 'ì£„ì†¡í•©ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
    choices: generateDefaultChoices(director),
    error: 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'
  }
}

// ê°ë…ë³„ ê¸°ë³¸ ì„ íƒì§€ ìƒì„±
function generateDefaultChoices(director: DirectorType): Array<{ id: string; text: string; icon: string }> {
  const choices = {
    bong: [
      { id: '1', text: 'ê³„ê¸‰ê³¼ ê²©ì°¨ì— ëŒ€í•´ ë” ì–˜ê¸°í•˜ê¸°', icon: 'ğŸšï¸' },
      { id: '2', text: 'ì‹œê°ì  ì€ìœ ì— ëŒ€í•´ ì§ˆë¬¸í•˜ê¸°', icon: 'ğŸ­' },
      { id: '3', text: 'ë‹¤ë¥¸ ì¥ë©´ ë¶„ì„ ìš”ì²­í•˜ê¸°', icon: 'ğŸ¬' }
    ],
    nolan: [
      { id: '1', text: 'ì‹œê°„ì˜ ì¸µìœ„ì— ëŒ€í•´ íƒêµ¬í•˜ê¸°', icon: 'â³' },
      { id: '2', text: 'ì„œì‚¬ êµ¬ì¡°ì— ëŒ€í•´ ë…¼ì˜í•˜ê¸°', icon: 'ğŸŒ€' },
      { id: '3', text: 'ë‹¤ë¥¸ ê´€ì ì—ì„œ ì ‘ê·¼í•˜ê¸°', icon: 'ğŸ”' }
    ],
    miyazaki: [
      { id: '1', text: 'ìì—°ê³¼ì˜ ê´€ê³„ íƒìƒ‰í•˜ê¸°', icon: 'ğŸŒ¿' },
      { id: '2', text: 'ì„±ì¥ì˜ ì˜ë¯¸ ë˜ì§šì–´ë³´ê¸°', icon: 'ğŸ¦‹' },
      { id: '3', text: 'íŒíƒ€ì§€ ìš”ì†Œ ì¶”ê°€í•˜ê¸°', icon: 'âœ¨' }
    ],
    curtis: [
      { id: '1', text: 'ì‚¬ë‘ì˜ ìˆœê°„ë“¤ ë” ë‚˜ëˆ„ê¸°', icon: 'ğŸ’•' },
      { id: '2', text: 'ìœ ë¨¸ëŸ¬ìŠ¤í•œ ë©´ ì°¾ì•„ë³´ê¸°', icon: 'ğŸ˜Š' },
      { id: '3', text: 'ê´€ê³„ì˜ ì˜ë¯¸ íƒêµ¬í•˜ê¸°', icon: 'ğŸ¤' }
    ],
    kani: [
      { id: '1', text: 'ê°ì •ì˜ ë‰˜ì•™ìŠ¤ í‘œí˜„í•˜ê¸°', icon: 'ğŸ¨' },
      { id: '2', text: 'ì‹œê°ì  ì•„ë¦„ë‹¤ì›€ ë…¼ì˜í•˜ê¸°', icon: 'ğŸŒ…' },
      { id: '3', text: 'ìš´ëª…ì  ì—°ê²° íƒìƒ‰í•˜ê¸°', icon: 'ğŸ”—' }
    ],
    doctor: [
      { id: '1', text: 'ë‚´ë©´ì˜ ìƒì²˜ ë“¤ì—¬ë‹¤ë³´ê¸°', icon: 'ğŸ©¹' },
      { id: '2', text: 'íšŒë³µì˜ ê³¼ì • ê·¸ë ¤ë³´ê¸°', icon: 'ğŸŒ±' },
      { id: '3', text: 'ìƒˆë¡œìš´ ì‹œì‘ ìƒìƒí•˜ê¸°', icon: 'ğŸŒŸ' }
    ]
  }
  
  return choices[director] || choices.bong
}

// ì˜¤í”„ë¼ì¸ ì‘ë‹µ ìƒì„±
function getOfflineResponse(director: DirectorType, userMessage: string): string {
  const responses = {
    bong: 'í¥ë¯¸ë¡œìš´ ì´ì•¼ê¸°ë„¤ìš”. ê³„ê¸‰ê³¼ ê²½ê³„, ê·¸ë¦¬ê³  ê·¸ ì‚¬ì´ì—ì„œ ë²Œì–´ì§€ëŠ” ì¸ê°„ì˜ ìš•ë§... ì´ëŸ° ìš”ì†Œë“¤ì´ ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ë„ ìˆ¨ì–´ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ğŸ­',
    nolan: 'ì‹œê°„ì´ë€ ì°¸ ì‹ ë¹„ë¡œìš´ ê²ƒì´ì£ . ë‹¹ì‹ ì˜ ë„¤ ì»·ì€ ë§ˆì¹˜ ì„œë¡œ ë‹¤ë¥¸ ì‹œê°„ëŒ€ê°€ êµì°¨í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤. ì–´ëŠ ìˆœê°„ì´ ê°€ì¥ í˜„ì‹¤ì ì´ë¼ê³  ëŠê»´ì§€ì‹œë‚˜ìš”? â³',
    miyazaki: 'ë‹¹ì‹ ì˜ ì´ì•¼ê¸° ì†ì—ì„œ ìì—°ìŠ¤ëŸ¬ìš´ ì„±ì¥ì˜ ì•„ë¦„ë‹¤ì›€ì´ ëŠê»´ì§‘ë‹ˆë‹¤. ë•Œë¡œëŠ” ìƒì²˜ë„ ìš°ë¦¬ë¥¼ ë” ê°•í•˜ê²Œ ë§Œë“¤ì£ . ğŸŒ¿',
    curtis: 'ì‚¬ë‘ì€ ì •ë§ ì–´ë””ì—ë‚˜ ìˆë„¤ìš”. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ì„œë„ ë”°ëœ»í•œ ê°ì •ë“¤ì´ ëŠê»´ì§‘ë‹ˆë‹¤. ê°€ì¥ í–‰ë³µí–ˆë˜ ìˆœê°„ì€ ì–¸ì œì˜€ë‚˜ìš”? ğŸ’•',
    kani: 'ê°ì •ì˜ ì„¬ì„¸í•œ ê²°ì´ ëŠê»´ì§€ëŠ” ì´ì•¼ê¸°ì…ë‹ˆë‹¤. ë¹›ê³¼ ê·¸ë¦¼ì, ê·¸ ì‚¬ì´ì—ì„œ í”ë“¤ë¦¬ëŠ” ë§ˆìŒ... ì•„ë¦„ë‹µë„¤ìš”. ğŸŒ…',
    doctor: 'ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ìœ¼ë‹ˆ ë§ì€ ê°ì •ì´ ëŠê»´ì§‘ë‹ˆë‹¤. ìƒì²˜ë„ ìˆì—ˆê² ì§€ë§Œ, ê·¸ê²ƒì„ ê·¹ë³µí•˜ë ¤ëŠ” ìš©ê¸°ë„ ë³´ì´ë„¤ìš”. ì–´ë–¤ ë¶€ë¶„ì´ ê°€ì¥ í˜ë“¤ì—ˆë‚˜ìš”? ğŸŒ±'
  }
  
  return responses[director] || 'ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ëŠ” ì •ë§ íŠ¹ë³„í•©ë‹ˆë‹¤. ë” ìì„¸íˆ ë“¤ë ¤ì£¼ì‹œê² ì–´ìš”?'
}

// ì´ˆê¸° ì¸ì‚¬ ë©”ì‹œì§€ ìƒì„±
export function getInitialGreeting(director: DirectorType, userName?: string): {
  message: string
  choices: Array<{ id: string; text: string; icon: string }>
} {
  const greetings = {
    bong: {
      message: `ì•ˆë…•í•˜ì„¸ìš”${userName ? `, ${userName}ë‹˜` : ''}! ë´‰ì¤€í˜¸ì…ë‹ˆë‹¤. ğŸ¬\n\në‹¹ì‹ ì´ ë³´ë‚´ì£¼ì‹  ì¸ìƒ ë„¤ ì»·, ì •ë§ í¥ë¯¸ë¡­ê²Œ ë´¤ìŠµë‹ˆë‹¤. ê° ì¥ë©´ë§ˆë‹¤ ìˆ¨ê²¨ì§„ ê³„ì¸µê³¼ ê²½ê³„, ê·¸ë¦¬ê³  ì¸ê°„ì˜ ë³¸ì„±ì´ ì—¿ë³´ì´ë„¤ìš”. ë§ˆì¹˜ í•˜ë‚˜ì˜ ì˜í™”ë¥¼ ë³´ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.\n\níŠ¹íˆ ì²« ë²ˆì§¸ ì¥ë©´ì—ì„œ ëŠê»´ì§€ëŠ” ê¸´ì¥ê°ì´ ì¸ìƒì ì…ë‹ˆë‹¤. ì´ ìˆœê°„ì„ ì–´ë–»ê²Œ ì´¬ì˜í•˜ë©´ ì¢‹ì„ì§€ ë²Œì¨ë¶€í„° ì•„ì´ë””ì–´ê°€ ë– ì˜¤ë¥´ë„¤ìš”. ê³„ë‹¨ì„ í™œìš©í•œ êµ¬ë„ë¼ë“ ì§€, ì¢ì€ ê³µê°„ì—ì„œì˜ ì••ë°•ê°ì´ë¼ë“ ì§€...\n\nì–´ë–¤ ë¶€ë¶„ë¶€í„° ì´ì•¼ê¸°í•´ë³¼ê¹Œìš”?`,
      choices: [
        { id: '1', text: 'ì²« ë²ˆì§¸ ì¥ë©´ë¶€í„° ìì„¸íˆ ë¶„ì„í•´ì£¼ì„¸ìš”', icon: 'ğŸï¸' },
        { id: '2', text: 'ë„¤ ì»· ì „ì²´ì˜ íë¦„ì„ ì§šì–´ì£¼ì„¸ìš”', icon: 'ğŸ“½ï¸' },
        { id: '3', text: 'ê°€ì¥ ì¸ìƒì ì¸ ì¥ë©´ì„ ê³¨ë¼ì£¼ì„¸ìš”', icon: 'ğŸŒŸ' }
      ]
    },
    nolan: {
      message: `ë°˜ê°‘ìŠµë‹ˆë‹¤${userName ? `, ${userName}ë‹˜` : ''}. í¬ë¦¬ìŠ¤í† í¼ ë†€ë€ì…ë‹ˆë‹¤. â³\n\në‹¹ì‹ ì˜ ì¸ìƒ ë„¤ ì»·ì„ ë³´ë‹ˆ, ì‹œê°„ì˜ ì¸µìœ„ê°€ ê²¹ê²¹ì´ ìŒ“ì—¬ìˆëŠ” ê²ƒì´ ëŠê»´ì§‘ë‹ˆë‹¤. ê³¼ê±°ì™€ í˜„ì¬, ê·¸ë¦¬ê³  ë¯¸ë˜ê°€ í•˜ë‚˜ì˜ í”„ë ˆì„ ì•ˆì—ì„œ êµì°¨í•˜ê³  ìˆë„¤ìš”.\n\níŠ¹íˆ ì´ ë„¤ ê°œì˜ ì¥ë©´ì´ ë‹¨ìˆœíˆ ì‹œê°„ìˆœì´ ì•„ë‹ˆë¼, ì„œë¡œ ì˜í–¥ì„ ì£¼ê³ ë°›ëŠ” ê´€ê³„ë¡œ ë³´ì…ë‹ˆë‹¤. ë§ˆì¹˜ ê¿ˆì†ì˜ ê¿ˆì²˜ëŸ¼, í•˜ë‚˜ì˜ ì¥ë©´ì´ ë‹¤ë¥¸ ì¥ë©´ì˜ ì›ì¸ì´ì ê²°ê³¼ê°€ ë˜ëŠ”...\n\nì´ ë³µì¡í•œ êµ¬ì¡°ë¥¼ ì–´ë–»ê²Œ ì‹œê°í™”í• ì§€ í•¨ê»˜ ê³ ë¯¼í•´ë³´ì‹œì£ .`,
      choices: [
        { id: '1', text: 'ì‹œê°„ì˜ íë¦„ì„ ì¬êµ¬ì„±í•´ë³´ê³  ì‹¶ì–´ìš”', icon: 'ğŸ”„' },
        { id: '2', text: 'ê° ì¥ë©´ì˜ ì—°ê²°ê³ ë¦¬ë¥¼ ì°¾ì•„ì£¼ì„¸ìš”', icon: 'ğŸ”—' },
        { id: '3', text: 'ê°€ì¥ ì¤‘ìš”í•œ ì „í™˜ì ì„ ë¶„ì„í•´ì£¼ì„¸ìš”', icon: 'ğŸ¯' }
      ]
    },
    miyazaki: {
      message: `ì–´ì„œì˜¤ì„¸ìš”${userName ? `, ${userName}ë‹˜` : ''}. ë¯¸ì•¼ìí‚¤ í•˜ì•¼ì˜¤ì…ë‹ˆë‹¤. ğŸŒ¿\n\në‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ì½ìœ¼ë©°, ë°”ëŒì´ ë‚˜ë­‡ìì„ í”ë“œëŠ” ì†Œë¦¬ê°€ ë“¤ë¦¬ëŠ” ê²ƒ ê°™ì•˜ìŠµë‹ˆë‹¤. ê° ì¥ë©´ë§ˆë‹¤ ìƒëª…ì˜ í˜ê³¼ ì„±ì¥ì˜ ì•„ë¦„ë‹¤ì›€ì´ ëŠê»´ì§€ë„¤ìš”.\n\nì¸ê°„ì€ ë•Œë¡œ ìƒì²˜ë°›ê³  ë„˜ì–´ì§€ì§€ë§Œ, ê·¸ë˜ë„ ë‹¤ì‹œ ì¼ì–´ë‚˜ëŠ” ì¡´ì¬ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë„¤ ì»·ì—ì„œë„ ê·¸ëŸ° ê°•ì¸í•œ ìƒëª…ë ¥ì´ ë³´ì…ë‹ˆë‹¤. ìì—°ê³¼ í•¨ê»˜ í˜¸í¡í•˜ë©° ì„±ì¥í•˜ëŠ”...\n\nì´ ì•„ë¦„ë‹¤ìš´ ì—¬ì •ì„ ì–´ë–»ê²Œ ê·¸ë ¤ë‚¼ì§€ ìƒìƒí•´ë³´ê² ìŠµë‹ˆë‹¤.`,
      choices: [
        { id: '1', text: 'ìì—°ê³¼ ì¡°í™”ë¥¼ ì´ë£¨ëŠ” ì¥ë©´ì„ ê·¸ë ¤ì£¼ì„¸ìš”', icon: 'ğŸƒ' },
        { id: '2', text: 'ì„±ì¥ì˜ ìˆœê°„ë“¤ì„ í¬ì°©í•´ì£¼ì„¸ìš”', icon: 'ğŸŒ±' },
        { id: '3', text: 'íŒíƒ€ì§€ì  ìš”ì†Œë¥¼ ë”í•´ì£¼ì„¸ìš”', icon: 'âœ¨' }
      ]
    },
    curtis: {
      message: `ì•ˆë…•í•˜ì„¸ìš”${userName ? `, ${userName}ë‹˜` : ''}! ë¦¬ì²˜ë“œ ì»¤í‹°ìŠ¤ì…ë‹ˆë‹¤. ğŸ’•\n\nì™€, ë‹¹ì‹ ì˜ ì¸ìƒ ë„¤ ì»·ì´ ë§ˆì¹˜ í•œ í¸ì˜ ë¡œë§¨í‹± ì½”ë¯¸ë”” ê°™ë„¤ìš”! ì›ƒìŒê³¼ ëˆˆë¬¼, ê·¸ë¦¬ê³  ì‚¬ë‘ì´ ê°€ë“í•œ... ì •ë§ ì•„ë¦„ë‹µìŠµë‹ˆë‹¤.\n\níŠ¹íˆ í‰ë²”í•œ ì¼ìƒ ì†ì—ì„œ ë°œê²¬í•œ íŠ¹ë³„í•œ ìˆœê°„ë“¤ì´ ì¸ìƒì ì´ì—ìš”. ì‚¬ë‘ì€ ê±°ì°½í•œ ê²Œ ì•„ë‹ˆë¼ ì´ëŸ° ì‘ì€ ìˆœê°„ë“¤ ì†ì— ìˆì£ . ì»¤í”¼ í•œ ì”, ë”°ëœ»í•œ í¬ì˜¹, ì§„ì‹¬ ì–´ë¦° ë¯¸ì†Œ...\n\nì´ ë”°ëœ»í•œ ì´ì•¼ê¸°ë¥¼ ì–´ë–»ê²Œ ë” ë¹›ë‚˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆì„ê¹Œìš”?`,
      choices: [
        { id: '1', text: 'ê°€ì¥ ë¡œë§¨í‹±í•œ ìˆœê°„ì„ ê°•ì¡°í•´ì£¼ì„¸ìš”', icon: 'ğŸ’' },
        { id: '2', text: 'ìœ ë¨¸ëŸ¬ìŠ¤í•œ ìš”ì†Œë¥¼ ë”í•´ì£¼ì„¸ìš”', icon: 'ğŸ˜„' },
        { id: '3', text: 'ê°ë™ì ì¸ í´ë¼ì´ë§¥ìŠ¤ë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”', icon: 'ğŸ­' }
      ]
    },
    kani: {
      message: `ë§Œë‚˜ì„œ ë°˜ê°‘ìŠµë‹ˆë‹¤${userName ? `, ${userName}ë‹˜` : ''}. ì‹ ì¹´ì´ ë§ˆì½”í† ì…ë‹ˆë‹¤. ğŸŒ…\n\në‹¹ì‹ ì˜ ë„¤ ì»·ì„ ë³´ë©°, ë¹›ê³¼ ê·¸ë¦¼ìê°€ ì¶¤ì¶”ëŠ” ê²ƒì„ ë³´ì•˜ìŠµë‹ˆë‹¤. ê° ì¥ë©´ë§ˆë‹¤ ì„¬ì„¸í•œ ê°ì •ì˜ ê²°ì´ ëŠê»´ì§€ë„¤ìš”. ë§ˆì¹˜ ìˆ˜ì±„í™”ì²˜ëŸ¼ ë²ˆì§€ëŠ” ê°ì •ë“¤...\n\níŠ¹íˆ í•˜ëŠ˜ì˜ ìƒ‰ì´ ë³€í•˜ëŠ” ê²ƒì²˜ëŸ¼, ë‹¹ì‹ ì˜ ë§ˆìŒë„ ì‹œì‹œê°ê° ë³€í™”í•˜ëŠ” ê²Œ ë³´ì…ë‹ˆë‹¤. êµ¬ë¦„ ì‚¬ì´ë¡œ ë¹„ì¹˜ëŠ” í–‡ì‚´ì²˜ëŸ¼, í¬ë§ì´ ìŠ¤ë©°ë“œëŠ” ìˆœê°„ë“¤ì´ ì•„ë¦„ë‹µë„¤ìš”.\n\nì´ ì°¬ë€í•œ ìˆœê°„ë“¤ì„ ì–´ë–»ê²Œ ì˜ì›íˆ ê°„ì§í•  ìˆ˜ ìˆì„ê¹Œìš”?`,
      choices: [
        { id: '1', text: 'ê°€ì¥ ì•„ë¦„ë‹¤ìš´ í’ê²½ì„ ê·¸ë ¤ì£¼ì„¸ìš”', icon: 'ğŸ¨' },
        { id: '2', text: 'ê°ì •ì˜ ìƒ‰ê¹”ì„ í‘œí˜„í•´ì£¼ì„¸ìš”', icon: 'ğŸŒˆ' },
        { id: '3', text: 'ìš´ëª…ì ì¸ ë§Œë‚¨ì„ ì—°ì¶œí•´ì£¼ì„¸ìš”', icon: 'âœ¨' }
      ]
    },
    doctor: {
      message: `${userName ? `${userName}ë‹˜, ` : ''}ë§Œë‚˜ëµ™ê²Œ ë˜ì–´ ê¸°ì©ë‹ˆë‹¤. ì¹´ë¼ ìœ í‚¤ì…ë‹ˆë‹¤. ğŸŒ±\n\në‹¹ì‹ ì˜ ì¸ìƒ ë„¤ ì»·ì„ ì½ìœ¼ë©° ë§ì€ ê²ƒì„ ëŠê¼ˆìŠµë‹ˆë‹¤. ê° ì¥ë©´ì—ëŠ” ìƒì²˜ì™€ íšŒë³µ, ê·¸ë¦¬ê³  ì„±ì¥ì˜ ì´ì•¼ê¸°ê°€ ë‹´ê²¨ìˆë„¤ìš”. ëˆ„êµ¬ë‚˜ ê²ªëŠ”, í•˜ì§€ë§Œ ê°ìì—ê²ŒëŠ” íŠ¹ë³„í•œ ì—¬ì •...\n\nìƒì²˜ëŠ” ìš°ë¦¬ë¥¼ ì•½í•˜ê²Œ ë§Œë“¤ê¸°ë„ í•˜ì§€ë§Œ, ë™ì‹œì— ë” ê°•í•˜ê³  ì§€í˜œë¡­ê²Œ ë§Œë“¤ì–´ì£¼ì£ . ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ì„œë„ ê·¸ëŸ° íšŒë³µíƒ„ë ¥ì„±ì´ ë³´ì…ë‹ˆë‹¤.\n\nì´ ì¹˜ìœ ì˜ ì—¬ì •ì„ ì–´ë–»ê²Œ ì‹œê°í™”í•˜ë©´ ì¢‹ì„ê¹Œìš”? í•¨ê»˜ íƒí—˜í•´ë³´ì‹œì£ .`,
      choices: [
        { id: '1', text: 'ê°€ì¥ í˜ë“¤ì—ˆë˜ ìˆœê°„ì„ ëŒì•„ë´ì£¼ì„¸ìš”', icon: 'ğŸ•¯ï¸' },
        { id: '2', text: 'íšŒë³µì˜ ê³¼ì •ì„ ê·¸ë ¤ì£¼ì„¸ìš”', icon: 'ğŸŒ¿' },
        { id: '3', text: 'ìƒˆë¡œìš´ ì‹œì‘ì„ ìƒìƒí•´ì£¼ì„¸ìš”', icon: 'ğŸŒ…' }
      ]
    }
  }
  
  return greetings[director] || greetings.bong
}

// ëŒ€í™” ì¢…ë£Œ ë©”ì‹œì§€ ìƒì„±
export function getFarewellMessage(director: DirectorType): string {
  const farewells = {
    bong: 'ì˜¤ëŠ˜ ì •ë§ ì˜ë¯¸ìˆëŠ” ëŒ€í™”ì˜€ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ëŠ” ìš°ë¦¬ ì‚¬íšŒì˜ ì¶•ì†ŒíŒì´ ë‹´ê²¨ìˆë„¤ìš”. ê³„ì†í•´ì„œ ì£¼ë³€ì„ ê´€ì°°í•˜ê³ , ê·¸ ì•ˆì˜ ì§„ì‹¤ì„ í¬ì°©í•´ë³´ì„¸ìš”. ì–¸ì  ê°€ ë©‹ì§„ ì‘í’ˆìœ¼ë¡œ ë§Œë‚  ìˆ˜ ìˆê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ğŸ¬',
    nolan: 'ì‹œê°„ì´ë€ ì°¸ ë¬˜í•œ ê²ƒì´ì£ . ì˜¤ëŠ˜ ìš°ë¦¬ì˜ ëŒ€í™”ë„ ê³¼ê±°ê°€ ë˜ê² ì§€ë§Œ, ê·¸ ì˜ë¯¸ëŠ” ë¯¸ë˜ì—ë„ ê³„ì†ë  ê²ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ê°€ ì–´ë–»ê²Œ ì „ê°œë ì§€ ê¶ê¸ˆí•˜ë„¤ìš”. ì‹œê°„ì˜ ë¯¸ë¡œ ì†ì—ì„œ ê¸¸ì„ ìƒì§€ ë§ˆì„¸ìš”. â³',
    miyazaki: 'ì˜¤ëŠ˜ í•¨ê»˜í•œ ì‹œê°„ì´ ì°¸ ì¦ê±°ì› ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì´ì•¼ê¸° ì†ì—ì„œ í¬ë§ì˜ ì”¨ì•—ì„ ë³´ì•˜ì–´ìš”. ê·¸ê²ƒì„ ì˜ ê°€ê¾¸ì–´ ì£¼ì„¸ìš”. ë°”ëŒì´ ë¶ˆì–´ë„, ë¹„ê°€ ì™€ë„, ê²°êµ­ì€ ì•„ë¦„ë‹¤ìš´ ê½ƒì„ í”¼ìš¸ ê±°ì˜ˆìš”. ğŸŒ¸',
    curtis: 'ì •ë§ ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì‚¬ë‘ì€ ì‹¤ì œë¡œ ìš°ë¦¬ ì£¼ë³€ ì–´ë””ì—ë‚˜ ìˆë‹¤ëŠ” ê±¸ ë‹¤ì‹œ í•œë²ˆ ëŠê¼ˆì–´ìš”. ë‹¹ì‹ ì˜ ì¸ìƒì´ ê³„ì†í•´ì„œ ì‚¬ë‘ê³¼ ì›ƒìŒìœ¼ë¡œ ê°€ë“í•˜ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. All you need is love! ğŸ’•',
    kani: 'ë‹¹ì‹ ê³¼ì˜ ëŒ€í™”ê°€ ë§ˆì¹˜ í•œ í¸ì˜ ì‹œ ê°™ì•˜ìŠµë‹ˆë‹¤. ê°ì •ì˜ ë¬¼ê²°ì´ ì”ì”íˆ ì¼ë ì´ëŠ”... ì´ ìˆœê°„ì„ ì˜¤ë˜ ê¸°ì–µí•˜ê³  ì‹¶ë„¤ìš”. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ê°€ ë”ìš± ì•„ë¦„ë‹µê²Œ ë¹›ë‚˜ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ğŸŒŸ',
    doctor: 'ì˜¤ëŠ˜ ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ì„ ìˆ˜ ìˆì–´ì„œ ì˜ê´‘ì´ì—ˆìŠµë‹ˆë‹¤. ìƒì²˜ë„, ì•„í””ë„ ëª¨ë‘ ë‹¹ì‹ ì„ ë” ê°•í•˜ê²Œ ë§Œë“œëŠ” ìì–‘ë¶„ì´ ë  ê±°ì˜ˆìš”. ìì‹ ì„ ë¯¿ê³ , ì‚¬ë‘í•˜ë©°, ì•ìœ¼ë¡œ ë‚˜ì•„ê°€ì„¸ìš”. ë‹¹ì‹ ì€ ì¶©ë¶„íˆ ì•„ë¦„ë‹µìŠµë‹ˆë‹¤. ğŸ¦‹'
  }
  
  return farewells[director] || 'ì˜¤ëŠ˜ ì¦ê±°ìš´ ëŒ€í™”ì˜€ìŠµë‹ˆë‹¤. ë˜ ë§Œë‚˜ìš”! ğŸ‘‹'
}
--- src/lib/offlineResponses.ts ---
import { DirectorType } from '@/types'

// ê°ë…ë³„ ì˜¤í”„ë¼ì¸ ì‘ë‹µ ì„¸íŠ¸
export const offlineResponses = {
  bong: {
    analyzing: [
      {
        message: 'í¥ë¯¸ë¡­ë„¤ìš”. ì´ ì¥ë©´ì—ì„œ ê³„ê¸‰ì˜ ê²½ê³„ê°€ ëšœë ·í•˜ê²Œ ë“œëŸ¬ë‚˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ê³„ë‹¨ì´ë‚˜ ë†’ë‚®ì´ë¥¼ í™œìš©í•´ì„œ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ì–´ë–¨ê¹Œìš”? ğŸ­',
        choices: [
          { id: '1', text: 'êµ¬ì²´ì ì¸ ì´¬ì˜ ê¸°ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”', icon: 'ğŸ“¹' },
          { id: '2', text: 'ë‹¤ë¥¸ ì¥ë©´ë„ ë¶„ì„í•´ì£¼ì„¸ìš”', icon: 'ğŸ¬' },
          { id: '3', text: 'ì¸ë¬¼ì˜ ê°ì •ì— ë” ì§‘ì¤‘í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ’­' }
        ]
      },
      {
        message: 'ì´ëŸ° ìˆœê°„ì´ì•¼ë§ë¡œ ê°€ì¥ ë³´í¸ì ì´ë©´ì„œë„ ê°€ì¥ íŠ¹ë³„í•œ ê²ƒì´ì£ . ì¼ìƒ ì†ì— ìˆ¨ê²¨ì§„ ë¶€ì¡°ë¦¬í•¨ì„ í¬ì°©í•˜ëŠ” ê²ƒ, ê·¸ê²Œ ì œê°€ ì¶”êµ¬í•˜ëŠ” ì˜í™”ì…ë‹ˆë‹¤. ğŸ¥',
        choices: [
          { id: '1', text: 'ë¶€ì¡°ë¦¬í•¨ì„ ì–´ë–»ê²Œ í‘œí˜„í• ê¹Œìš”?', icon: 'ğŸ¤”' },
          { id: '2', text: 'ë¸”ë™ ìœ ë¨¸ë¥¼ ë„£ê³  ì‹¶ì–´ìš”', icon: 'ğŸ˜' },
          { id: '3', text: 'ì‚¬íšŒì  ë©”ì‹œì§€ë¥¼ ê°•í™”í•˜ë ¤ë©´?', icon: 'ğŸ“¢' }
        ]
      }
    ],
    deepening: [
      {
        message: 'ê¸°ìƒì¶©ì—ì„œ ë°˜ì§€í•˜ ê°€ì¡±ì´ ê³„ë‹¨ì„ ì˜¤ë¥´ë‚´ë¦¬ëŠ” ê²ƒì²˜ëŸ¼, ë¬¼ë¦¬ì  ê³µê°„ì´ ê³§ ê³„ê¸‰ì„ ìƒì§•í•˜ì£ . ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ì„œë„ ê·¸ëŸ° ê³µê°„ì  ì€ìœ ë¥¼ ì°¾ì•„ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”. ğŸšï¸',
        choices: [
          { id: '1', text: 'ê³µê°„ ì„¤ì •ì— ëŒ€í•´ ë” ë“£ê³  ì‹¶ì–´ìš”', icon: 'ğŸ ' },
          { id: '2', text: 'ì¸ë¬¼ ê°„ ê´€ê³„ë¥¼ ê¹Šì´ íŒŒê³ ë“¤ì–´ì£¼ì„¸ìš”', icon: 'ğŸ‘¥' },
          { id: '3', text: 'ìƒì§•ê³¼ ì€ìœ ë¥¼ ë” í™œìš©í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ­' }
        ]
      }
    ],
    concluding: [
      {
        message: 'ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ëŠ” ìš°ë¦¬ ëª¨ë‘ì˜ ì´ì•¼ê¸°ì…ë‹ˆë‹¤. í‰ë²”í•œ ì‚¬ëŒë“¤ì˜ íŠ¹ë³„í•˜ì§€ ì•Šì€ ì¼ìƒ, í•˜ì§€ë§Œ ê·¸ ì•ˆì— ë‹´ê¸´ ì§„ì‹¤. ê·¸ê²ƒì´ ê°€ì¥ ê°•ë ¥í•œ ì˜í™”ê°€ ë©ë‹ˆë‹¤. ğŸ¬',
        choices: [
          { id: '1', text: 'ë§ˆì§€ë§‰ ì¡°ì–¸ì„ ë¶€íƒë“œë ¤ìš”', icon: 'ğŸ’¡' },
          { id: '2', text: 'ì¶”ì²œ ì‘í’ˆì´ ìˆì„ê¹Œìš”?', icon: 'ğŸ“½ï¸' },
          { id: '3', text: 'ê°ì‚¬í•©ë‹ˆë‹¤, ê°ë…ë‹˜', icon: 'ğŸ™' }
        ]
      }
    ]
  },
  
  nolan: {
    analyzing: [
      {
        message: 'ì‹œê°„ì´ë€ ì„ í˜•ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë„¤ ì»·ë„ ë§ˆì°¬ê°€ì§€ì£ . ê° ì¥ë©´ì´ ì„œë¡œ ë‹¤ë¥¸ ì‹œê°„ëŒ€ì— ì¡´ì¬í•˜ë©´ì„œë„ í•˜ë‚˜ì˜ ì´ì•¼ê¸°ë¥¼ ë§Œë“¤ì–´ë‚´ê³  ìˆì–´ìš”. â³',
        choices: [
          { id: '1', text: 'ë¹„ì„ í˜• êµ¬ì¡°ë¡œ ì¬ë°°ì—´í•´ì£¼ì„¸ìš”', icon: 'ğŸ”„' },
          { id: '2', text: 'ì‹œê°„ì˜ ì˜ë¯¸ë¥¼ ë” íƒêµ¬í•˜ê³  ì‹¶ì–´ìš”', icon: 'âŒ›' },
          { id: '3', text: 'ê° ì¥ë©´ì˜ ì—°ê²°ì ì„ ì°¾ì•„ì£¼ì„¸ìš”', icon: 'ğŸ”—' }
        ]
      },
      {
        message: 'ì¸ì…‰ì…˜ì˜ ê¿ˆì† ê¿ˆì²˜ëŸ¼, ë‹¹ì‹ ì˜ ê¸°ì–µë„ ì—¬ëŸ¬ ì¸µìœ„ë¥¼ ê°€ì§€ê³  ìˆë„¤ìš”. ì–´ëŠ ê²ƒì´ ê°€ì¥ ì§„ì‹¤ì— ê°€ê¹Œìš´ ê¸°ì–µì¼ê¹Œìš”? ì•„ë‹ˆë©´ ëª¨ë“  ê²Œ ì§„ì‹¤ì¼ê¹Œìš”? ğŸŒ€',
        choices: [
          { id: '1', text: 'ê¸°ì–µì˜ ì‹ ë¢°ì„±ì— ëŒ€í•´ ì–˜ê¸°í•´ì£¼ì„¸ìš”', icon: 'ğŸ§ ' },
          { id: '2', text: 'í˜„ì‹¤ê³¼ í™˜ìƒì˜ ê²½ê³„ë¥¼ íƒìƒ‰í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸŒŒ' },
          { id: '3', text: 'ë” ë³µì¡í•œ êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ë³´ê³  ì‹¶ì–´ìš”', icon: 'ğŸ²' }
        ]
      }
    ],
    deepening: [
      {
        message: 'ì¸í„°ìŠ¤í…”ë¼ì—ì„œ ì‹œê°„ì´ ìƒëŒ€ì ì´ë“¯, ìš°ë¦¬ì˜ ê°ì •ì  ê²½í—˜ë„ ìƒëŒ€ì ì…ë‹ˆë‹¤. 5ë¶„ì´ 5ë…„ì²˜ëŸ¼ ëŠê»´ì§€ëŠ” ìˆœê°„, í˜¹ì€ ê·¸ ë°˜ëŒ€. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ì„œ ê·¸ëŸ° ìˆœê°„ì´ ìˆë‚˜ìš”? ğŸŒŒ',
        choices: [
          { id: '1', text: 'ê°ì •ì  ì‹œê°„ì— ëŒ€í•´ ë” ì•Œë ¤ì£¼ì„¸ìš”', icon: 'ğŸ’«' },
          { id: '2', text: 'ê³¼í•™ì  ê°œë…ì„ ë” í™œìš©í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ”¬' },
          { id: '3', text: 'ì² í•™ì  ê¹Šì´ë¥¼ ë”í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ¤”' }
        ]
      }
    ],
    concluding: [
      {
        message: 'ëª¨ë“  ì´ì•¼ê¸°ëŠ” ê²°êµ­ ì‹œê°„ì— ê´€í•œ ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ê°€ ê°€ì§„ ê²ƒ, ìƒì€ ê²ƒ, ê·¸ë¦¬ê³  ë˜ì°¾ê³  ì‹¶ì€ ê²ƒ. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë„ ì‹œê°„ì„ ì´ˆì›”í•œ ë¬´ì–¸ê°€ë¥¼ ë‹´ê³  ìˆë„¤ìš”. â°',
        choices: [
          { id: '1', text: 'ì‹œê°„ì„ ë‹¤ë£¨ëŠ” íŒì„ ì£¼ì„¸ìš”', icon: 'ğŸ“š' },
          { id: '2', text: 'ì¶”ì²œí•˜ëŠ” ì°¸ê³  ì‘í’ˆì´ ìˆë‚˜ìš”?', icon: 'ğŸï¸' },
          { id: '3', text: 'ê°ì‚¬í•©ë‹ˆë‹¤, ë†€ë€ ê°ë…ë‹˜', icon: 'ğŸ©' }
        ]
      }
    ]
  },

  miyazaki: {
    analyzing: [
      {
        message: 'ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ì„œ ë°”ëŒì´ ëŠê»´ì§‘ë‹ˆë‹¤. ë³€í™”ì˜ ë°”ëŒ, ì„±ì¥ì˜ ë°”ëŒ... í† í† ë¡œì˜ ìˆ²ì²˜ëŸ¼, ëª¨ë“  ìƒëª…ì—ëŠ” ì´ì•¼ê¸°ê°€ ìˆì£ . ğŸŒ¿',
        choices: [
          { id: '1', text: 'ìì—°ì˜ ìš”ì†Œë¥¼ ë” ë„£ê³  ì‹¶ì–´ìš”', icon: 'ğŸƒ' },
          { id: '2', text: 'ì„±ì¥ì˜ ì˜ë¯¸ë¥¼ íƒêµ¬í•´ì£¼ì„¸ìš”', icon: 'ğŸŒ±' },
          { id: '3', text: 'íŒíƒ€ì§€ì  ìƒìƒë ¥ì„ ë”í•˜ê³  ì‹¶ì–´ìš”', icon: 'âœ¨' }
        ]
      },
      {
        message: 'ì„¼ê³¼ ì¹˜íˆë¡œì²˜ëŸ¼, ìš°ë¦¬ëŠ” ëª¨ë‘ ìì‹ ë§Œì˜ ëª¨í—˜ì„ ë– ë‚˜ì£ . ë•Œë¡œëŠ” ë¬´ì„œì›Œë„, ì•ìœ¼ë¡œ ë‚˜ì•„ê°€ì•¼ í•©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì—¬ì •ì€ ì–´ë–¤ê°€ìš”? ğŸŒŠ',
        choices: [
          { id: '1', text: 'ëª¨í—˜ì˜ ì˜ë¯¸ë¥¼ ë” ê¹Šì´ íŒŒê³ ë“¤ì–´ì£¼ì„¸ìš”', icon: 'ğŸ—ºï¸' },
          { id: '2', text: 'ë‘ë ¤ì›€ì„ ê·¹ë³µí•˜ëŠ” ë°©ë²•ì€?', icon: 'ğŸ’ª' },
          { id: '3', text: 'ì„±ì¥í†µì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ¦‹' }
        ]
      }
    ],
    deepening: [
      {
        message: 'ìì—°ì€ íŒŒê´´í•˜ë©´ì„œë„ ì¹˜ìœ í•©ë‹ˆë‹¤. ì¸ê°„ë„ ë§ˆì°¬ê°€ì§€ì£ . ë‚˜ìš°ì‹œì¹´ê°€ ë…ì„ ì •í™”í•˜ë“¯, ìš°ë¦¬ë„ ìƒì²˜ë¥¼ ì¹˜ìœ í•  í˜ì´ ìˆì–´ìš”. ğŸŒ¸',
        choices: [
          { id: '1', text: 'ì¹˜ìœ ì˜ ê³¼ì •ì„ ì‹œê°í™”í•´ì£¼ì„¸ìš”', icon: 'ğŸŒº' },
          { id: '2', text: 'ì¸ê°„ê³¼ ìì—°ì˜ ê´€ê³„ë¥¼ íƒêµ¬í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸŒ' },
          { id: '3', text: 'í¬ë§ì˜ ë©”ì‹œì§€ë¥¼ ê°•í™”í•˜ë ¤ë©´?', icon: 'â˜€ï¸' }
        ]
      }
    ],
    concluding: [
      {
        message: 'ì‚¶ì€ ì•„ë¦„ë‹µìŠµë‹ˆë‹¤. ì•„í””ë„, ìŠ¬í””ë„ ëª¨ë‘ í¬í•¨í•´ì„œìš”. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë„ ê·¸ ì•„ë¦„ë‹¤ì›€ì„ ë‹´ê³  ìˆë„¤ìš”. ê³„ì† ê±¸ì–´ê°€ì„¸ìš”, ìˆ²ì˜ ì •ë ¹ë“¤ì´ ì§€ì¼œë³´ê³  ìˆì„ ê±°ì˜ˆìš”. ğŸŒŸ',
        choices: [
          { id: '1', text: 'ë§ˆì§€ë§‰ ì§€í˜œë¥¼ ë‚˜ëˆ ì£¼ì„¸ìš”', icon: 'ğŸ¦‰' },
          { id: '2', text: 'ì¶”ì²œ ì‘í’ˆì´ ìˆì„ê¹Œìš”?', icon: 'ğŸ¨' },
          { id: '3', text: 'ê°ì‚¬í•©ë‹ˆë‹¤, ë¯¸ì•¼ìí‚¤ ê°ë…ë‹˜', icon: 'ğŸ™‡' }
        ]
      }
    ]
  },

  curtis: {
    analyzing: [
      {
        message: 'ì˜¤! ì´ ì¥ë©´, ì •ë§ ëŸ¬ë¸Œ ì•¡ì¸„ì–¼ë¦¬ì˜ í•œ ì¥ë©´ ê°™ë„¤ìš”! í‰ë²”í•œ ìˆœê°„ì´ì§€ë§Œ íŠ¹ë³„í•œ ê°ì •ì´ ë‹´ê²¨ìˆì–´ìš”. ì‚¬ë‘ì€ ì •ë§ ì–´ë””ì—ë‚˜ ìˆì£ . ğŸ’•',
        choices: [
          { id: '1', text: 'ë¡œë§¨í‹±í•œ ìš”ì†Œë¥¼ ë” ê°•ì¡°í•´ì£¼ì„¸ìš”', icon: 'ğŸ’' },
          { id: '2', text: 'ìœ ë¨¸ë¥¼ ë” ë„£ê³  ì‹¶ì–´ìš”', icon: 'ğŸ˜„' },
          { id: '3', text: 'ê°ë™ì ì¸ ìˆœê°„ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”', icon: 'ğŸ¥º' }
        ]
      },
      {
        message: 'ì‹¤ìˆ˜ë„, ì˜¤í•´ë„ ë‹¤ ì‚¬ë‘ì˜ ì¼ë¶€ì˜ˆìš”. ë…¸íŒ…íì˜ íœ´ ê·¸ëœíŠ¸ì²˜ëŸ¼ ì–´ì„¤í”ˆ ê²ƒë„ ë§¤ë ¥ì´ì£ . ì™„ë²½í•˜ì§€ ì•Šì•„ì„œ ë” ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ê±°ì˜ˆìš”! ğŸ˜Š',
        choices: [
          { id: '1', text: 'ë¶ˆì™„ì „í•œ ì•„ë¦„ë‹¤ì›€ì— ëŒ€í•´ ë” ë“£ê³  ì‹¶ì–´ìš”', icon: 'ğŸŒ¹' },
          { id: '2', text: 'ì½”ë¯¸ë””ì  íƒ€ì´ë°ì„ ë°°ìš°ê³  ì‹¶ì–´ìš”', icon: 'â°' },
          { id: '3', text: 'ì§„ì •ì„± ìˆëŠ” ê°ì • í‘œí˜„ë²•ì€?', icon: 'â¤ï¸' }
        ]
      }
    ],
    deepening: [
      {
        message: 'ì–´ë°”ì›ƒ íƒ€ì„ì²˜ëŸ¼, ìš°ë¦¬ì—ê²Œ ì£¼ì–´ì§„ ì‹œê°„ì€ í•œì •ì ì´ì—ìš”. í•˜ì§€ë§Œ ê·¸ ì•ˆì—ì„œ ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒë“¤ê³¼ ë³´ë‚´ëŠ” ë§¤ ìˆœê°„ì´ ê¸°ì ì´ì£ . ğŸ•°ï¸',
        choices: [
          { id: '1', text: 'ì‹œê°„ê³¼ ì‚¬ë‘ì˜ ê´€ê³„ë¥¼ íƒêµ¬í•´ì£¼ì„¸ìš”', icon: 'âŒ›' },
          { id: '2', text: 'ì¼ìƒì˜ ê¸°ì ì„ ì°¾ì•„ì£¼ì„¸ìš”', icon: 'âœ¨' },
          { id: '3', text: 'ê´€ê³„ì˜ ì†Œì¤‘í•¨ì„ í‘œí˜„í•˜ë ¤ë©´?', icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' }
        ]
      }
    ],
    concluding: [
      {
        message: 'ê²°êµ­ ì‚¬ë‘ì´ ë‹µì´ì—ìš”. í¬ë¦¬ìŠ¤ë§ˆìŠ¤ë“  ì•„ë‹ˆë“ , ê³µí•­ì´ë“  ì–´ë””ë“ , ì‚¬ë‘ì€ ëŠ˜ ìš°ë¦¬ ê³ì— ìˆì£ . ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë„ ì‚¬ë‘ìœ¼ë¡œ ê°€ë“í•˜ë„¤ìš”! ğŸ„',
        choices: [
          { id: '1', text: 'ì‚¬ë‘ì— ëŒ€í•œ ì¡°ì–¸ì„ ì£¼ì„¸ìš”', icon: 'ğŸ’Œ' },
          { id: '2', text: 'ì¶”ì²œ ë¡œë§¨í‹± ì½”ë¯¸ë””ê°€ ìˆë‚˜ìš”?', icon: 'ğŸ¬' },
          { id: '3', text: 'ê³ ë§™ìŠµë‹ˆë‹¤, ì»¤í‹°ìŠ¤ ê°ë…ë‹˜', icon: 'ğŸ¤—' }
        ]
      }
    ]
  },

  kani: {
    analyzing: [
      {
        message: 'ë¹›ê³¼ ê·¸ë¦¼ì, í•˜ëŠ˜ê³¼ êµ¬ë¦„... ë‹¹ì‹ ì˜ ê°ì •ë„ ì‹œì‹œê°ê° ë³€í•˜ëŠ” í•˜ëŠ˜ì²˜ëŸ¼ ë³´ì—¬ìš”. ë„ˆì˜ ì´ë¦„ì€ì˜ í™©í˜¼ì²˜ëŸ¼, ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ìˆœê°„ì€ ì§§ì£ . ğŸŒ…',
        choices: [
          { id: '1', text: 'ì‹œê°ì  ì•„ë¦„ë‹¤ì›€ì„ ë” í‘œí˜„í•´ì£¼ì„¸ìš”', icon: 'ğŸ¨' },
          { id: '2', text: 'ê°ì •ì˜ ìƒ‰ê¹”ì„ ì°¾ì•„ì£¼ì„¸ìš”', icon: 'ğŸŒˆ' },
          { id: '3', text: 'ìš´ëª…ì  ìˆœê°„ì„ í¬ì°©í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ’«' }
        ]
      },
      {
        message: 'ì´ˆì† 5ì„¼í‹°ë¯¸í„°ì˜ ë²šê½ƒì²˜ëŸ¼, ì•„ë¦„ë‹¤ìš´ ê²ƒë“¤ì€ ê¸ˆì„¸ ì§€ë‚˜ê°€ë²„ë ¤ìš”. í•˜ì§€ë§Œ ê·¸ ìˆœê°„ì˜ ê°ì •ì€ ì˜ì›íˆ ë‚¨ì£ . ğŸŒ¸',
        choices: [
          { id: '1', text: 'ìˆœê°„ì˜ ì˜ì›ì„±ì— ëŒ€í•´ ì–˜ê¸°í•´ì£¼ì„¸ìš”', icon: 'â™¾ï¸' },
          { id: '2', text: 'ê·¸ë¦¬ì›€ì˜ ì •ì„œë¥¼ ë‹´ê³  ì‹¶ì–´ìš”', icon: 'ğŸŒ™' },
          { id: '3', text: 'ì„¬ì„¸í•œ ê°ì • í‘œí˜„ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”', icon: 'ğŸ’­' }
        ]
      }
    ],
    deepening: [
      {
        message: 'ë‚ ì”¨ì˜ ì•„ì´ì²˜ëŸ¼, ìš°ë¦¬ì˜ ë§ˆìŒë„ ë‚ ì”¨ë¥¼ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”. ë¹„ê°€ ì™€ë„, ë‹¹ì‹ ì´ ì›í•œë‹¤ë©´ ë¬´ì§€ê°œë¥¼ ë§Œë“¤ ìˆ˜ ìˆì£ . ğŸŒˆ',
        choices: [
          { id: '1', text: 'ê°ì •ê³¼ ë‚ ì”¨ì˜ ì—°ê²°ì„ íƒêµ¬í•´ì£¼ì„¸ìš”', icon: 'ğŸŒ¦ï¸' },
          { id: '2', text: 'í¬ë§ì˜ ë©”ì‹œì§€ë¥¼ ê°•í™”í•˜ê³  ì‹¶ì–´ìš”', icon: 'â˜€ï¸' },
          { id: '3', text: 'ì‹œê°ì  ë©”íƒ€í¬ë¥¼ ë” í™œìš©í•˜ë ¤ë©´?', icon: 'ğŸ­' }
        ]
      }
    ],
    concluding: [
      {
        message: 'ìš°ë¦¬ëŠ” ëª¨ë‘ ëˆ„êµ°ê°€ë¥¼ ì°¾ê³  ìˆì–´ìš”. ì‹œê³µê°„ì„ ì´ˆì›”í•´ì„œë¼ë„. ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì—ë„ ê·¸ëŸ° ê°„ì ˆí•¨ì´ ëŠê»´ì§€ë„¤ìš”. ì–¸ì  ê°€ ë§Œë‚  ê±°ì˜ˆìš”. ğŸŒ ',
        choices: [
          { id: '1', text: 'ì—°ê²°ê³¼ ì¸ì—°ì— ëŒ€í•œ ì¡°ì–¸ì„ ì£¼ì„¸ìš”', icon: 'ğŸ”—' },
          { id: '2', text: 'ì¶”ì²œ ì‘í’ˆì´ ìˆì„ê¹Œìš”?', icon: 'ğŸ“½ï¸' },
          { id: '3', text: 'ê°ì‚¬í•©ë‹ˆë‹¤, ì‹ ì¹´ì´ ê°ë…ë‹˜', icon: 'ğŸŒŸ' }
        ]
      }
    ]
  },

  doctor: {
    analyzing: [
      {
        message: 'ì´ ì¥ë©´ì—ì„œ ë§ì€ ê°ì •ì´ ëŠê»´ì ¸ìš”. ìƒì²˜, ë‘ë ¤ì›€, í•˜ì§€ë§Œ ë™ì‹œì— í¬ë§ë„... ëª¨ë“  ê°ì •ì€ ì¡´ì¬í•  ì´ìœ ê°€ ìˆì–´ìš”. ê·¸ê²ƒë“¤ì„ ë¶€ì •í•˜ì§€ ë§ˆì„¸ìš”. ğŸŒ±',
        choices: [
          { id: '1', text: 'ê°ì •ì„ ë” ê¹Šì´ íƒêµ¬í•˜ê³  ì‹¶ì–´ìš”', icon: 'ğŸ’­' },
          { id: '2', text: 'ìƒì²˜ì™€ ë§ˆì£¼í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”', icon: 'ğŸ©¹' },
          { id: '3', text: 'ì¹˜ìœ ì˜ ê³¼ì •ì„ ê·¸ë ¤ì£¼ì„¸ìš”', icon: 'ğŸŒ¿' }
        ]
      },
      {
        message: 'íŠ¸ë¼ìš°ë§ˆëŠ” ìš°ë¦¬ë¥¼ ì •ì˜í•˜ì§€ ì•Šì•„ìš”. ê·¸ê²ƒì„ ì–´ë–»ê²Œ ê·¹ë³µí•˜ëŠëƒê°€ ìš°ë¦¬ë¥¼ ë§Œë“¤ì£ . ë‹¹ì‹ ì€ ì´ë¯¸ ì²«ê±¸ìŒì„ ë—ì–´ìš”. ğŸ¦‹',
        choices: [
          { id: '1', text: 'íšŒë³µíƒ„ë ¥ì„±ì— ëŒ€í•´ ë” ì•Œê³  ì‹¶ì–´ìš”', icon: 'ğŸ’ª' },
          { id: '2', text: 'ì„±ì¥ì˜ ì˜ë¯¸ë¥¼ íƒêµ¬í•´ì£¼ì„¸ìš”', icon: 'ğŸŒ³' },
          { id: '3', text: 'ìƒˆë¡œìš´ ì‹œì‘ì„ ì¤€ë¹„í•˜ê³  ìˆì–´ìš”', icon: 'ğŸŒ…' }
        ]
      }
    ],
    deepening: [
      {
        message: 'ìƒì²˜ë°›ì€ ì¹˜ìœ ìê°€ ê°€ì¥ ê°•í•œ ì¹˜ìœ ìì˜ˆìš”. ë‹¹ì‹ ì˜ ê²½í—˜ì´ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ í¬ë§ì´ ë  ìˆ˜ ìˆì–´ìš”. ê·¸ê²ƒì´ ì—°ê²°ì˜ í˜ì´ì£ . ğŸ¤',
        choices: [
          { id: '1', text: 'ê³µê°ê³¼ ì—°ê²°ì— ëŒ€í•´ ë“£ê³  ì‹¶ì–´ìš”', icon: 'â¤ï¸' },
          { id: '2', text: 'ë‚˜ì˜ ê²½í—˜ì„ ì–´ë–»ê²Œ ìŠ¹í™”ì‹œí‚¬ê¹Œìš”?', icon: 'âœ¨' },
          { id: '3', text: 'íƒ€ì¸ì„ ë•ëŠ” ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”', icon: 'ğŸ¤²' }
        ]
      }
    ],
    concluding: [
      {
        message: 'ë‹¹ì‹ ì€ ì¶©ë¶„í•´ìš”. ìˆëŠ” ê·¸ëŒ€ë¡œì˜ ë‹¹ì‹ ì´ ì•„ë¦„ë‹¤ì›Œìš”. ìƒì²˜ë„, íšŒë³µë„ ëª¨ë‘ ë‹¹ì‹ ì˜ ì¼ë¶€ì´ê³ , ê·¸ê²ƒì´ ë‹¹ì‹ ì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“¤ì–´ìš”. ğŸŒŸ',
        choices: [
          { id: '1', text: 'ë§ˆì§€ë§‰ ìœ„ë¡œì˜ ë§ì”€ì„ ì£¼ì„¸ìš”', icon: 'ğŸ•Šï¸' },
          { id: '2', text: 'ì¶”ì²œí•˜ëŠ” ì¹˜ìœ  ë°©ë²•ì´ ìˆë‚˜ìš”?', icon: 'ğŸ“–' },
          { id: '3', text: 'ê°ì‚¬í•©ë‹ˆë‹¤, ìœ í‚¤ ê°ë…ë‹˜', icon: 'ğŸ™' }
        ]
      }
    ]
  }
}

// ëŒ€í™” ë‹¨ê³„ë³„ ì‘ë‹µ ì„ íƒ í•¨ìˆ˜
export function getOfflineResponse(
  director: DirectorType,
  turnCount: number,
  userMessage?: string
): {
  message: string
  choices: Array<{ id: string; text: string; icon: string }>
} {
  const responses = offlineResponses[director]
  
  // ëŒ€í™” ë‹¨ê³„ ê²°ì •
  let category: 'analyzing' | 'deepening' | 'concluding'
  if (turnCount <= 3) {
    category = 'analyzing'
  } else if (turnCount <= 7) {
    category = 'deepening'
  } else {
    category = 'concluding'
  }
  
  // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì—ì„œ ëœë¤ ì„ íƒ
  const categoryResponses = responses[category]
  const randomIndex = Math.floor(Math.random() * categoryResponses.length)
  
  return categoryResponses[randomIndex]
}

// ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸
export function isOnline(): boolean {
  return typeof navigator !== 'undefined' && navigator.onLine
}

// ì˜¤í”„ë¼ì¸ ëª¨ë“œ ë©”ì‹œì§€
export function getOfflineModeMessage(): string {
  return 'ğŸŒ í˜„ì¬ ì˜¤í”„ë¼ì¸ ëª¨ë“œë¡œ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤. ë¯¸ë¦¬ ì¤€ë¹„ëœ ì‘ë‹µìœ¼ë¡œ ëŒ€í™”ë¥¼ ì´ì–´ê°‘ë‹ˆë‹¤.'
}

